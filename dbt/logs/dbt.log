[0m07:25:57.671296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b641e53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6823c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b642226d0>]}


============================== 07:25:57.678208 | ee94c5c0-9cd6-4c0a-8110-4106c68a3e60 ==============================
[0m07:25:57.678208 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:25:57.689481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:25:58.117647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee94c5c0-9cd6-4c0a-8110-4106c68a3e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64285610>]}
[0m07:25:58.196013 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ym4jib5r'
[0m07:25:58.200815 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:25:59.043870 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:25:59.047429 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:25:59.413927 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:25:59.493765 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:26:27.677992 [info ] [MainThread]: Installed from version 1.3.0
[0m07:26:27.682460 [info ] [MainThread]: Up to date!
[0m07:26:27.687046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee94c5c0-9cd6-4c0a-8110-4106c68a3e60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64256b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64249910>]}
[0m07:26:27.692390 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 30.195187, "process_user_time": 6.813685, "process_kernel_time": 1.813642, "process_mem_max_rss": "98460", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m07:26:27.717150 [debug] [MainThread]: Command `dbt deps` succeeded at 07:26:27.716444 after 30.22 seconds
[0m07:26:27.729462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b641d95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b641d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b68475810>]}
[0m07:26:27.734644 [debug] [MainThread]: Flushing usage events
[0m07:26:34.788133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054e771b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054e857d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054eb7aa90>]}


============================== 07:26:34.800379 | 3386df32-2b7a-4a93-a5a2-862dc6214c96 ==============================
[0m07:26:34.800379 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:26:34.805425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:26:40.492622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05337dd050>]}
[0m07:26:40.691502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0550a0cc90>]}
[0m07:26:40.694190 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m07:26:41.133776 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:26:41.152626 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:26:41.157301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053a3a3550>]}
[0m07:26:53.490847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m07:26:53.640911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05334f78d0>]}
[0m07:26:54.679173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532928bd0>]}
[0m07:26:54.692099 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m07:26:54.695560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3386df32-2b7a-4a93-a5a2-862dc6214c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532a37210>]}
[0m07:26:54.704427 [info ] [MainThread]: 
[0m07:26:54.716763 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:26:54.788761 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m07:26:54.802582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:54.811560 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json''
[0m07:26:54.816557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:54.818938 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m07:26:54.821610 [info ] [MainThread]: 
[0m07:26:54.827615 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m07:26:54.833980 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json'
[0m07:26:54.847495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.276442, "process_user_time": 18.601364, "process_kernel_time": 2.004813, "process_mem_max_rss": "234024", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m07:26:54.855969 [debug] [MainThread]: Command `dbt run` failed at 07:26:54.854427 after 20.28 seconds
[0m07:26:54.862609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054e771690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054e764290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532928350>]}
[0m07:26:54.868681 [debug] [MainThread]: Flushing usage events
[0m07:27:21.871139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806e155d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780715fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806e15710>]}


============================== 07:27:21.888039 | be25f838-2b3d-4d38-b070-11f429379aa3 ==============================
[0m07:27:21.888039 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:27:21.893095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:27:22.103881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be25f838-2b3d-4d38-b070-11f429379aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78080996d0>]}
[0m07:27:23.243225 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yl94m8rw'
[0m07:27:23.251429 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:27:24.106743 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:27:24.117644 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:27:24.764511 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:27:24.786166 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:27:45.505057 [info ] [MainThread]: Installed from version 1.3.0
[0m07:27:45.507615 [info ] [MainThread]: Up to date!
[0m07:27:45.511317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'be25f838-2b3d-4d38-b070-11f429379aa3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806bef690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806befd90>]}
[0m07:27:45.515564 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 23.775251, "process_user_time": 6.711678, "process_kernel_time": 1.693127, "process_mem_max_rss": "98672", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m07:27:45.518614 [debug] [MainThread]: Command `dbt deps` succeeded at 07:27:45.518052 after 23.78 seconds
[0m07:27:45.528942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806dff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7806e4b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7808247d90>]}
[0m07:27:45.532690 [debug] [MainThread]: Flushing usage events
[0m07:28:02.740315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571907de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5718ebaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571907cc10>]}


============================== 07:28:02.775077 | 9d342bcb-00f8-4f31-af22-c99eb326e355 ==============================
[0m07:28:02.775077 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:28:02.825971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:28:11.842969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d342bcb-00f8-4f31-af22-c99eb326e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571962f950>]}
[0m07:28:12.400083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d342bcb-00f8-4f31-af22-c99eb326e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571b38c750>]}
[0m07:28:12.407254 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m07:28:13.690646 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:28:28.132571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:28.136764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:28.205729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m07:28:28.507712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d342bcb-00f8-4f31-af22-c99eb326e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fdf0f510>]}
[0m07:28:29.978472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d342bcb-00f8-4f31-af22-c99eb326e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fe871990>]}
[0m07:28:29.987546 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m07:28:29.992951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d342bcb-00f8-4f31-af22-c99eb326e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571b1ae8d0>]}
[0m07:28:30.010586 [info ] [MainThread]: 
[0m07:28:30.043053 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:28:30.094771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m07:28:30.108263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:30.112975 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json''
[0m07:28:30.128287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:30.141050 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m07:28:30.147230 [info ] [MainThread]: 
[0m07:28:30.159859 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m07:28:30.167671 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json'
[0m07:28:30.176366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.248035, "process_user_time": 23.87457, "process_kernel_time": 3.399961, "process_mem_max_rss": "230272", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m07:28:30.184344 [debug] [MainThread]: Command `dbt run` failed at 07:28:30.183845 after 28.26 seconds
[0m07:28:30.224781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5719077910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571907d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fedc0fd0>]}
[0m07:28:30.258326 [debug] [MainThread]: Flushing usage events
[0m07:46:16.229506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280474450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280437750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280481fd0>]}


============================== 07:46:16.246203 | 9217d18a-99dc-49af-a250-ddbded21fc70 ==============================
[0m07:46:16.246203 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:46:16.249555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:46:16.749206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9217d18a-99dc-49af-a250-ddbded21fc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2804dd610>]}
[0m07:46:17.604344 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b5yb31k9'
[0m07:46:17.606811 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:46:19.284982 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:46:19.290715 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:46:20.303548 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:46:20.386568 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:46:42.810500 [info ] [MainThread]: Installed from version 1.3.0
[0m07:46:42.813613 [info ] [MainThread]: Up to date!
[0m07:46:42.816625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9217d18a-99dc-49af-a250-ddbded21fc70', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281b91650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2804bddd0>]}
[0m07:46:42.824795 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 26.787664, "process_user_time": 8.368518, "process_kernel_time": 1.991023, "process_mem_max_rss": "98572", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m07:46:42.827627 [debug] [MainThread]: Command `dbt deps` succeeded at 07:46:42.827193 after 26.79 seconds
[0m07:46:42.832979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28043c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28190fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe280437610>]}
[0m07:46:42.846244 [debug] [MainThread]: Flushing usage events
[0m07:46:51.828619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27ebfc510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27ebfc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27ebfe010>]}


============================== 07:46:51.859925 | f7af5231-9a60-414f-acd5-857650f0f339 ==============================
[0m07:46:51.859925 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:46:51.870828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:46:55.813883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7af5231-9a60-414f-acd5-857650f0f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc263ded1d0>]}
[0m07:46:56.036038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7af5231-9a60-414f-acd5-857650f0f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28106cd10>]}
[0m07:46:56.038761 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m07:46:56.459466 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:46:59.627210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:59.629349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:59.647588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m07:46:59.741179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7af5231-9a60-414f-acd5-857650f0f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc263bbead0>]}
[0m07:47:00.606429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7af5231-9a60-414f-acd5-857650f0f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26383bc50>]}
[0m07:47:00.616095 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m07:47:00.626510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7af5231-9a60-414f-acd5-857650f0f339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26393d750>]}
[0m07:47:00.637244 [info ] [MainThread]: 
[0m07:47:00.640249 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:47:00.656725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m07:47:00.658819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:47:00.660976 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json''
[0m07:47:00.664412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:47:00.667767 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m07:47:00.670614 [info ] [MainThread]: 
[0m07:47:00.672527 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m07:47:00.679519 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-3e7046576d3a.json'
[0m07:47:00.683269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.630312, "process_user_time": 10.628752, "process_kernel_time": 1.282262, "process_mem_max_rss": "232048", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m07:47:00.686628 [debug] [MainThread]: Command `dbt run` failed at 07:47:00.686199 after 9.63 seconds
[0m07:47:00.690922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27ebf3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27ebfd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc263df4110>]}
[0m07:47:00.693319 [debug] [MainThread]: Flushing usage events
[0m08:15:47.081101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a55390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a472d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a45b10>]}


============================== 08:15:47.182168 | d8740b07-ac3f-4347-8358-8366b7c80e14 ==============================
[0m08:15:47.182168 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:15:47.284043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:15:48.524204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8740b07-ac3f-4347-8358-8366b7c80e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8b15c90>]}
[0m08:15:54.344083 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nl_zeckm'
[0m08:15:54.349065 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:15:55.135165 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:15:55.167666 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:15:55.900562 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:15:56.040060 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:17:31.475138 [info ] [MainThread]: Installed from version 1.3.0
[0m08:17:31.503799 [info ] [MainThread]: Up to date!
[0m08:17:31.533238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd8740b07-ac3f-4347-8358-8366b7c80e14', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8ac82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a3fe10>]}
[0m08:17:31.593049 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 104.9193, "process_user_time": 10.899499, "process_kernel_time": 2.642302, "process_mem_max_rss": "98732", "process_in_blocks": "1128", "process_out_blocks": "1264"}
[0m08:17:31.627527 [debug] [MainThread]: Command `dbt deps` succeeded at 08:17:31.627094 after 104.95 seconds
[0m08:17:31.662871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a47d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8a47c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd8ae0610>]}
[0m08:17:31.678945 [debug] [MainThread]: Flushing usage events
[0m08:17:46.014633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc747ee790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc74629dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc747dba90>]}


============================== 08:17:46.034986 | 76b540e0-d8f5-453c-bc71-8236f54c0a82 ==============================
[0m08:17:46.034986 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:17:46.043065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:17:52.891412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76b540e0-d8f5-453c-bc71-8236f54c0a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7460f7d0>]}
[0m08:17:53.325031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76b540e0-d8f5-453c-bc71-8236f54c0a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc76af8e50>]}
[0m08:17:53.332027 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m08:17:54.414165 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:10.092682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:18:10.105543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:18:10.152812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m08:18:10.341090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76b540e0-d8f5-453c-bc71-8236f54c0a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc59ca3890>]}
[0m08:18:11.810840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76b540e0-d8f5-453c-bc71-8236f54c0a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc597da690>]}
[0m08:18:11.868374 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m08:18:11.912433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76b540e0-d8f5-453c-bc71-8236f54c0a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7460d1d0>]}
[0m08:18:11.921343 [info ] [MainThread]: 
[0m08:18:11.969988 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:18:12.026856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m08:18:12.058466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:13.350466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:13.381703 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m08:18:13.399733 [info ] [MainThread]: 
[0m08:18:13.412629 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m08:18:13.443184 [error] [MainThread]: Encountered an error:
Runtime Error
  Unable to generate access token, if you're using impersonate_service_account, make sure your initial account has the "roles/iam.serviceAccountTokenCreator" role on the account you are trying to impersonate.
  
  ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
[0m08:18:13.518474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.139727, "process_user_time": 19.309315, "process_kernel_time": 3.011259, "process_mem_max_rss": "232012", "process_in_blocks": "80", "process_out_blocks": "416", "command_success": false}
[0m08:18:13.592247 [debug] [MainThread]: Command `dbt run` failed at 08:18:13.591826 after 28.21 seconds
[0m08:18:13.630580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc747e7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc747ed290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc78899ad0>]}
[0m08:18:13.656672 [debug] [MainThread]: Flushing usage events
[0m13:02:31.633455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe297225490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29720fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2974c2150>]}


============================== 13:02:31.717762 | a161bb34-d093-4e3f-801c-dd652b764869 ==============================
[0m13:02:31.717762 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:02:31.769582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:02:33.406683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a161bb34-d093-4e3f-801c-dd652b764869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29728f910>]}
[0m13:02:37.023643 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2xrmasn6'
[0m13:02:37.035747 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:02:38.059806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:02:38.073644 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:02:39.129111 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:02:39.193460 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:03:53.160891 [info ] [MainThread]: Installed from version 1.3.0
[0m13:03:53.181008 [info ] [MainThread]: Up to date!
[0m13:03:53.194321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a161bb34-d093-4e3f-801c-dd652b764869', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2972140d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2987d9f10>]}
[0m13:03:53.205344 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 82.663025, "process_user_time": 13.184605, "process_kernel_time": 4.207852, "process_mem_max_rss": "99308", "process_in_blocks": "296", "process_out_blocks": "1264"}
[0m13:03:53.208543 [debug] [MainThread]: Command `dbt deps` succeeded at 13:03:53.208066 after 82.67 seconds
[0m13:03:53.214986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2972178d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2972170d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe297452a50>]}
[0m13:03:53.246372 [debug] [MainThread]: Flushing usage events
[0m13:04:10.990677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d021a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d165bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d0219d50>]}


============================== 13:04:11.019010 | 0928ed7d-9220-4545-9feb-4b0ca0646c79 ==============================
[0m13:04:11.019010 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:04:11.023362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:19.791199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0928ed7d-9220-4545-9feb-4b0ca0646c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b59dee50>]}
[0m13:04:20.495906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0928ed7d-9220-4545-9feb-4b0ca0646c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc38c450>]}
[0m13:04:20.500240 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:04:22.536886 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:04:38.926183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:38.930819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:38.983811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m13:04:39.196236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0928ed7d-9220-4545-9feb-4b0ca0646c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cf3c3dd0>]}
[0m13:04:40.532723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0928ed7d-9220-4545-9feb-4b0ca0646c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5394dd0>]}
[0m13:04:40.543053 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m13:04:40.550101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0928ed7d-9220-4545-9feb-4b0ca0646c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d21e52d0>]}
[0m13:04:40.566286 [info ] [MainThread]: 
[0m13:04:40.582115 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:04:40.628462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m13:04:40.632591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:40.645563 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json''
[0m13:04:40.657348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:40.661291 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m13:04:40.664109 [info ] [MainThread]: 
[0m13:04:40.667038 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m13:04:40.683548 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json'
[0m13:04:40.697347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.822624, "process_user_time": 24.318806, "process_kernel_time": 3.60853, "process_mem_max_rss": "229808", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m13:04:40.700860 [debug] [MainThread]: Command `dbt run` failed at 13:04:40.700417 after 30.83 seconds
[0m13:04:40.709827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d0213250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d02193d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b52fb410>]}
[0m13:04:40.732956 [debug] [MainThread]: Flushing usage events
[0m13:18:52.210898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bec893d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bf24e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26becba390>]}


============================== 13:18:52.224506 | 4cd9b5c3-276b-4754-aab2-586a6345af2e ==============================
[0m13:18:52.224506 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:18:52.227246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:52.607124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cd9b5c3-276b-4754-aab2-586a6345af2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bed44110>]}
[0m13:18:54.116176 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-afauma_l'
[0m13:18:54.122092 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:18:55.133407 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:18:55.138960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:18:55.640615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:18:55.676161 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:20:00.754436 [info ] [MainThread]: Installed from version 1.3.0
[0m13:20:00.766422 [info ] [MainThread]: Up to date!
[0m13:20:00.769641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4cd9b5c3-276b-4754-aab2-586a6345af2e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c029a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26becee250>]}
[0m13:20:00.784380 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 68.69768, "process_user_time": 6.993507, "process_kernel_time": 3.000173, "process_mem_max_rss": "98792", "process_in_blocks": "16", "process_out_blocks": "1264"}
[0m13:20:00.787268 [debug] [MainThread]: Command `dbt deps` succeeded at 13:20:00.786843 after 68.70 seconds
[0m13:20:00.793502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bec79590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26beb95390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26befd3c10>]}
[0m13:20:00.800650 [debug] [MainThread]: Flushing usage events
[0m13:20:18.052977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b38a614d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3b9c8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b38a9f950>]}


============================== 13:20:18.071436 | 442cfb15-c2a4-4b3c-be03-05fa7f1e2e98 ==============================
[0m13:20:18.071436 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:20:18.084291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:20:25.714729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '442cfb15-c2a4-4b3c-be03-05fa7f1e2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1dd5a450>]}
[0m13:20:26.373968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '442cfb15-c2a4-4b3c-be03-05fa7f1e2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3aef8d10>]}
[0m13:20:26.402279 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:20:27.748168 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:20:46.475655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:46.478683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:46.541395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m13:20:46.828055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '442cfb15-c2a4-4b3c-be03-05fa7f1e2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1d9cc210>]}
[0m13:20:48.757312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '442cfb15-c2a4-4b3c-be03-05fa7f1e2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1dd3b190>]}
[0m13:20:48.810387 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m13:20:48.844618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442cfb15-c2a4-4b3c-be03-05fa7f1e2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1dadaed0>]}
[0m13:20:48.870709 [info ] [MainThread]: 
[0m13:20:48.909841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:48.986974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m13:20:49.034463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:49.069362 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json''
[0m13:20:49.116330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:49.146551 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m13:20:49.176250 [info ] [MainThread]: 
[0m13:20:49.186098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:20:49.198900 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json'
[0m13:20:49.245783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 31.791588, "process_user_time": 22.601585, "process_kernel_time": 3.878378, "process_mem_max_rss": "230540", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m13:20:49.263296 [debug] [MainThread]: Command `dbt run` failed at 13:20:49.262912 after 31.81 seconds
[0m13:20:49.272105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b38a9e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b38a612d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b38dd3410>]}
[0m13:20:49.314436 [debug] [MainThread]: Flushing usage events
[0m14:02:58.593066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3aac390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3a97d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3aaded0>]}


============================== 14:02:58.603954 | 5f6d583f-e7d3-4e0b-93e1-50420559faf3 ==============================
[0m14:02:58.603954 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:02:58.607984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:59.025511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f6d583f-e7d3-4e0b-93e1-50420559faf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a39a6890>]}
[0m14:02:59.757804 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xig1b875'
[0m14:02:59.759612 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:03:00.383196 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:03:00.386629 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:03:00.709154 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:03:00.730593 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:03:20.515816 [info ] [MainThread]: Installed from version 1.3.0
[0m14:03:20.518906 [info ] [MainThread]: Up to date!
[0m14:03:20.525293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f6d583f-e7d3-4e0b-93e1-50420559faf3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3b657d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3a7b510>]}
[0m14:03:20.532412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 22.081926, "process_user_time": 4.534782, "process_kernel_time": 1.545036, "process_mem_max_rss": "98192", "process_in_blocks": "90272", "process_out_blocks": "1264"}
[0m14:03:20.534549 [debug] [MainThread]: Command `dbt deps` succeeded at 14:03:20.534229 after 22.08 seconds
[0m14:03:20.536595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a3a9ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a7cc8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a7cc9890>]}
[0m14:03:20.538808 [debug] [MainThread]: Flushing usage events
[0m14:03:34.064497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bde13c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bde13790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bde12510>]}


============================== 14:03:34.087236 | dbcfa180-c7ed-4dd3-8c35-e01cbce867a9 ==============================
[0m14:03:34.087236 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:03:34.104870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:45.129403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbcfa180-c7ed-4dd3-8c35-e01cbce867a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf39ab90>]}
[0m14:03:45.543182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbcfa180-c7ed-4dd3-8c35-e01cbce867a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c026c5d0>]}
[0m14:03:45.547413 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:03:46.202624 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:03:58.097298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:58.102153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:58.141291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m14:03:58.430531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcfa180-c7ed-4dd3-8c35-e01cbce867a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a2bb41d0>]}
[0m14:03:59.444207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcfa180-c7ed-4dd3-8c35-e01cbce867a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a2f2ab90>]}
[0m14:03:59.484728 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m14:03:59.512005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcfa180-c7ed-4dd3-8c35-e01cbce867a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a3032810>]}
[0m14:03:59.526569 [info ] [MainThread]: 
[0m14:03:59.538665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:03:59.574018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m14:03:59.582472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:59.600190 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json''
[0m14:03:59.609268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:59.612223 [debug] [MainThread]: Connection 'list_my-etl-project-434409' was properly closed.
[0m14:03:59.650530 [info ] [MainThread]: 
[0m14:03:59.684522 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m14:03:59.703867 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/data/key/my-etl-project-434409-f65b0f53eeab.json'
[0m14:03:59.717122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.203, "process_user_time": 16.26335, "process_kernel_time": 2.201364, "process_mem_max_rss": "228192", "process_in_blocks": "171368", "process_out_blocks": "416", "command_success": false}
[0m14:03:59.770702 [debug] [MainThread]: Command `dbt run` failed at 14:03:59.770261 after 26.26 seconds
[0m14:03:59.782578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bdfcccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bddd52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c2009890>]}
[0m14:03:59.796451 [debug] [MainThread]: Flushing usage events
[0m14:47:26.542469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd55dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd55c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd55d250>]}


============================== 14:47:26.572176 | 0dc7571e-43b5-4ebf-a611-a5f525f9ff03 ==============================
[0m14:47:26.572176 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:47:26.581962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:26.862465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dc7571e-43b5-4ebf-a611-a5f525f9ff03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd624310>]}
[0m14:47:28.007122 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z63s876l'
[0m14:47:28.016809 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:47:28.629334 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:47:28.632222 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:47:28.935618 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:47:28.945855 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:47:55.835544 [info ] [MainThread]: Installed from version 1.3.0
[0m14:47:55.837767 [info ] [MainThread]: Up to date!
[0m14:47:55.839799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0dc7571e-43b5-4ebf-a611-a5f525f9ff03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd616150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd547d50>]}
[0m14:47:55.843496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 29.5181, "process_user_time": 7.519492, "process_kernel_time": 1.627823, "process_mem_max_rss": "98560", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m14:47:55.846465 [debug] [MainThread]: Command `dbt deps` succeeded at 14:47:55.846130 after 29.52 seconds
[0m14:47:55.856821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd54dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd54f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd78aa50>]}
[0m14:47:55.859181 [debug] [MainThread]: Flushing usage events
[0m14:48:05.222658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adbd01850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adbd01e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adbd01910>]}


============================== 14:48:05.235668 | 37a28f97-8ca0-43ad-8bb9-b339e1288e99 ==============================
[0m14:48:05.235668 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:48:05.247380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:09.969419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac81bcc10>]}
[0m14:48:10.427967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade170c90>]}
[0m14:48:10.432034 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:48:10.914910 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:48:15.202579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:15.205827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:15.244843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m14:48:15.514249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0e81bd0>]}
[0m14:48:16.299397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0dec510>]}
[0m14:48:16.301982 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m14:48:16.305303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac2872790>]}
[0m14:48:16.319082 [info ] [MainThread]: 
[0m14:48:16.325214 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:48:16.345588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m14:48:16.355376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:17.895840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m14:48:17.913264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.549843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac1642310>]}
[0m14:48:19.567391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:19.602194 [info ] [MainThread]: 
[0m14:48:19.668370 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m14:48:19.669511 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m14:48:19.670725 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m14:48:19.672522 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m14:48:19.683123 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m14:48:19.701978 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m14:48:19.718781 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m14:48:19.736465 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m14:48:19.768418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m14:48:19.809626 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m14:48:19.812154 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m14:48:19.815509 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m14:48:19.819734 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m14:48:19.835625 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m14:48:19.840132 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m14:48:19.842799 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m14:48:19.907192 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m14:48:19.959375 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m14:48:19.997258 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m14:48:20.033015 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m14:48:20.148594 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m14:48:20.157772 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m14:48:20.217440 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m14:48:20.342491 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m14:48:20.493849 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m14:48:20.515270 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m14:48:20.533628 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m14:48:20.535516 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m14:48:20.573954 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:48:20.577677 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:48:20.590881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:20.754996 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m14:48:20.760618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:20.860817 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m14:48:20.958285 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m14:48:21.091342 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m14:48:22.378054 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:dd203ce4-9281-478e-be80-dcb1472fc555&page=queryresults
[0m14:48:22.533972 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4e66ec0b-4856-43e2-ab08-9b98c346d68a&page=queryresults
[0m14:48:22.977595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ed9a801f-39ff-4250-8876-a1ce1bdd2588&page=queryresults
[0m14:48:23.208819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0149c10>]}
[0m14:48:23.230885 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 3.40s]
[0m14:48:23.260486 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4148b511-5da0-496c-bce9-2dacd9e9c751&page=queryresults
[0m14:48:23.267031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0102090>]}
[0m14:48:23.268994 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m14:48:23.286560 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.45s]
[0m14:48:23.300140 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m14:48:23.303193 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m14:48:23.309009 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m14:48:23.311672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_sales_by_category)
[0m14:48:23.315306 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m14:48:23.346101 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m14:48:23.395642 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m14:48:23.408740 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m14:48:23.568176 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:23.774401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0dce450>]}
[0m14:48:23.784190 [debug] [Thread-3 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m14:48:23.793728 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 4.01s]
[0m14:48:23.824121 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m14:48:23.835345 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_orders
[0m14:48:23.852742 [info ] [Thread-4 (]: 6 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m14:48:23.863456 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.stg_orders)
[0m14:48:23.865723 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_orders
[0m14:48:23.913173 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m14:48:24.082228 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_orders
[0m14:48:24.093673 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m14:48:24.133555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0c6b210>]}
[0m14:48:24.147519 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 4.32s]
[0m14:48:24.165551 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m14:48:24.336795 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:48:24.601709 [debug] [Thread-4 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m14:48:25.358018 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:651bf052-4d23-4f74-81bd-55fc176b20fc&page=queryresults
[0m14:48:26.056954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac01432d0>]}
[0m14:48:26.060183 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m14:48:26.063228 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m14:48:26.066477 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m14:48:26.069254 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m14:48:26.072935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.fct_sales_by_category)
[0m14:48:26.075378 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m14:48:26.089932 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m14:48:26.122047 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m14:48:26.144886 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m14:48:26.157853 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5ad061ff-a077-46d0-a8d3-d735815d638f&page=queryresults
[0m14:48:26.196044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:26.328469 [debug] [Thread-1 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m14:48:26.863332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8f33210>]}
[0m14:48:26.866275 [info ] [Thread-4 (]: 6 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.00s]
[0m14:48:26.878475 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_orders
[0m14:48:26.882081 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m14:48:26.883376 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m14:48:26.890749 [info ] [Thread-3 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m14:48:26.902218 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m14:48:26.906848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m14:48:26.909513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m14:48:26.912573 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m14:48:26.917184 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m14:48:26.949918 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m14:48:26.997683 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m14:48:27.000523 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m14:48:27.021411 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m14:48:27.043753 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m14:48:27.067721 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m14:48:27.085196 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:27.101506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:27.297279 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m14:48:27.510072 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m14:48:27.645520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a89a4c5f-63b7-4f44-b3db-b82e32234ff5&page=queryresults
[0m14:48:28.322729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8f15710>]}
[0m14:48:28.326793 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m14:48:28.331251 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m14:48:28.835703 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:69df54ee-024a-4a0e-b791-3befd30372d0&page=queryresults
[0m14:48:28.840951 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c79d2d6d-7de7-423a-9653-fd0c6b80e0f0&page=queryresults
[0m14:48:29.589470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0dcda10>]}
[0m14:48:29.595905 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 2.68s]
[0m14:48:29.611987 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adde2fc90>]}
[0m14:48:29.614680 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m14:48:29.627798 [info ] [Thread-3 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 2.71s]
[0m14:48:29.708338 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m14:48:29.778371 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m14:48:29.866961 [info ] [Thread-4 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m14:48:29.935501 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m14:48:30.010748 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_orders_by_state)
[0m14:48:30.041827 [info ] [Thread-2 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m14:48:30.057183 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m14:48:30.081381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m14:48:30.131982 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m14:48:30.160432 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m14:48:30.233071 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m14:48:30.357083 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m14:48:30.426707 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m14:48:30.467044 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m14:48:30.557311 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m14:48:30.898565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:48:31.058693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:31.331367 [debug] [Thread-4 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m14:48:31.658284 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m14:48:33.048524 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:42b9bad4-4b13-4bf4-b40d-8d41a0911b84&page=queryresults
[0m14:48:33.066437 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6860dbbf-056f-4cf1-92cd-c9b823f8dfcc&page=queryresults
[0m14:48:33.697402 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0110cd0>]}
[0m14:48:33.741068 [info ] [Thread-4 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 3.69s]
[0m14:48:33.790672 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m14:48:33.797467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a28f97-8ca0-43ad-8bb9-b339e1288e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0fc1250>]}
[0m14:48:33.916117 [info ] [Thread-2 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.72s]
[0m14:48:33.972058 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m14:48:34.030033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:34.072208 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m14:48:34.091970 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m14:48:34.108492 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m14:48:34.196387 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m14:48:34.244790 [info ] [MainThread]: 
[0m14:48:34.259701 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 17.92 seconds (17.92s).
[0m14:48:34.289530 [debug] [MainThread]: Command end result
[0m14:48:34.712281 [info ] [MainThread]: 
[0m14:48:34.715098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:34.719001 [info ] [MainThread]: 
[0m14:48:34.726680 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:48:34.730239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.880371, "process_user_time": 17.803978, "process_kernel_time": 1.954828, "process_mem_max_rss": "239008", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m14:48:34.732561 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:34.732248 after 29.88 seconds
[0m14:48:34.740108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adbd46c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adff0d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adff0db50>]}
[0m14:48:34.742629 [debug] [MainThread]: Flushing usage events
[0m19:04:05.331655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b839550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b823650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b823f50>]}


============================== 19:04:05.347387 | b5a9d75c-cda4-4770-a079-c83bdbf0e832 ==============================
[0m19:04:05.347387 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:04:05.350159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:04:05.581159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5a9d75c-cda4-4770-a079-c83bdbf0e832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b8d58d0>]}
[0m19:04:06.293547 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rs3qzlwo'
[0m19:04:06.296625 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:04:07.317120 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:04:07.320907 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:04:07.494089 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:04:07.506305 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:04:22.051474 [info ] [MainThread]: Installed from version 1.3.0
[0m19:04:22.059021 [info ] [MainThread]: Up to date!
[0m19:04:22.065645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5a9d75c-cda4-4770-a079-c83bdbf0e832', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b8b1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934b89f650>]}
[0m19:04:22.077271 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.957182, "process_user_time": 4.011126, "process_kernel_time": 2.170313, "process_mem_max_rss": "98152", "process_in_blocks": "99048", "process_out_blocks": "1264"}
[0m19:04:22.080737 [debug] [MainThread]: Command `dbt deps` succeeded at 19:04:22.080183 after 16.96 seconds
[0m19:04:22.084975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934ba4eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934cc6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76934fa299d0>]}
[0m19:04:22.088028 [debug] [MainThread]: Flushing usage events
[0m19:04:37.707770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4935a99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe493793610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe493793a10>]}


============================== 19:04:37.748122 | 76e48f09-3f8a-437b-930f-0ab0a8a8e45c ==============================
[0m19:04:37.748122 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:04:37.753004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:05:02.854810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c8e7790>]}
[0m19:05:03.551071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe495aa0c90>]}
[0m19:05:03.855364 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:05:06.389658 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:05:23.741301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:23.749015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:23.816739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m19:05:24.183845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47e18d210>]}
[0m19:05:25.601878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c48cf50>]}
[0m19:05:25.605476 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m19:05:25.612956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47ccbfb10>]}
[0m19:05:25.630317 [info ] [MainThread]: 
[0m19:05:25.635301 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:25.699339 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m19:05:25.709204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:27.626775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m19:05:27.671256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:29.917948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4938694d0>]}
[0m19:05:29.949231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:29.970400 [info ] [MainThread]: 
[0m19:05:30.140404 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m19:05:30.143108 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m19:05:30.145225 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m19:05:30.146827 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m19:05:30.163723 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m19:05:30.172830 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m19:05:30.235141 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m19:05:30.273069 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m19:05:30.300636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m19:05:30.307450 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m19:05:30.341764 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m19:05:30.370038 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m19:05:30.385751 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m19:05:30.419301 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:05:30.433650 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m19:05:30.481125 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:05:30.636738 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m19:05:30.672418 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:05:30.747134 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m19:05:30.845054 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:05:31.262225 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m19:05:31.400403 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m19:05:31.401791 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:05:31.461366 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m19:05:31.965440 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:05:31.978418 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m19:05:31.980133 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:05:31.950577 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m19:05:32.417124 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:05:32.448510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:32.479576 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:05:32.647027 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:05:33.190419 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m19:05:33.191912 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m19:05:33.515588 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m19:05:33.904473 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m19:05:35.896590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:7bdeeda3-96fe-4457-b28e-977db1a623c7&page=queryresults
[0m19:05:35.951448 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cc8db9d5-2acd-46ad-8db3-6f19d287e030&page=queryresults
[0m19:05:35.962578 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:225d4667-4f81-41c6-8935-b911876fc9ee&page=queryresults
[0m19:05:35.967236 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6a3b97ed-1f17-450a-aa11-491daa0cd947&page=queryresults
[0m19:05:36.980081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c297f50>]}
[0m19:05:36.983393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c878450>]}
[0m19:05:36.997353 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 6.67s]
[0m19:05:37.014918 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 6.68s]
[0m19:05:37.105971 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:05:37.136134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c708550>]}
[0m19:05:37.148046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c297a10>]}
[0m19:05:37.191881 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m19:05:37.259690 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 6.80s]
[0m19:05:37.296117 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 6.78s]
[0m19:05:37.344683 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_orders
[0m19:05:37.382535 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m19:05:37.397023 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m19:05:37.430215 [info ] [Thread-2 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m19:05:37.472192 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m19:05:37.482044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.stg_orders)
[0m19:05:37.526273 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m19:05:37.612325 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_orders
[0m19:05:37.696327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m19:05:37.767534 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m19:05:37.829644 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m19:05:37.952396 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m19:05:38.291007 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m19:05:38.356293 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m19:05:38.400237 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_orders
[0m19:05:38.462335 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m19:05:38.681781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:05:38.762474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:39.431961 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m19:05:39.434398 [debug] [Thread-2 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m19:05:41.615711 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c56b3296-2095-4b49-8a16-35d94ee5862d&page=queryresults
[0m19:05:41.618885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ffaea35c-4c0c-4036-a694-b088f28b9825&page=queryresults
[0m19:05:42.687480 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c2b30d0>]}
[0m19:05:42.726854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c4bd1d0>]}
[0m19:05:42.741197 [info ] [Thread-2 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.21s]
[0m19:05:42.747805 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.03s]
[0m19:05:42.764095 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_orders
[0m19:05:42.776167 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m19:05:42.791054 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m19:05:42.793206 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m19:05:42.795237 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m19:05:42.818186 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m19:05:42.831219 [info ] [Thread-4 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m19:05:42.848707 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m19:05:42.881967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m19:05:42.910006 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_orders_by_state)
[0m19:05:42.913171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m19:05:42.953697 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m19:05:43.029178 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m19:05:43.132706 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m19:05:43.218487 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:05:43.279181 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m19:05:43.320472 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m19:05:43.479196 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m19:05:43.623404 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:05:43.628546 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m19:05:43.799275 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m19:05:43.803604 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m19:05:43.874247 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m19:05:44.332272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:44.441744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:05:44.615818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:05:44.989690 [debug] [Thread-1 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m19:05:45.292087 [debug] [Thread-4 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m19:05:45.739477 [debug] [Thread-2 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m19:05:47.480693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9fe8fc26-29d6-4b91-b87c-0f51272646db&page=queryresults
[0m19:05:47.574378 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4ce67efc-3b01-433e-9909-5cdb5ada6f76&page=queryresults
[0m19:05:47.682964 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9e1049b2-5f7c-479a-b1f4-f5c91c565966&page=queryresults
[0m19:05:48.364100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c7cb790>]}
[0m19:05:48.388752 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 5.48s]
[0m19:05:48.395030 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m19:05:48.399900 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m19:05:48.406675 [info ] [Thread-3 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m19:05:48.410591 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.fct_avg_delivery_time)
[0m19:05:48.414991 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m19:05:48.446623 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:05:48.476417 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47d45ba10>]}
[0m19:05:48.494731 [info ] [Thread-4 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 5.57s]
[0m19:05:48.535669 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m19:05:48.578348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c14d210>]}
[0m19:05:48.616561 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m19:05:48.690019 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.67s]
[0m19:05:48.723759 [info ] [Thread-1 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m19:05:48.780033 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m19:05:48.838653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m19:05:48.958236 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m19:05:48.970155 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m19:05:48.982438 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m19:05:49.020736 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:05:49.763834 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m19:05:49.881361 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m19:05:49.902760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:05:50.339247 [debug] [Thread-3 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m19:05:50.484742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:50.989565 [debug] [Thread-1 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m19:05:52.671265 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3ef19f11-0fa7-465f-b430-8c7224ed383a&page=queryresults
[0m19:05:52.914832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d37696ef-328c-4592-a63d-8a503c718e0e&page=queryresults
[0m19:05:53.430307 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c799d10>]}
[0m19:05:53.457596 [info ] [Thread-3 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 5.02s]
[0m19:05:53.527747 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m19:05:54.146537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e48f09-3f8a-437b-930f-0ab0a8a8e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c2b9250>]}
[0m19:05:54.210903 [info ] [Thread-1 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 5.31s]
[0m19:05:54.345275 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m19:05:54.391862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:54.409919 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m19:05:54.463622 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m19:05:54.477714 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m19:05:54.510054 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m19:05:54.530569 [info ] [MainThread]: 
[0m19:05:54.539543 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 28.90 seconds (28.90s).
[0m19:05:54.570149 [debug] [MainThread]: Command end result
[0m19:05:56.891868 [info ] [MainThread]: 
[0m19:05:56.894937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:56.939571 [info ] [MainThread]: 
[0m19:05:56.945803 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:05:56.955349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 79.947754, "process_user_time": 27.565634, "process_kernel_time": 7.911213, "process_mem_max_rss": "224328", "process_in_blocks": "210040", "process_out_blocks": "512"}
[0m19:05:56.960527 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:56.959854 after 79.95 seconds
[0m19:05:56.970783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4935e6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49398e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49783d890>]}
[0m19:05:56.986851 [debug] [MainThread]: Flushing usage events
[0m19:13:44.218295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914c78450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914fd3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914cbee10>]}


============================== 19:13:44.288873 | 405f1d01-efe0-462c-9ca8-9784d7e695ee ==============================
[0m19:13:44.288873 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:13:44.311515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m19:13:45.734284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405f1d01-efe0-462c-9ca8-9784d7e695ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914d1ff10>]}
[0m19:13:48.601678 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xcl9rg7w'
[0m19:13:48.614161 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:13:49.776750 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:13:49.782772 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:13:50.008433 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:13:50.041340 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:14:12.763996 [info ] [MainThread]: Installed from version 1.3.0
[0m19:14:12.766519 [info ] [MainThread]: Up to date!
[0m19:14:12.769209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '405f1d01-efe0-462c-9ca8-9784d7e695ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77591628e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775916224ed0>]}
[0m19:14:12.773815 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 28.895128, "process_user_time": 10.229053, "process_kernel_time": 4.603617, "process_mem_max_rss": "98120", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m19:14:12.777390 [debug] [MainThread]: Command `dbt deps` succeeded at 19:14:12.777078 after 28.90 seconds
[0m19:14:12.787115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914c7bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775914c79450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775915f75550>]}
[0m19:14:12.803333 [debug] [MainThread]: Flushing usage events
[0m19:14:27.141807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910ac39dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910ac38110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910ac3a190>]}


============================== 19:14:27.150332 | 525140a0-ae17-4969-959e-2499d7828ff5 ==============================
[0m19:14:27.150332 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:14:27.154825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:33.291647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90f4350f90>]}
[0m19:14:33.562089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910d1389d0>]}
[0m19:14:33.567957 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:14:34.732333 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:14:48.665050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:48.671257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:48.715158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m19:14:48.882466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efbf3950>]}
[0m19:14:50.159183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910b3f4cd0>]}
[0m19:14:50.204406 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m19:14:50.245590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90f4639710>]}
[0m19:14:50.294928 [info ] [MainThread]: 
[0m19:14:50.322655 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:14:50.370749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m19:14:50.388502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:52.563575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m19:14:52.575839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:54.324177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90f45eec90>]}
[0m19:14:54.344292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:54.355021 [info ] [MainThread]: 
[0m19:14:54.453584 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m19:14:54.455073 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m19:14:54.456193 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m19:14:54.458020 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m19:14:54.491025 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m19:14:54.506273 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m19:14:54.527688 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m19:14:54.545929 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m19:14:54.569123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m19:14:54.582573 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m19:14:54.604752 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m19:14:54.621873 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m19:14:54.627281 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m19:14:54.642951 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:14:54.654329 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m19:14:54.658026 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:14:54.776904 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m19:14:54.769660 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:14:54.793050 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m19:14:54.810948 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:14:54.889668 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m19:14:54.897124 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:14:54.923320 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m19:14:54.968889 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m19:14:55.517845 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:14:55.523640 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:14:55.525977 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m19:14:55.543823 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m19:14:55.601739 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:14:55.632846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:55.637157 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:14:55.652946 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:14:55.794595 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m19:14:55.914939 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m19:14:56.176167 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m19:14:56.186679 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m19:14:57.518263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a705ace7-8467-4975-815c-61d5e26c875e&page=queryresults
[0m19:14:57.556170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:acc4f9b8-0d62-4475-977f-d79f9bf44256&page=queryresults
[0m19:14:57.635754 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8977611d-ebae-4e50-8795-00695519b0e2&page=queryresults
[0m19:14:57.638106 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:56ae9ebe-ffcd-4758-873e-dac0f8e96fc2&page=queryresults
[0m19:14:58.503140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910b9a9510>]}
[0m19:14:58.532817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90ef9ffd50>]}
[0m19:14:58.535562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90ef0da810>]}
[0m19:14:58.555629 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 3.91s]
[0m19:14:58.556802 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efb81450>]}
[0m19:14:58.575662 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.96s]
[0m19:14:58.599536 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 3.92s]
[0m19:14:58.619380 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:14:58.626236 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.93s]
[0m19:14:58.654205 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m19:14:58.677282 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m19:14:58.727213 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m19:14:58.754634 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_orders
[0m19:14:58.778702 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m19:14:58.785056 [info ] [Thread-2 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m19:14:58.792183 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m19:14:58.801415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.stg_orders)
[0m19:14:58.805934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m19:14:58.809783 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_orders
[0m19:14:58.821865 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m19:14:58.857717 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m19:14:58.890578 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m19:14:58.973362 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_orders
[0m19:14:59.000086 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m19:14:59.004823 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m19:14:59.053678 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m19:14:59.085889 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:14:59.099296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:59.391211 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m19:14:59.611026 [debug] [Thread-2 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m19:15:01.304356 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e7069e61-f223-4789-b419-8259444b975a&page=queryresults
[0m19:15:01.315099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:743ae201-6727-4fd6-8665-619c7f31ea45&page=queryresults
[0m19:15:02.153919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efcf0290>]}
[0m19:15:02.198973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efa58d10>]}
[0m19:15:02.216923 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.35s]
[0m19:15:02.226969 [info ] [Thread-2 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.39s]
[0m19:15:02.236728 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m19:15:02.244031 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_orders
[0m19:15:02.260054 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m19:15:02.268868 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m19:15:02.270429 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m19:15:02.276653 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m19:15:02.281651 [info ] [Thread-1 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m19:15:02.292728 [info ] [Thread-3 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m19:15:02.297707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.fct_sales_by_category)
[0m19:15:02.301138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m19:15:02.304303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_orders_by_state)
[0m19:15:02.312881 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m19:15:02.320092 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m19:15:02.325185 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m19:15:02.351962 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m19:15:02.395865 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:15:02.445092 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m19:15:02.490111 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m19:15:02.499775 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m19:15:02.506542 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m19:15:02.573032 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m19:15:02.585665 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:15:02.633576 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m19:15:02.684705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.689129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:15:02.696736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:02.900785 [debug] [Thread-1 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m19:15:03.021121 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m19:15:03.185388 [debug] [Thread-3 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m19:15:05.106219 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6e76fe2e-ee3e-41d9-a301-611283258ed7&page=queryresults
[0m19:15:05.113214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:7a25999c-95db-4402-b934-43f8ad2bd1e0&page=queryresults
[0m19:15:05.273740 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c984c388-53b8-4440-9ffd-ed3556060722&page=queryresults
[0m19:15:05.958856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efea6a50>]}
[0m19:15:05.970369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90efa6f890>]}
[0m19:15:05.975513 [info ] [Thread-1 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 3.64s]
[0m19:15:06.012246 [info ] [Thread-3 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 3.67s]
[0m19:15:06.029425 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m19:15:06.070367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90ef02a350>]}
[0m19:15:06.077222 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m19:15:06.087230 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m19:15:06.096924 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.77s]
[0m19:15:06.101920 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m19:15:06.108774 [info ] [Thread-2 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m19:15:06.113285 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m19:15:06.116828 [info ] [Thread-1 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m19:15:06.132752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m19:15:06.127168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_avg_delivery_time)
[0m19:15:06.135812 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m19:15:06.145090 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m19:15:06.170427 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m19:15:06.198406 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:15:06.383928 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m19:15:06.429735 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m19:15:06.432461 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m19:15:06.478882 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:15:06.528574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:06.533754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:06.930722 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m19:15:06.943692 [debug] [Thread-1 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m19:15:08.575159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c95f9a5c-f6f6-42c7-ae97-1f83607d14a6&page=queryresults
[0m19:15:08.583338 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:40c90346-9804-408f-87bc-92ae928fa0b7&page=queryresults
[0m19:15:09.296842 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90ec766450>]}
[0m19:15:09.310522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525140a0-ae17-4969-959e-2499d7828ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90ec71b450>]}
[0m19:15:09.325314 [info ] [Thread-2 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.17s]
[0m19:15:09.331055 [info ] [Thread-1 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 3.18s]
[0m19:15:09.392581 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m19:15:09.344601 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m19:15:09.414432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:09.433446 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m19:15:09.447501 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m19:15:09.463997 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m19:15:09.477806 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m19:15:09.506588 [info ] [MainThread]: 
[0m19:15:09.510653 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 19.18 seconds (19.18s).
[0m19:15:09.530938 [debug] [MainThread]: Command end result
[0m19:15:10.659322 [info ] [MainThread]: 
[0m19:15:10.674129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:10.677829 [info ] [MainThread]: 
[0m19:15:10.682826 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:15:10.707936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.744606, "process_user_time": 22.093668, "process_kernel_time": 4.798906, "process_mem_max_rss": "225524", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m19:15:10.713291 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:10.712898 after 43.75 seconds
[0m19:15:10.758503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910f03d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910bf1b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b910c0f3c50>]}
[0m19:15:10.812828 [debug] [MainThread]: Flushing usage events
[0m19:39:04.748220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e24fffb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e260e7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e24ca4210>]}


============================== 19:39:04.802478 | 69ccab26-8069-46f5-8375-e9179526c953 ==============================
[0m19:39:04.802478 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:39:04.817685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:07.136300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ccab26-8069-46f5-8375-e9179526c953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e24ce5e90>]}
[0m19:39:24.128662 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h6kb3o6p'
[0m19:39:24.181109 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:39:25.138986 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:39:25.183238 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:39:25.918394 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:39:26.099040 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:43:29.541163 [info ] [MainThread]: Installed from version 1.3.0
[0m19:43:29.575107 [info ] [MainThread]: Up to date!
[0m19:43:29.601467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69ccab26-8069-46f5-8375-e9179526c953', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e2637d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e24d42d90>]}
[0m19:43:29.684460 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 266.27985, "process_user_time": 13.455798, "process_kernel_time": 6.24065, "process_mem_max_rss": "98240", "process_in_blocks": "6808", "process_out_blocks": "1264"}
[0m19:43:29.731549 [debug] [MainThread]: Command `dbt deps` succeeded at 19:43:29.731116 after 266.33 seconds
[0m19:43:29.822508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e24fffbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e28ea50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e28ea6090>]}
[0m19:43:29.887779 [debug] [MainThread]: Flushing usage events
[0m19:43:48.544473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff697889d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff697bef410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff697f05690>]}


============================== 19:43:48.634898 | 77c16ccd-54b4-4606-9547-1e6587b6ae19 ==============================
[0m19:43:48.634898 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:43:48.703387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:43:57.159743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff698e3ec50>]}
[0m19:43:57.564922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff699cfcf50>]}
[0m19:43:57.582805 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:43:59.300048 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:44:26.647023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:26.657412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:26.702097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m19:44:27.043538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6806b8810>]}
[0m19:44:28.888461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff680b7f950>]}
[0m19:44:28.906077 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m19:44:28.917620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff68303a690>]}
[0m19:44:28.927070 [info ] [MainThread]: 
[0m19:44:28.955258 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:28.998651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m19:44:29.006997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:31.041232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m19:44:31.142747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:34.403264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff681208b50>]}
[0m19:44:34.463425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:44:34.530368 [info ] [MainThread]: 
[0m19:44:34.689347 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m19:44:34.690767 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m19:44:34.692067 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m19:44:34.693361 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m19:44:34.727697 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m19:44:34.748132 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m19:44:34.768899 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m19:44:34.821307 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m19:44:34.898912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m19:44:34.920364 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m19:44:34.957626 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m19:44:34.989582 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m19:44:34.994516 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m19:44:35.012351 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:44:35.040074 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m19:44:35.057841 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:44:35.144711 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m19:44:35.181922 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:44:35.217963 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m19:44:35.372554 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:44:35.573471 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m19:44:35.575099 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:44:35.576764 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m19:44:35.610597 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m19:44:36.159881 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m19:44:36.191857 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:44:36.188103 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:44:36.198896 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m19:44:36.470437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:36.474914 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:44:36.478623 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:44:36.515088 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:44:36.733688 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m19:44:37.016841 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m19:44:37.265851 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m19:44:37.532177 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m19:44:39.591832 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:bce8b711-61cb-4430-8017-eaa0658ae7ec&page=queryresults
[0m19:44:39.629460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:51c8b615-28e0-4952-9670-bfa57d6f1559&page=queryresults
[0m19:44:39.657550 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9a01df85-de9b-44ff-9495-9266edf4a027&page=queryresults
[0m19:44:39.689183 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a1692ba5-3690-467f-9650-068e11fca856&page=queryresults
[0m19:44:40.494490 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6805df910>]}
[0m19:44:40.481069 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff680574b10>]}
[0m19:44:40.500999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff680845110>]}
[0m19:44:40.610010 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff680575d50>]}
[0m19:44:40.630269 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 5.54s]
[0m19:44:40.788107 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 5.52s]
[0m19:44:40.997037 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m19:44:40.911304 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 5.62s]
[0m19:44:40.946129 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:44:40.855264 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.60s]
[0m19:44:41.081214 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m19:44:41.152314 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m19:44:41.222907 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m19:44:41.251558 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_orders
[0m19:44:41.302656 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m19:44:41.367794 [info ] [Thread-4 (]: 6 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m19:44:41.386655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_sales_by_category)
[0m19:44:41.419260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.stg_orders)
[0m19:44:41.436630 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m19:44:41.460595 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_orders
[0m19:44:41.498234 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m19:44:41.535257 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m19:44:42.084025 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m19:44:42.123583 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_orders
[0m19:44:42.135956 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m19:44:42.173453 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m19:44:42.504286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:44:42.564047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:44:42.969269 [debug] [Thread-3 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m19:44:43.250538 [debug] [Thread-4 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m19:44:44.644365 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4ba7b2a9-30b5-4a15-9086-fd09c2b0b9c5&page=queryresults
[0m19:44:44.660303 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d068abe6-b22a-4c35-b5f2-0eb7c4db6f0a&page=queryresults
[0m19:44:45.380040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6804fc450>]}
[0m19:44:45.405035 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.99s]
[0m19:44:45.424491 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m19:44:45.441440 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m19:44:45.467589 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m19:44:45.481639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff68056f7d0>]}
[0m19:44:45.498699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.fct_sales_by_category)
[0m19:44:45.693949 [info ] [Thread-4 (]: 6 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 4.06s]
[0m19:44:45.759637 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m19:44:45.833672 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_orders
[0m19:44:45.873772 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m19:44:45.906287 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m19:44:45.907540 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m19:44:45.980829 [info ] [Thread-3 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m19:44:46.013103 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m19:44:46.034035 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m19:44:46.063295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m19:44:46.114709 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m19:44:46.209125 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m19:44:46.291293 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:44:46.338614 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m19:44:46.365357 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m19:44:46.422607 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m19:44:46.461494 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m19:44:46.498650 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m19:44:46.499926 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m19:44:46.649738 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m19:44:46.794479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:46.835314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:44:46.864864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:44:47.135413 [debug] [Thread-1 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m19:44:47.415448 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m19:44:47.708874 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m19:44:49.553767 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cd1c8ba8-c79c-45ab-b526-24e73ad47c05&page=queryresults
[0m19:44:49.582911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:37ed4239-9906-4202-901e-ffb01bc78816&page=queryresults
[0m19:44:49.648740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:2de2efdd-7412-454d-8259-1f9cf3ebd0d0&page=queryresults
[0m19:44:50.385731 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6809ab690>]}
[0m19:44:50.405868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6809a8710>]}
[0m19:44:50.410127 [info ] [Thread-3 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.35s]
[0m19:44:50.414439 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.91s]
[0m19:44:50.418622 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m19:44:50.426608 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m19:44:50.431374 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m19:44:50.459676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6805114d0>]}
[0m19:44:50.477896 [info ] [Thread-4 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m19:44:50.491377 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 4.40s]
[0m19:44:50.494318 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_avg_delivery_time)
[0m19:44:50.497619 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m19:44:50.507072 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m19:44:50.511737 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m19:44:50.553040 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:44:50.733160 [info ] [Thread-3 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m19:44:50.883093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m19:44:50.960095 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m19:44:50.998778 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m19:44:51.094696 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m19:44:51.147604 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m19:44:51.148370 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m19:44:51.198760 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m19:44:51.344901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:44:51.376430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:44:51.738847 [debug] [Thread-4 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m19:44:52.152826 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m19:44:54.068275 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ad6b49dc-bcd9-404b-a72a-f549aef6808e&page=queryresults
[0m19:44:54.559049 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:96d79905-98ed-454e-ac0d-e36e529a10f4&page=queryresults
[0m19:44:55.012156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6804d0390>]}
[0m19:44:55.025207 [info ] [Thread-3 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 4.13s]
[0m19:44:55.035670 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m19:44:55.274149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c16ccd-54b4-4606-9547-1e6587b6ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6809f7c10>]}
[0m19:44:55.314803 [info ] [Thread-4 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 4.78s]
[0m19:44:55.320151 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m19:44:55.336975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:55.382691 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m19:44:55.390397 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m19:44:55.395805 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m19:44:55.399578 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m19:44:55.402360 [info ] [MainThread]: 
[0m19:44:55.405969 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 26.45 seconds (26.45s).
[0m19:44:55.424120 [debug] [MainThread]: Command end result
[0m19:44:56.552787 [info ] [MainThread]: 
[0m19:44:56.637977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:44:56.736555 [info ] [MainThread]: 
[0m19:44:56.805722 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:44:56.919374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 69.23264, "process_user_time": 23.348734, "process_kernel_time": 8.994499, "process_mem_max_rss": "227428", "process_in_blocks": "3016", "process_out_blocks": "512"}
[0m19:44:56.951189 [debug] [MainThread]: Command `dbt run` succeeded at 19:44:56.950746 after 69.26 seconds
[0m19:44:56.966105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69a7dc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69ba950d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69ba95b50>]}
[0m19:44:56.968842 [debug] [MainThread]: Flushing usage events
[0m07:58:19.424228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800ded1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800ded1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800ded14d0>]}


============================== 07:58:19.767436 | 6b0a6ceb-fefc-4b22-950e-69027c631365 ==============================
[0m07:58:19.767436 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:58:19.799204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:58:21.391063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0a6ceb-fefc-4b22-950e-69027c631365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800df06f10>]}
[0m07:58:26.031053 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-npifk2to'
[0m07:58:26.035546 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:58:26.570422 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:58:26.587833 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:58:27.026751 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:58:27.140070 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:59:42.379676 [info ] [MainThread]: Installed from version 1.3.0
[0m07:59:42.387291 [info ] [MainThread]: Up to date!
[0m07:59:42.392950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b0a6ceb-fefc-4b22-950e-69027c631365', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800f466090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800df06c50>]}
[0m07:59:42.430475 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 84.460655, "process_user_time": 10.431747, "process_kernel_time": 11.280028, "process_mem_max_rss": "98340", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m07:59:42.446556 [debug] [MainThread]: Command `dbt deps` succeeded at 07:59:42.446062 after 84.48 seconds
[0m07:59:42.475039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800dec2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800dec3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73800f2fbf50>]}
[0m07:59:42.528499 [debug] [MainThread]: Flushing usage events
[0m07:59:59.191649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60520c9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60520c8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60520ca110>]}


============================== 07:59:59.241173 | e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9 ==============================
[0m07:59:59.241173 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:59:59.288882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:09.243875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6037008f50>]}
[0m08:00:09.801362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6054368a10>]}
[0m08:00:09.841108 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m08:00:11.526732 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:01:24.838983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:24.928645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:25.010425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m08:01:25.335446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036e84150>]}
[0m08:01:31.246713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e603707d0d0>]}
[0m08:01:31.370850 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m08:01:31.450098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036e1d550>]}
[0m08:01:31.559735 [info ] [MainThread]: 
[0m08:01:31.661955 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:01:31.800081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m08:01:31.889574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:34.186592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m08:01:34.237830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:36.780086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e603707df50>]}
[0m08:01:36.836212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:01:36.904303 [info ] [MainThread]: 
[0m08:01:37.017234 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m08:01:37.019578 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m08:01:37.025974 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m08:01:37.021041 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m08:01:37.124442 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m08:01:37.170693 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m08:01:37.261258 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m08:01:37.367014 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m08:01:37.428758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m08:01:37.459808 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m08:01:37.512819 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m08:01:37.578953 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m08:01:37.646117 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m08:01:37.785984 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m08:01:37.854882 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m08:01:37.878610 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m08:01:38.003894 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m08:01:38.123946 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m08:01:38.206217 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m08:01:38.308600 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m08:01:39.163575 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m08:01:39.167333 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m08:01:39.446860 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m08:01:39.512490 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m08:01:39.513963 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m08:01:39.585335 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m08:01:39.657324 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m08:01:39.766153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m08:01:40.024403 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:01:40.072412 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:01:40.172278 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:01:40.251833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:40.511558 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m08:01:40.784678 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m08:01:41.088192 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m08:01:41.349435 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m08:01:43.499627 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:2b0bddde-f531-42b8-8e21-7c632329aa9b&page=queryresults
[0m08:01:43.533802 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:315b9fc5-b823-4dc8-b637-c45822354f69&page=queryresults
[0m08:01:43.536237 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e20f2a37-06d4-4af5-aaa3-4b05941e6ac5&page=queryresults
[0m08:01:43.543313 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:abf9eba0-71f5-4827-a03b-eadba8eeed7e&page=queryresults
[0m08:01:44.443421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036363150>]}
[0m08:01:44.451606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036362b90>]}
[0m08:01:44.452870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60363573d0>]}
[0m08:01:44.740602 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 6.87s]
[0m08:01:44.817927 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m08:01:44.663055 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 6.98s]
[0m08:01:44.524844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036e67510>]}
[0m08:01:44.569613 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 6.93s]
[0m08:01:45.167065 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m08:01:45.105599 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 7.10s]
[0m08:01:45.273272 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m08:01:45.199694 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m08:01:45.494709 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m08:01:45.552492 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_sales_by_category)
[0m08:01:45.601833 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m08:01:45.431779 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_orders
[0m08:01:45.022070 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m08:01:45.686587 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m08:01:45.797150 [info ] [Thread-4 (]: 6 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m08:01:46.033697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.stg_orders)
[0m08:01:46.161687 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_orders
[0m08:01:46.328764 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m08:01:46.834574 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m08:01:46.933612 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m08:01:46.961424 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_orders
[0m08:01:47.074796 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m08:01:47.549232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:01:47.674800 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:01:48.166387 [debug] [Thread-3 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m08:01:48.536035 [debug] [Thread-4 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m08:01:50.050678 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d1e6b27e-c388-495a-915e-e5c4b8440cb1&page=queryresults
[0m08:01:50.211354 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:05ef69ef-4425-45a3-9613-e911c1f375d4&page=queryresults
[0m08:01:50.927449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036368fd0>]}
[0m08:01:51.090685 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.37s]
[0m08:01:51.349335 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m08:01:51.171203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036357250>]}
[0m08:01:51.537551 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m08:01:51.592267 [info ] [Thread-4 (]: 6 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.14s]
[0m08:01:51.669896 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_orders
[0m08:01:51.637943 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m08:01:51.769675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.fct_sales_by_category)
[0m08:01:51.738041 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m08:01:51.737177 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m08:01:51.829316 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m08:01:51.861316 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m08:01:51.909231 [info ] [Thread-3 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m08:01:52.089764 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m08:01:52.136361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m08:01:52.362744 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m08:01:52.222305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m08:01:52.648272 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m08:01:52.618050 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m08:01:52.750378 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:01:53.279172 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m08:01:53.296506 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m08:01:53.434674 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m08:01:53.437065 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m08:01:53.514367 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m08:01:53.639315 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:01:54.053516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:01:54.148723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:01:54.229955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:54.770896 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m08:01:55.745421 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m08:01:55.762892 [debug] [Thread-1 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m08:01:58.222420 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4b9e2be5-b1a3-4389-b961-f34ed0f41355&page=queryresults
[0m08:01:58.501882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:81e7d317-b3b3-477d-9734-eead1868976f&page=queryresults
[0m08:01:58.522362 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:373e1bae-c379-4afd-9055-20427d0465e5&page=queryresults
[0m08:01:59.379866 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036348c50>]}
[0m08:01:59.522342 [info ] [Thread-3 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 7.17s]
[0m08:01:59.680527 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m08:01:59.745227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60371e41d0>]}
[0m08:01:59.872193 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 7.98s]
[0m08:01:59.769362 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m08:01:59.937665 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m08:01:59.963181 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e60341e1410>]}
[0m08:02:00.020247 [info ] [Thread-4 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m08:02:00.299116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_avg_delivery_time)
[0m08:02:00.380910 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m08:02:00.185139 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 7.84s]
[0m08:02:00.671345 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m08:02:00.591002 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:02:00.748935 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m08:02:00.829351 [info ] [Thread-3 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m08:02:00.893513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m08:02:01.094973 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m08:02:01.202314 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m08:02:01.460827 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m08:02:01.462793 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m08:02:01.495084 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:02:01.565325 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m08:02:01.866159 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:02:02.254539 [debug] [Thread-4 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m08:02:02.349535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:02:02.893323 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m08:02:05.105560 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8353601d-88c6-4524-bbab-a54d70aecb0e&page=queryresults
[0m08:02:05.734191 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f719eabf-5b43-4e1b-9912-4f594fb60504&page=queryresults
[0m08:02:06.173584 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036c59250>]}
[0m08:02:06.221918 [info ] [Thread-4 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 5.87s]
[0m08:02:06.270015 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m08:02:07.067062 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e82efbeb-3d74-4f7b-9c29-8fca8f82f0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6036cae650>]}
[0m08:02:07.130221 [info ] [Thread-3 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 6.17s]
[0m08:02:07.133391 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m08:02:07.182480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:07.208508 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m08:02:07.225022 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m08:02:07.227344 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m08:02:07.240731 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m08:02:07.242938 [info ] [MainThread]: 
[0m08:02:07.258748 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 35.58 seconds (35.58s).
[0m08:02:07.291362 [debug] [MainThread]: Command end result
[0m08:02:10.022443 [info ] [MainThread]: 
[0m08:02:10.060082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:10.081765 [info ] [MainThread]: 
[0m08:02:10.113245 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:02:10.146544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 131.95409, "process_user_time": 23.00016, "process_kernel_time": 11.103061, "process_mem_max_rss": "227348", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m08:02:10.178580 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:10.178242 after 131.99 seconds
[0m08:02:10.211867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6052233590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6052233410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6056101090>]}
[0m08:02:10.243186 [debug] [MainThread]: Flushing usage events
[0m08:24:00.746420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0db854d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0dda68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0db85750>]}


============================== 08:24:00.813541 | ab7d8ece-79f0-4167-b77d-ecc03f7bc8fb ==============================
[0m08:24:00.813541 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:24:00.833748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:24:01.543907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab7d8ece-79f0-4167-b77d-ecc03f7bc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0dc1bd90>]}
[0m08:24:03.386458 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fgdijz0o'
[0m08:24:03.390591 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:24:04.179683 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:24:04.194002 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:24:04.774298 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:24:04.835157 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:24:37.851642 [info ] [MainThread]: Installed from version 1.3.0
[0m08:24:37.864101 [info ] [MainThread]: Up to date!
[0m08:24:37.870463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ab7d8ece-79f0-4167-b77d-ecc03f7bc8fb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0dbbae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0dc1c910>]}
[0m08:24:37.887458 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 37.687153, "process_user_time": 8.04357, "process_kernel_time": 4.214095, "process_mem_max_rss": "98168", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m08:24:37.921594 [debug] [MainThread]: Command `dbt deps` succeeded at 08:24:37.921260 after 37.72 seconds
[0m08:24:37.945805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0db74f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0db77cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0efaff50>]}
[0m08:24:37.949614 [debug] [MainThread]: Flushing usage events
[0m08:24:52.394288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121e835ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121e8396e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121e835dad0>]}


============================== 08:24:52.468734 | 334a1021-030c-4c17-9e31-b4ab10754d0c ==============================
[0m08:24:52.468734 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:24:52.551682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:25:03.301381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cd497090>]}
[0m08:25:03.814212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121ea7d5390>]}
[0m08:25:03.854365 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m08:25:06.489523 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:25:37.395036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:37.409093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:37.446189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m08:25:37.681302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cd174cd0>]}
[0m08:25:39.830875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cda1a410>]}
[0m08:25:39.897754 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m08:25:39.959932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cf43e690>]}
[0m08:25:39.993040 [info ] [MainThread]: 
[0m08:25:40.013974 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:25:40.091499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m08:25:40.113151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:15.644643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m08:32:15.647593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:32:16.671332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cd4e0690>]}
[0m08:32:16.691799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:32:16.732544 [info ] [MainThread]: 
[0m08:32:16.846755 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m08:32:16.847750 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m08:32:16.848851 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m08:32:16.850232 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m08:32:16.880957 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m08:32:16.928755 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m08:32:16.950410 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m08:32:16.996354 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m08:32:17.023856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m08:32:17.045869 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m08:32:17.062482 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m08:32:17.074355 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m08:32:17.081326 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m08:32:17.098954 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m08:32:17.108676 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m08:32:17.115853 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m08:32:17.174151 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m08:32:17.192608 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m08:32:17.231376 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m08:32:17.279473 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m08:32:17.386495 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m08:32:17.470618 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m08:32:17.503525 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m08:32:17.669846 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m08:32:17.723304 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m08:32:17.725718 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m08:32:17.727332 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m08:32:17.735775 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m08:32:17.781531 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:32:17.804958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:17.810381 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:32:17.815673 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:32:17.952771 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m08:32:18.056023 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m08:32:18.160696 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m08:32:18.308614 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m08:32:19.893733 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ae4be9c0-eead-4533-a98a-d02652cc5e08&page=queryresults
[0m08:32:19.899528 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5d63176b-fe91-43e7-905d-175ef2a8e0a1&page=queryresults
[0m08:32:19.901455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c9c43208-e646-4e8c-8f83-49d340c69da8&page=queryresults
[0m08:32:19.929715 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:81803344-fc19-405e-b23f-d077d4c681e0&page=queryresults
[0m08:32:21.890496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc657790>]}
[0m08:32:21.892780 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc656590>]}
[0m08:32:21.932212 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 4.84s]
[0m08:32:21.945355 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 4.81s]
[0m08:32:21.959627 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m08:32:21.962756 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m08:32:22.023272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc844350>]}
[0m08:32:22.028281 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.00s]
[0m08:32:22.042723 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m08:32:22.046466 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_orders
[0m08:32:22.060702 [info ] [Thread-2 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m08:32:22.102112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc68c390>]}
[0m08:32:22.112653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.stg_orders)
[0m08:32:22.129633 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 5.04s]
[0m08:32:22.144279 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_orders
[0m08:32:22.147865 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m08:32:22.170378 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m08:32:22.200174 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m08:32:22.216055 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m08:32:22.273159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m08:32:22.294043 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m08:32:22.333583 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m08:32:22.408467 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m08:32:22.419777 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m08:32:22.421537 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_orders
[0m08:32:22.455469 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m08:32:22.490681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:32:22.531848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:22.758856 [debug] [Thread-2 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m08:32:22.940145 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m08:32:24.114232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ff31437a-bb4b-4636-befc-3cec0a37d847&page=queryresults
[0m08:32:24.116104 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:21912509-19d4-4477-a0f8-6124dcbb427e&page=queryresults
[0m08:32:24.758992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc6fe210>]}
[0m08:32:24.761790 [info ] [Thread-2 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.65s]
[0m08:32:24.765493 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_orders
[0m08:32:24.782615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc6e9350>]}
[0m08:32:24.784593 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m08:32:24.785977 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m08:32:24.790092 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m08:32:24.794687 [info ] [Thread-3 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m08:32:24.798855 [info ] [Thread-4 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m08:32:24.809420 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m08:32:24.813121 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_avg_delivery_time)
[0m08:32:24.815894 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_orders_by_state)
[0m08:32:24.822644 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m08:32:24.825036 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m08:32:24.828217 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m08:32:24.830854 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m08:32:24.856733 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:32:24.868576 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m08:32:24.913166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m08:32:24.965149 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m08:32:24.982369 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m08:32:25.010108 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m08:32:25.013982 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m08:32:25.022470 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:32:25.047511 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m08:32:25.064131 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m08:32:25.089727 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m08:32:25.128780 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:32:25.143459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:32:25.154874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:32:25.506242 [debug] [Thread-4 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m08:32:25.508686 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m08:32:25.673743 [debug] [Thread-2 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m08:32:29.626411 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:1794175b-d410-44e2-be1e-ae02d9feac2e&page=queryresults
[0m08:32:29.698528 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:26e65f8e-33a8-4e71-8a5b-35cc68450561&page=queryresults
[0m08:32:30.027505 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cd09fbe8-398f-404d-83f9-bca9715dca14&page=queryresults
[0m08:32:30.294507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121e89224d0>]}
[0m08:32:30.297745 [info ] [Thread-3 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 5.48s]
[0m08:32:30.303323 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m08:32:30.312173 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m08:32:30.323278 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m08:32:30.329366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_avg_delivery_time)
[0m08:32:30.332676 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m08:32:30.357333 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:32:30.375928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cd2e49d0>]}
[0m08:32:30.393131 [info ] [Thread-4 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 5.56s]
[0m08:32:30.402613 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m08:32:30.408286 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m08:32:30.440473 [info ] [Thread-3 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m08:32:30.446864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m08:32:30.483175 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m08:32:30.507747 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m08:32:30.539005 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m08:32:30.570002 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m08:32:30.578248 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m08:32:30.591529 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:32:30.594964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:32:30.692080 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m08:32:30.706971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:30.798327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc564d50>]}
[0m08:32:30.800027 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m08:32:30.803259 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.89s]
[0m08:32:30.813740 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m08:32:32.104428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:153634b9-9c57-4763-9387-60d4025d25b0&page=queryresults
[0m08:32:32.109450 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e4b72811-e33f-40a7-927f-cba933a40807&page=queryresults
[0m08:32:32.747042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc7aa310>]}
[0m08:32:32.753182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a1021-030c-4c17-9e31-b4ab10754d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121cc72e590>]}
[0m08:32:32.775179 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m08:32:32.789339 [info ] [Thread-3 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m08:32:32.834683 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m08:32:32.847535 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m08:32:32.863280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:32.869189 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m08:32:32.875259 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m08:32:32.878699 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m08:32:32.881770 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m08:32:32.888451 [info ] [MainThread]: 
[0m08:32:32.902058 [info ] [MainThread]: Finished running 11 view models in 0 hours 6 minutes and 52.87 seconds (412.87s).
[0m08:32:32.919535 [debug] [MainThread]: Command end result
[0m08:32:33.373744 [info ] [MainThread]: 
[0m08:32:33.405281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:32:33.421380 [info ] [MainThread]: 
[0m08:32:33.429886 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:32:33.446107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 461.70914, "process_user_time": 22.040215, "process_kernel_time": 7.773111, "process_mem_max_rss": "228524", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m08:32:33.509654 [debug] [MainThread]: Command `dbt run` succeeded at 08:32:33.509047 after 461.77 seconds
[0m08:32:33.534089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121ec569b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121ec5690d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7121ec569110>]}
[0m08:32:33.542103 [debug] [MainThread]: Flushing usage events
[0m08:35:30.280173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb71b5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb71b5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb71a4710>]}


============================== 08:35:30.377229 | 37d9f475-5139-47fe-9b08-b37edc726a5d ==============================
[0m08:35:30.377229 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:35:30.452881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:35:31.701568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d9f475-5139-47fe-9b08-b37edc726a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb71e6b10>]}
[0m08:35:35.229486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s42h_sn7'
[0m08:35:35.280087 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:35:35.719527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:35:35.723686 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:35:35.950981 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:35:36.034845 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:36:37.790306 [info ] [MainThread]: Installed from version 1.3.0
[0m08:36:37.796026 [info ] [MainThread]: Up to date!
[0m08:36:37.804933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '37d9f475-5139-47fe-9b08-b37edc726a5d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb6f8f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb6f8f4d0>]}
[0m08:36:37.812671 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 68.734924, "process_user_time": 9.767612, "process_kernel_time": 4.562929, "process_mem_max_rss": "98064", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m08:36:37.833682 [debug] [MainThread]: Command `dbt deps` succeeded at 08:36:37.833341 after 68.76 seconds
[0m08:36:37.925033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb73caf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cb6f8f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735cbb3a5110>]}
[0m08:36:37.971323 [debug] [MainThread]: Flushing usage events
[0m08:36:53.021915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd808d9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd80912ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd808d9c10>]}


============================== 08:36:53.039797 | fc2d2a72-3b27-4932-bd33-a83ec2fa903a ==============================
[0m08:36:53.039797 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:36:53.062578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:00.204202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd80932bd0>]}
[0m08:37:00.718348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd82db4ed0>]}
[0m08:37:00.737788 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m08:37:02.463774 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:37:33.620932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:33.623944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:33.665035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m08:37:33.908403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd657cdf10>]}
[0m08:37:36.041171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd6569ba10>]}
[0m08:37:36.058622 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m08:37:36.093817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd65a73150>]}
[0m08:37:36.108606 [info ] [MainThread]: 
[0m08:37:36.113076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:37:36.145829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m08:37:36.168295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:38.750792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m08:37:38.827573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:42.568936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2d2a72-3b27-4932-bd33-a83ec2fa903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddd65ad2cd0>]}
[0m08:37:42.672594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:42.808063 [info ] [MainThread]: 
[0m08:37:42.885780 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m08:37:42.887306 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m08:37:42.888881 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m08:37:42.890236 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m08:37:42.909248 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m08:37:42.925396 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m08:37:43.172165 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m08:37:43.092022 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m08:37:43.143426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m08:37:43.006157 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m08:37:43.431782 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m08:37:43.572840 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m08:37:43.640646 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m08:37:43.669049 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m08:37:43.845312 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m08:37:43.890038 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m08:37:43.977214 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m08:37:44.255229 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m08:37:44.358206 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m08:37:44.535592 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m08:37:44.724412 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m08:37:44.736984 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m08:37:44.762710 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m08:37:44.920653 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m08:37:45.212554 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m08:37:45.228559 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m08:37:45.231440 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m08:37:45.276748 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m08:37:45.513592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:45.576857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:37:45.593557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:37:45.834466 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:37:46.182228 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m08:37:46.664124 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m08:37:46.666443 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m08:37:47.093971 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m08:40:10.177662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c4763f5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c4769d1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c47a4a1b10>]}


============================== 08:40:10.201684 | 1733613e-d3e8-4fe8-8916-9314718e2e5f ==============================
[0m08:40:10.201684 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:40:10.214308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:40:11.457585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1733613e-d3e8-4fe8-8916-9314718e2e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c476259510>]}
[0m08:40:18.908632 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v5mar74k'
[0m08:40:18.914426 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:40:20.903816 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:40:20.955973 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:40:21.777289 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:40:22.010999 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:42:29.084191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb1d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48ad828b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb52a90>]}


============================== 08:42:29.156482 | 277ea57d-6554-4071-a3cc-92bf4a011758 ==============================
[0m08:42:29.156482 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:42:29.188450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:42:30.316624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277ea57d-6554-4071-a3cc-92bf4a011758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48aca18810>]}
[0m08:42:32.494075 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xxohaugw'
[0m08:42:32.524621 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:42:33.131607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:42:33.141600 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:42:33.386571 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:42:33.436584 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:45:55.560379 [info ] [MainThread]: Installed from version 1.3.0
[0m08:45:55.572960 [info ] [MainThread]: Up to date!
[0m08:45:55.596108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '277ea57d-6554-4071-a3cc-92bf4a011758', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb87390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb8d750>]}
[0m08:45:55.699059 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 208.60641, "process_user_time": 12.700018, "process_kernel_time": 6.590319, "process_mem_max_rss": "98312", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m08:45:55.723318 [debug] [MainThread]: Command `dbt deps` succeeded at 08:45:55.722760 after 208.63 seconds
[0m08:45:55.780116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb07810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48acb07950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48b0d3d890>]}
[0m08:45:55.810642 [debug] [MainThread]: Flushing usage events
[0m08:49:08.518996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caaf48d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caaf49510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caaf49490>]}


============================== 08:49:08.687820 | 81b9154f-ba1b-4902-8548-4258709f89d7 ==============================
[0m08:49:08.687820 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:49:08.719143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:49:10.151250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b9154f-ba1b-4902-8548-4258709f89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747cab0bdb10>]}
[0m08:49:26.327817 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8cb5k508'
[0m08:49:26.340696 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:49:26.880333 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:49:26.883476 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:49:27.051848 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:49:27.076892 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:52:02.794502 [info ] [MainThread]: Installed from version 1.3.0
[0m08:52:02.816379 [info ] [MainThread]: Up to date!
[0m08:52:02.893112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '81b9154f-ba1b-4902-8548-4258709f89d7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caafda990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caaf1bf50>]}
[0m08:52:02.964830 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 176.94179, "process_user_time": 11.635278, "process_kernel_time": 8.112274, "process_mem_max_rss": "98196", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m08:52:03.022358 [debug] [MainThread]: Command `dbt deps` succeeded at 08:52:03.021788 after 177.00 seconds
[0m08:52:03.095010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747cab29f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caf1d5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747caf1d5ad0>]}
[0m08:52:03.155098 [debug] [MainThread]: Flushing usage events
[0m08:52:21.096055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b47819790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b47853850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b4781aa50>]}


============================== 08:52:21.133390 | 0396ce9e-28fc-4575-a99f-52598fddd951 ==============================
[0m08:52:21.133390 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:52:21.247642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:30.650452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30ee4f10>]}
[0m08:52:31.269732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b49cf4f10>]}
[0m08:52:31.334416 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m08:52:34.229399 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:53:53.190064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:53.220959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:53.360451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m08:53:53.864794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b306d63d0>]}
[0m08:53:56.120779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b309f8b90>]}
[0m08:53:56.266596 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m08:53:56.360766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30b2e110>]}
[0m08:53:56.476927 [info ] [MainThread]: 
[0m08:53:56.552645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:53:56.700606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m08:53:56.777618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:59.893207 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409_etl_dataset'
[0m08:53:59.944139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:03.300191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b311ee410>]}
[0m08:54:03.348038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:54:03.395675 [info ] [MainThread]: 
[0m08:54:03.460872 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m08:54:03.461973 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m08:54:03.494666 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m08:54:03.510414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m08:54:03.542939 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m08:54:03.463115 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m08:54:03.475894 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m08:54:03.492030 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m08:54:03.844539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now model.ecommerce_project.stg_customers)
[0m08:54:03.875204 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m08:54:03.795222 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m08:54:03.736873 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m08:54:04.025302 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m08:54:04.056527 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m08:54:03.987758 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m08:54:03.771339 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m08:54:03.975719 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m08:54:04.140350 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m08:54:04.184262 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m08:54:04.263941 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m08:54:04.312443 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m08:54:04.327927 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m08:54:04.376853 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m08:54:04.615573 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m08:54:05.739406 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m08:54:05.768494 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m08:54:05.767206 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m08:54:05.878868 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m08:54:06.111891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:54:06.157629 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:54:06.174566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:06.251165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:07.272169 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m08:54:07.274484 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m08:54:07.693868 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m08:54:07.997778 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m08:54:09.683720 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:47355e3c-254b-4cca-b145-1a7bae11ea1f&page=queryresults
[0m08:54:09.696584 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cac67570-533d-44e5-a0d4-1b6b3e43bbc5&page=queryresults
[0m08:54:09.711334 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:86aa9d61-552f-47c4-b1f2-9562941cb101&page=queryresults
[0m08:54:09.758864 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d69db620-c357-4870-bf46-383d1fd4da30&page=queryresults
[0m08:54:10.738663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b304ef7d0>]}
[0m08:54:10.786904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30aed2d0>]}
[0m08:54:10.789405 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b305a2e90>]}
[0m08:54:10.892257 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 6.70s]
[0m08:54:10.925549 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m08:54:10.865135 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 7.28s]
[0m08:54:11.039982 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m08:54:10.841134 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 6.75s]
[0m08:54:11.087075 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m08:54:11.136407 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m08:54:11.154055 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m08:54:11.071416 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m08:54:10.773938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30aede90>]}
[0m08:54:11.172117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m08:54:11.255794 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m08:54:11.224908 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 6.93s]
[0m08:54:11.325980 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m08:54:11.311480 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m08:54:11.199883 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m08:54:11.357666 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m08:54:11.372688 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m08:54:11.446962 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m08:54:11.521775 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m08:54:11.555668 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m08:54:11.556684 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m08:54:11.620267 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m08:54:11.674980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:11.706540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:12.027232 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m08:54:12.431769 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m08:54:13.963154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d5b2b8d9-eb12-4d80-9192-c988dd3dd08a&page=queryresults
[0m08:54:13.978556 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:79048a30-1ea3-4450-aa58-3f48d43457b3&page=queryresults
[0m08:54:14.758943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b305aff90>]}
[0m08:54:14.767635 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.59s]
[0m08:54:14.827252 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m08:54:14.811156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b3080c910>]}
[0m08:54:14.852966 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m08:54:14.875145 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.45s]
[0m08:54:14.959884 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m08:54:14.906240 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m08:54:14.995105 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m08:54:14.996043 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m08:54:15.046094 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.fct_sales_by_category)
[0m08:54:15.199904 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m08:54:15.167386 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m08:54:15.251277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m08:54:15.283605 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m08:54:15.108191 [info ] [Thread-1 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m08:54:15.354646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m08:54:15.317803 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m08:54:15.233817 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m08:54:15.378351 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m08:54:15.537635 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:54:15.581208 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m08:54:15.629830 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m08:54:15.636928 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m08:54:15.684615 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m08:54:15.699826 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m08:54:15.722660 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m08:54:15.738580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:15.756174 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:54:16.023692 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:54:16.053429 [debug] [Thread-1 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m08:54:16.631688 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m08:54:17.332772 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m08:54:19.230884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:783a3afe-7f95-4c74-89c8-76ca43553d9c&page=queryresults
[0m08:54:19.461001 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a19de8a3-491b-40c9-a19b-4cee75afbcb7&page=queryresults
[0m08:54:20.125631 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a5255d68-d598-4593-9f01-965aefdd14fd&page=queryresults
[0m08:54:20.952474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b48f62c10>]}
[0m08:54:20.969293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b306f1f10>]}
[0m08:54:21.176661 [info ] [Thread-1 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 5.60s]
[0m08:54:21.339954 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.93s]
[0m08:54:21.556064 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m08:54:21.700113 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m08:54:21.764205 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m08:54:22.113675 [info ] [Thread-3 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m08:54:22.161143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_avg_delivery_time)
[0m08:54:22.209965 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m08:54:21.939067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30569ad0>]}
[0m08:54:22.546524 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 6.68s]
[0m08:54:22.355730 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:54:22.674973 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m08:54:22.809629 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m08:54:22.851818 [info ] [Thread-1 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m08:54:22.899925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m08:54:22.948652 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m08:54:23.064150 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m08:54:23.336287 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m08:54:23.508644 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m08:54:23.511916 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m08:54:23.829167 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m08:54:24.102331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:24.118760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:54:24.921027 [debug] [Thread-1 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m08:54:24.952886 [debug] [Thread-3 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m08:54:26.974486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:49d77d3f-2ed5-4aec-9580-b8d607c3860f&page=queryresults
[0m08:54:27.232780 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f5175838-0dea-4dcf-b719-9693f7febe50&page=queryresults
[0m08:54:27.781569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b30541450>]}
[0m08:54:27.841852 [info ] [Thread-1 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 4.88s]
[0m08:54:27.918238 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m08:54:28.176053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0396ce9e-28fc-4575-a99f-52598fddd951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b305a09d0>]}
[0m08:54:28.319925 [info ] [Thread-3 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 6.02s]
[0m08:54:28.380799 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m08:54:28.605608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:28.891163 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m08:54:28.962348 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m08:54:29.011905 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m08:54:29.232727 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m08:54:29.622674 [info ] [MainThread]: 
[0m08:54:29.718733 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 33.07 seconds (33.07s).
[0m08:54:29.786179 [debug] [MainThread]: Command end result
[0m08:54:32.461199 [info ] [MainThread]: 
[0m08:54:32.478326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:54:32.494041 [info ] [MainThread]: 
[0m08:54:32.509915 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:54:32.525495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 133.10976, "process_user_time": 25.829178, "process_kernel_time": 8.547836, "process_mem_max_rss": "226476", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m08:54:32.528661 [debug] [MainThread]: Command `dbt run` succeeded at 08:54:32.528232 after 133.12 seconds
[0m08:54:32.557535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b47b05810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b47e68c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756b485d5290>]}
[0m08:54:32.561288 [debug] [MainThread]: Flushing usage events
[0m09:21:44.764694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa81230250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa81266390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa81258710>]}


============================== 09:21:44.792373 | d710e52e-bea0-4c29-818e-93a31551e4cb ==============================
[0m09:21:44.792373 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:21:44.796194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:21:45.041393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd710e52e-bea0-4c29-818e-93a31551e4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa812c8f10>]}
[0m09:21:45.747671 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qu3b_7xx'
[0m09:21:45.750588 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:21:46.211588 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:21:46.215441 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:21:46.355738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:21:46.367152 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:22:13.530772 [info ] [MainThread]: Installed from version 1.3.0
[0m09:22:13.547213 [info ] [MainThread]: Up to date!
[0m09:22:13.578654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd710e52e-bea0-4c29-818e-93a31551e4cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa82846190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa81297450>]}
[0m09:22:13.585848 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 29.069435, "process_user_time": 6.847751, "process_kernel_time": 2.617554, "process_mem_max_rss": "98612", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m09:22:13.594129 [debug] [MainThread]: Command `dbt deps` succeeded at 09:22:13.593391 after 29.08 seconds
[0m09:22:13.600449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8561d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa854acf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa854adf50>]}
[0m09:22:13.610171 [debug] [MainThread]: Flushing usage events
[0m09:22:27.614128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997943f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997943b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997b42910>]}


============================== 09:22:27.632249 | 2f44e571-91b0-4496-9d8d-049eca436b1c ==============================
[0m09:22:27.632249 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:22:27.646108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:22:34.186328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997789510>]}
[0m09:22:34.612290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc999bf0fd0>]}
[0m09:22:34.615465 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:22:35.297853 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:22:46.022730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:22:46.115072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:22:46.195538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m09:22:46.470119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980753550>]}
[0m09:22:49.914359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9810de910>]}
[0m09:22:50.008064 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m09:22:50.020799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980732010>]}
[0m09:22:50.033688 [info ] [MainThread]: 
[0m09:22:50.041452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:22:50.082811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m09:22:50.088349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:51.651577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m09:22:51.658633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:53.627576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc98109a950>]}
[0m09:22:53.651352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:53.680114 [info ] [MainThread]: 
[0m09:22:53.736404 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m09:22:53.725917 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m09:22:53.738495 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m09:22:53.740048 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m09:22:53.743186 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m09:22:53.746824 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m09:22:53.751576 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m09:22:53.759424 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m09:22:53.771787 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m09:22:53.776972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m09:22:53.781024 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m09:22:53.784318 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m09:22:53.787615 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:22:53.789884 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m09:22:53.792353 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m09:22:53.795192 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:22:53.843664 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:22:53.859458 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m09:22:53.895214 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m09:22:53.905934 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:22:54.028071 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m09:22:54.041091 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:22:54.065060 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m09:22:54.129192 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m09:22:54.378659 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:22:54.380780 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m09:22:54.366087 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:22:54.382794 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m09:22:54.397289 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:22:54.398377 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:22:54.405158 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:22:54.411979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:54.597537 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m09:22:54.766277 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m09:22:54.967449 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m09:22:55.133328 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m09:22:56.480817 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:28b0821a-85d5-4ad7-ba18-27aba7856f5d&page=queryresults
[0m09:22:56.498399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:bb74556e-5be1-49c7-8362-05a0c79682d8&page=queryresults
[0m09:22:56.568029 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4c6a7d2a-8f59-46e5-8f91-67b14a571150&page=queryresults
[0m09:22:56.629250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e5481b28-df38-4f58-8856-bb31f3ca2d73&page=queryresults
[0m09:22:57.288302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980404c90>]}
[0m09:22:57.292348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc98037aa90>]}
[0m09:22:57.298679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9803d3e90>]}
[0m09:22:57.305048 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.50s]
[0m09:22:57.309354 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 3.51s]
[0m09:22:57.313549 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 3.53s]
[0m09:22:57.321405 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m09:22:57.324888 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m09:22:57.328536 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:22:57.334253 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m09:22:57.346181 [info ] [Thread-4 (]: 5 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m09:22:57.377704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_sales_by_category)
[0m09:22:57.392145 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m09:22:57.405230 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m09:22:57.452315 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m09:22:57.499555 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m09:22:57.536066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:57.690653 [debug] [Thread-4 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m09:22:57.723704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9804f2250>]}
[0m09:22:57.729449 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.95s]
[0m09:22:57.734690 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m09:22:57.739223 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m09:22:57.744033 [info ] [Thread-3 (]: 6 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m09:22:57.746807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m09:22:57.750192 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m09:22:57.772837 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m09:22:57.807148 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m09:22:57.818285 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m09:22:57.844674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:58.007967 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m09:22:59.138653 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ad0a927d-39bc-43b2-af56-f8e8eb0489f5&page=queryresults
[0m09:22:59.602738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e996aaa8-c46a-4094-a8d3-1a1e4f79f47c&page=queryresults
[0m09:23:00.003631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980453a50>]}
[0m09:23:00.058551 [info ] [Thread-4 (]: 5 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.64s]
[0m09:23:00.129252 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m09:23:00.175061 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m09:23:00.229304 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m09:23:00.241579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.fct_sales_by_category)
[0m09:23:00.257858 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m09:23:00.278062 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m09:23:00.511925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9803b2350>]}
[0m09:23:00.586145 [info ] [Thread-3 (]: 6 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m09:23:00.628836 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m09:23:00.655561 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m09:23:00.656558 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m09:23:00.735338 [info ] [Thread-4 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m09:23:00.771057 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m09:23:00.797489 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m09:23:00.830331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m09:23:00.846228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m09:23:01.064590 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m09:23:00.930229 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m09:23:00.914260 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m09:23:01.170324 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m09:23:01.261320 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:23:01.556643 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m09:23:01.620664 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m09:23:01.622922 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m09:23:01.651240 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:23:01.761510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:02.178926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:02.180158 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:23:02.217831 [debug] [Thread-1 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m09:23:02.725422 [debug] [Thread-4 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m09:23:02.729431 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m09:23:04.341176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4ef5b563-25bc-40ee-8c4b-1a1b810efe26&page=queryresults
[0m09:23:04.534989 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f769c4f4-9f14-45e5-9cf1-9f6eb7ef0a96&page=queryresults
[0m09:23:04.663054 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a803b765-0b3c-40ec-8223-3a824bf10d01&page=queryresults
[0m09:23:05.120802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980443a50>]}
[0m09:23:05.250222 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.88s]
[0m09:23:05.277120 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m09:23:05.502633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980401090>]}
[0m09:23:05.510456 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 4.66s]
[0m09:23:05.518334 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m09:23:05.529570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9806abd50>]}
[0m09:23:05.538257 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m09:23:05.542859 [info ] [Thread-4 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.70s]
[0m09:23:05.545872 [info ] [Thread-3 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m09:23:05.552017 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m09:23:05.558520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_orders_by_state)
[0m09:23:05.563094 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m09:23:05.565744 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m09:23:05.568885 [info ] [Thread-2 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m09:23:05.590367 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m09:23:05.592065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m09:23:05.599648 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m09:23:05.629505 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:23:05.662146 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m09:23:05.695575 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m09:23:05.698909 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m09:23:05.734841 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:23:05.759894 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:23:05.763672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:05.988523 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m09:23:06.223019 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m09:23:07.573018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:0b4c5b4a-5c03-470a-b1b0-c5a8d840a280&page=queryresults
[0m09:23:07.728541 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ea7c8d29-b1ec-47ff-a6ad-df76eec6d767&page=queryresults
[0m09:23:08.285326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980598c50>]}
[0m09:23:08.290499 [info ] [Thread-2 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 2.69s]
[0m09:23:08.294955 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m09:23:08.366691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f44e571-91b0-4496-9d8d-049eca436b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc980279a50>]}
[0m09:23:08.374718 [info ] [Thread-3 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 2.81s]
[0m09:23:08.378594 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m09:23:08.385296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:08.390469 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m09:23:08.394619 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m09:23:08.418549 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m09:23:08.422181 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m09:23:08.434545 [info ] [MainThread]: 
[0m09:23:08.451098 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 18.39 seconds (18.39s).
[0m09:23:08.471704 [debug] [MainThread]: Command end result
[0m09:23:12.824495 [info ] [MainThread]: 
[0m09:23:12.841477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:12.859983 [info ] [MainThread]: 
[0m09:23:12.907612 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:23:12.978547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.926346, "process_user_time": 21.17789, "process_kernel_time": 4.50178, "process_mem_max_rss": "226988", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m09:23:13.045922 [debug] [MainThread]: Command `dbt run` succeeded at 09:23:13.045455 after 45.99 seconds
[0m09:23:13.079350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997788ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc9989d7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc997943910>]}
[0m09:23:13.099374 [debug] [MainThread]: Flushing usage events
[0m09:28:10.525182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706deb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef709be1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706debdd0>]}


============================== 09:28:10.665024 | 9f7c2504-7a64-4647-b161-077a863aacc7 ==============================
[0m09:28:10.665024 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:28:10.695486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m09:28:11.940406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f7c2504-7a64-4647-b161-077a863aacc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706e75390>]}
[0m09:28:14.877483 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1fsnqjed'
[0m09:28:14.888531 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:28:15.748780 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:28:15.752841 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:28:16.005316 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:28:16.094907 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:28:59.449155 [info ] [MainThread]: Installed from version 1.3.0
[0m09:28:59.453069 [info ] [MainThread]: Up to date!
[0m09:28:59.458046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f7c2504-7a64-4647-b161-077a863aacc7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef7083b7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706d8fa50>]}
[0m09:28:59.471744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 49.74422, "process_user_time": 8.984141, "process_kernel_time": 4.194582, "process_mem_max_rss": "98224", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m09:28:59.484136 [debug] [MainThread]: Command `dbt deps` succeeded at 09:28:59.483687 after 49.76 seconds
[0m09:28:59.486704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef707022dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706df0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef706df3d50>]}
[0m09:28:59.499026 [debug] [MainThread]: Flushing usage events
[0m09:29:13.666716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ade6e1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ade714350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ade7145d0>]}


============================== 09:29:13.676380 | f89fe07d-d5aa-4411-b8d6-cbf4214a18ad ==============================
[0m09:29:13.676380 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:29:13.684835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:18.895869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ade703d50>]}
[0m09:29:19.509654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ae0be0a50>]}
[0m09:29:19.589884 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:29:21.148906 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:29:26.984173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:29:26.986589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:29:27.047847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m09:29:27.246851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac3889ed0>]}
[0m09:29:28.134779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac36d38d0>]}
[0m09:29:28.156892 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m09:29:28.162811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac8089a50>]}
[0m09:29:28.183476 [info ] [MainThread]: 
[0m09:29:28.199675 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:29:28.228994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m09:29:28.233385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:30.004215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m09:29:30.032624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:31.495514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ada98c9d0>]}
[0m09:29:31.499930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:29:31.534418 [info ] [MainThread]: 
[0m09:29:31.642771 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m09:29:31.631280 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m09:29:31.644868 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m09:29:31.647105 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m09:29:31.653729 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m09:29:31.658925 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m09:29:31.682566 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m09:29:31.704750 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m09:29:31.726179 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m09:29:31.730908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m09:29:31.743259 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m09:29:31.746699 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m09:29:31.749308 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:29:31.752658 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m09:29:31.756444 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m09:29:31.760193 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:29:31.806438 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:29:31.835726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m09:29:31.854542 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m09:29:31.888835 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:29:31.915485 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:29:31.919180 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m09:29:31.920251 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m09:29:31.949260 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m09:29:32.215686 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:29:32.230415 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:29:32.233390 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m09:29:32.240155 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m09:29:32.291964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:29:32.299833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:32.430408 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m09:29:32.308598 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:29:32.606498 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:29:32.615195 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m09:29:32.866254 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m09:29:32.886827 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m09:29:33.880512 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a6aeca2e-4f0c-4978-b869-979ca3221b76&page=queryresults
[0m09:29:34.001154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:71ba6525-1a43-423d-9505-367f465e8cce&page=queryresults
[0m09:29:34.115210 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cd7ba0a2-f859-4600-a46d-851e49b25401&page=queryresults
[0m09:29:34.210626 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:708a355d-8a2c-4724-a95f-161b876fa364&page=queryresults
[0m09:29:34.593083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b0b050>]}
[0m09:29:34.603072 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 2.85s]
[0m09:29:34.609318 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m09:29:34.685278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b6ee50>]}
[0m09:29:34.691293 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.95s]
[0m09:29:34.696730 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m09:29:34.700067 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m09:29:34.704942 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m09:29:34.710001 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m09:29:34.712971 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m09:29:34.725244 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m09:29:34.743579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b8f890>]}
[0m09:29:34.747859 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 3.02s]
[0m09:29:34.756915 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:29:34.760447 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m09:29:34.770107 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m09:29:34.788335 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:29:34.920486 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m09:29:34.919347 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b6c9d0>]}
[0m09:29:34.934930 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.17s]
[0m09:29:34.951788 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m09:29:34.958064 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m09:29:34.961316 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m09:29:34.965703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m09:29:34.973363 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m09:29:34.986366 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m09:29:35.049514 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m09:29:35.064723 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m09:29:35.099770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:35.226327 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m09:29:36.160709 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:06afc257-d777-4939-bc62-8123a1b4bf25&page=queryresults
[0m09:29:36.536566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d73ba834-6959-4cf0-a640-d1ec4e0f3a03&page=queryresults
[0m09:29:36.815889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2bdf890>]}
[0m09:29:36.825156 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m09:29:36.834149 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m09:29:36.838226 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m09:29:36.839264 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m09:29:36.844529 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m09:29:36.851012 [info ] [Thread-2 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m09:29:36.856731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_avg_delivery_time)
[0m09:29:36.862879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m09:29:36.873262 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m09:29:36.877886 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m09:29:36.910497 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:29:36.948397 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m09:29:36.971680 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m09:29:37.004681 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m09:29:36.993240 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:29:37.044934 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m09:29:37.082774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:29:37.090016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:29:37.269959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac0217890>]}
[0m09:29:37.296420 [debug] [Thread-4 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m09:29:37.392186 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.30s]
[0m09:29:37.559222 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m09:29:37.565366 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m09:29:37.593195 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m09:29:37.602165 [info ] [Thread-3 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m09:29:37.605713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m09:29:37.609198 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m09:29:37.625099 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m09:29:37.641780 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m09:29:37.656886 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m09:29:37.677477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:29:37.763912 [debug] [Thread-3 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m09:29:38.825681 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4b032eba-a443-4edf-b45d-baf34a7b51cd&page=queryresults
[0m09:29:39.019309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9c603b80-1e42-4889-b54f-110fb901e1c4&page=queryresults
[0m09:29:39.225036 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:27495830-3250-4cee-9e1f-750b4f8fdf1d&page=queryresults
[0m09:29:39.454381 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac0215050>]}
[0m09:29:39.565474 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 2.60s]
[0m09:29:39.631369 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m09:29:39.678311 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m09:29:39.705204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac355a450>]}
[0m09:29:39.733554 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m09:29:39.782685 [info ] [Thread-3 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m09:29:39.810544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_avg_delivery_time)
[0m09:29:39.815713 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m09:29:39.841602 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m09:29:39.894461 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:29:39.911771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac0222290>]}
[0m09:29:39.950110 [info ] [Thread-2 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m09:29:39.971692 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m09:29:39.989324 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m09:29:39.994646 [info ] [Thread-4 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m09:29:40.001395 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m09:29:40.018268 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m09:29:40.072427 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m09:29:40.095403 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m09:29:40.139369 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:29:40.145888 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m09:29:40.177347 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m09:29:40.212109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:40.234350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:29:40.382638 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m09:29:40.541200 [debug] [Thread-4 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m09:29:41.932864 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:301afde4-c00b-4399-90a9-58b2748286c1&page=queryresults
[0m09:29:41.970555 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:360b0ac3-c553-46bb-af44-a53abcc288b0&page=queryresults
[0m09:29:42.581758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac023c2d0>]}
[0m09:29:42.597179 [info ] [Thread-4 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 2.57s]
[0m09:29:42.604076 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m09:29:42.943038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89fe07d-d5aa-4411-b8d6-cbf4214a18ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2bdf890>]}
[0m09:29:42.948638 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.13s]
[0m09:29:42.952254 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m09:29:42.966302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:42.969229 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m09:29:43.146620 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m09:29:43.233048 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m09:29:43.256414 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m09:29:43.264011 [info ] [MainThread]: 
[0m09:29:43.281679 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 15.06 seconds (15.06s).
[0m09:29:43.303637 [debug] [MainThread]: Command end result
[0m09:29:44.244656 [info ] [MainThread]: 
[0m09:29:44.252818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:44.256429 [info ] [MainThread]: 
[0m09:29:44.263710 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:29:44.280777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.262833, "process_user_time": 20.491833, "process_kernel_time": 4.117491, "process_mem_max_rss": "227536", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m09:29:44.286304 [debug] [MainThread]: Command `dbt run` succeeded at 09:29:44.285838 after 31.27 seconds
[0m09:29:44.289635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756ac2b03350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756adfb9b910>]}
[0m09:29:44.294710 [debug] [MainThread]: Flushing usage events
[0m09:39:42.980026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89e512d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf8abbcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89e51010>]}


============================== 09:39:43.005308 | ba0d8ba9-15be-41e3-9783-685745f31779 ==============================
[0m09:39:43.005308 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:39:43.015096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:39:43.639479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba0d8ba9-15be-41e3-9783-685745f31779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89f11690>]}
[0m09:39:46.594704 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gx8ixgor'
[0m09:39:46.612359 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:39:47.318691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:39:47.352227 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:39:47.633024 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:39:47.674008 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:40:15.626762 [info ] [MainThread]: Installed from version 1.3.0
[0m09:40:15.629166 [info ] [MainThread]: Up to date!
[0m09:40:15.633052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba0d8ba9-15be-41e3-9783-685745f31779', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89e78450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf8a072bd0>]}
[0m09:40:15.637849 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 33.006912, "process_user_time": 8.93878, "process_kernel_time": 2.761659, "process_mem_max_rss": "98228", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m09:40:15.649229 [debug] [MainThread]: Command `dbt deps` succeeded at 09:40:15.648854 after 33.02 seconds
[0m09:40:15.657408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89e40f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf8a49d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf89edb790>]}
[0m09:40:15.660219 [debug] [MainThread]: Flushing usage events
[0m09:40:30.740185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a1651a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a16521d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a1652110>]}


============================== 09:40:30.760305 | 67bb760f-8e5b-4751-bdd9-c6b4d7cf7446 ==============================
[0m09:40:30.760305 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:40:30.766387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:40:39.535845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461867d0090>]}
[0m09:40:40.121038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a3ac4f50>]}
[0m09:40:40.180137 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:40:43.191763 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:41:05.314193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:05.318496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:05.360508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m09:41:05.606810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461864cd110>]}
[0m09:41:06.683106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461867dd590>]}
[0m09:41:06.706901 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m09:41:06.721795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461867fde90>]}
[0m09:41:06.765868 [info ] [MainThread]: 
[0m09:41:06.785220 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:41:06.821661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m09:41:06.832177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:09.239472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m09:41:09.246329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:11.219472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618690a710>]}
[0m09:41:11.320016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:41:11.370257 [info ] [MainThread]: 
[0m09:41:11.437812 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m09:41:11.453614 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m09:41:11.454807 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m09:41:11.456058 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m09:41:11.524846 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m09:41:11.610371 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m09:41:11.658244 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m09:41:11.679634 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m09:41:11.724685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m09:41:11.757330 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m09:41:11.768727 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m09:41:11.846696 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m09:41:11.925151 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m09:41:11.992491 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:41:12.072329 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m09:41:12.118078 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:41:12.376687 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m09:41:12.468389 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:41:12.698529 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m09:41:12.877954 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:41:13.124919 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m09:41:13.159372 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:41:13.169209 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m09:41:13.464251 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m09:41:13.515564 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:41:13.516857 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m09:41:13.511757 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m09:41:13.595804 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:41:13.816284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:13.832983 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:41:13.865067 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:41:13.909676 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:41:14.342214 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m09:41:14.376786 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m09:41:14.650428 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m09:41:14.910468 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m09:41:16.619340 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:62cd7d4c-c9c8-40a6-8d23-868a85032342&page=queryresults
[0m09:41:16.639017 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ae241829-8db2-4361-be68-ae8435de528e&page=queryresults
[0m09:41:16.710915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d9efcc59-4a96-4f6c-b18f-4e1425390e3e&page=queryresults
[0m09:41:16.894024 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8b29d45b-98f2-449b-8c3b-d54c34f77c66&page=queryresults
[0m09:41:17.574608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746186567090>]}
[0m09:41:17.605179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618680f210>]}
[0m09:41:17.607083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746185a53d50>]}
[0m09:41:17.684756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461865641d0>]}
[0m09:41:17.706230 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 5.71s]
[0m09:41:17.825991 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.88s]
[0m09:41:17.923697 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 5.84s]
[0m09:41:18.015715 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 5.92s]
[0m09:41:18.201057 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m09:41:18.362271 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m09:41:18.577932 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:41:18.626150 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m09:41:18.716541 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_orders
[0m09:41:18.823122 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m09:41:18.870531 [info ] [Thread-4 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m09:41:18.953730 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m09:41:19.017245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.stg_orders)
[0m09:41:19.075954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m09:41:19.128445 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_orders
[0m09:41:19.160195 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m09:41:19.225586 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m09:41:19.357496 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m09:41:19.610316 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_orders
[0m09:41:19.674048 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m09:41:19.676351 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m09:41:19.729488 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m09:41:19.918358 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:41:19.964653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:20.286659 [debug] [Thread-4 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m09:41:20.538255 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m09:41:22.385815 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:7f8a7623-2ca4-4e2a-8d3a-b8a25372a4ea&page=queryresults
[0m09:41:22.387988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:35471274-0580-4ef0-b78f-26030056501b&page=queryresults
[0m09:41:23.254827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746185ad7a10>]}
[0m09:41:23.276147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746185ad7150>]}
[0m09:41:23.284957 [info ] [Thread-4 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 4.24s]
[0m09:41:23.334369 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.20s]
[0m09:41:23.376947 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_orders
[0m09:41:23.392189 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m09:41:23.404917 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m09:41:23.406065 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m09:41:23.423596 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m09:41:23.538591 [info ] [Thread-3 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m09:41:23.581844 [info ] [Thread-2 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m09:41:23.595111 [info ] [Thread-4 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m09:41:23.620280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_avg_delivery_time)
[0m09:41:23.692681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m09:41:23.886597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m09:41:23.902785 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m09:41:23.947176 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m09:41:24.159169 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m09:41:24.192526 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:41:24.225185 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m09:41:24.247094 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m09:41:24.271901 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m09:41:24.272956 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m09:41:24.274032 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m09:41:24.320490 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:41:24.343216 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m09:41:24.352945 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m09:41:24.386512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:41:24.387760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:41:24.403872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:24.634645 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m09:41:24.859507 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m09:41:25.117465 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m09:41:26.809658 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c29b4928-dafa-4685-bd4d-22781eb949a4&page=queryresults
[0m09:41:26.816571 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4eb8d9c2-56c0-480d-9a3f-ad7322ade3ed&page=queryresults
[0m09:41:26.947949 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e0d2f90a-45a1-4274-8c7f-746dd874ade5&page=queryresults
[0m09:41:27.864800 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746186566390>]}
[0m09:41:27.880775 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461868cc950>]}
[0m09:41:27.939342 [info ] [Thread-4 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.97s]
[0m09:41:27.948773 [info ] [Thread-2 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 4.19s]
[0m09:41:27.956442 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m09:41:28.064741 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m09:41:28.326665 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m09:41:28.372831 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m09:41:28.420928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_orders_by_state)
[0m09:41:28.530855 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m09:41:28.584534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618677aa10>]}
[0m09:41:28.639524 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m09:41:28.659729 [info ] [Thread-3 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.96s]
[0m09:41:28.693778 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m09:41:28.707897 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m09:41:28.726238 [info ] [Thread-2 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m09:41:28.738381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m09:41:28.774690 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m09:41:28.820462 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:41:29.052518 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m09:41:29.063615 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m09:41:29.094923 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m09:41:29.124282 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:41:29.394806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:29.644700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:30.039353 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m09:41:30.277247 [debug] [Thread-1 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m09:41:31.630142 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:75684738-5063-4ec4-b1f2-9fa07950d9d8&page=queryresults
[0m09:41:32.437296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746185b189d0>]}
[0m09:41:32.443652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:646c00f5-4471-4c03-ad60-1ca24da0cb1a&page=queryresults
[0m09:41:32.584743 [info ] [Thread-2 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.70s]
[0m09:41:32.749795 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m09:41:33.449680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bb760f-8e5b-4751-bdd9-c6b4d7cf7446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a165de10>]}
[0m09:41:33.637667 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 5.03s]
[0m09:41:33.730886 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m09:41:33.769690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:33.809811 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m09:41:33.828610 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m09:41:33.876543 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m09:41:33.923510 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m09:41:33.999882 [info ] [MainThread]: 
[0m09:41:34.021766 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 27.21 seconds (27.21s).
[0m09:41:34.075164 [debug] [MainThread]: Command end result
[0m09:41:35.169594 [info ] [MainThread]: 
[0m09:41:35.186429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:41:35.197667 [info ] [MainThread]: 
[0m09:41:35.201950 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:41:35.208021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 65.7977, "process_user_time": 23.05942, "process_kernel_time": 4.597537, "process_mem_max_rss": "226944", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m09:41:35.211476 [debug] [MainThread]: Command `dbt run` succeeded at 09:41:35.210973 after 65.80 seconds
[0m09:41:35.224544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a183a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a183a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461a585df10>]}
[0m09:41:35.227866 [debug] [MainThread]: Flushing usage events
[0m09:42:44.414923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff9a6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff9a6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff9a6d50>]}


============================== 09:42:44.441391 | e6c1057f-ac53-40b3-8d33-e21eb79267d6 ==============================
[0m09:42:44.441391 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:42:44.465803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:45.457075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c1057f-ac53-40b3-8d33-e21eb79267d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff810d10>]}
[0m09:42:49.424764 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ro3ts629'
[0m09:42:49.438770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:42:50.091159 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:42:50.107204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:42:50.580866 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:42:50.673869 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:44:09.439239 [info ] [MainThread]: Installed from version 1.3.0
[0m09:44:09.442654 [info ] [MainThread]: Up to date!
[0m09:44:09.445724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e6c1057f-ac53-40b3-8d33-e21eb79267d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff7e8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca700d2dfd0>]}
[0m09:44:09.452414 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 85.64008, "process_user_time": 10.157119, "process_kernel_time": 3.497211, "process_mem_max_rss": "98524", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m09:44:09.455409 [debug] [MainThread]: Command `dbt deps` succeeded at 09:44:09.455026 after 85.64 seconds
[0m09:44:09.458342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ffa83a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ff6a1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6ffad3b50>]}
[0m09:44:09.468746 [debug] [MainThread]: Flushing usage events
[0m09:44:24.400287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2952e9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2952ea150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2956ce250>]}


============================== 09:44:24.509603 | 34805bc7-b1c1-44df-a216-976b784d6fcb ==============================
[0m09:44:24.509603 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:44:24.583720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:44:35.624956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a9d1550>]}
[0m09:44:36.223704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2977d4a50>]}
[0m09:44:36.226870 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:44:37.848157 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:44:53.060342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:53.064358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:53.124339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m09:44:53.368290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a2bd910>]}
[0m09:44:54.640205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b295aae810>]}
[0m09:44:54.647851 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m09:44:54.656941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27b7cb210>]}
[0m09:44:54.665797 [info ] [MainThread]: 
[0m09:44:54.677668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:44:54.711865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m09:44:54.718882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:55.942097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m09:44:55.945413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:57.297507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a4c51d0>]}
[0m09:44:57.309855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:57.322588 [info ] [MainThread]: 
[0m09:44:57.367919 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m09:44:57.370750 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m09:44:57.369709 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m09:44:57.382108 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m09:44:57.394311 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m09:44:57.399155 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m09:44:57.402793 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m09:44:57.407140 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m09:44:57.411330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m09:44:57.428735 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m09:44:57.434036 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m09:44:57.471020 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:44:57.443342 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m09:44:57.447731 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m09:44:57.439012 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m09:44:57.601077 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:44:57.556877 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m09:44:57.598714 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m09:44:57.569294 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:44:57.612501 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:44:57.660873 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m09:44:57.666870 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m09:44:57.668423 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m09:44:57.791149 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:44:57.949729 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m09:44:57.951262 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m09:44:57.997423 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:44:58.027247 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:44:58.057885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:58.059185 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:58.060550 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:58.065174 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:58.206512 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m09:44:58.344286 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m09:44:58.537736 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m09:44:58.773413 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m09:44:59.980038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:16645de6-a2a7-4340-8d1b-a17a742e5ee1&page=queryresults
[0m09:45:00.017574 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:61ae53d1-6e35-4e80-9e74-0438d49fe4b4&page=queryresults
[0m09:45:00.100128 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ce244b52-a400-4176-8924-3436d6e87bda&page=queryresults
[0m09:45:00.105174 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c70bd74d-5b56-4400-b48d-c5912f6af9c5&page=queryresults
[0m09:45:00.687327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a09aa90>]}
[0m09:45:00.691359 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 3.25s]
[0m09:45:00.710039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a61abd0>]}
[0m09:45:00.712374 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:45:00.716911 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m09:45:00.760676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a09b090>]}
[0m09:45:00.769034 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m09:45:00.774748 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 3.33s]
[0m09:45:00.781833 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_orders
[0m09:45:00.791150 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a09b050>]}
[0m09:45:00.795316 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m09:45:00.800552 [info ] [Thread-2 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m09:45:00.819483 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.35s]
[0m09:45:00.830001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.stg_orders)
[0m09:45:00.833790 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m09:45:00.837039 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_orders
[0m09:45:00.842011 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m09:45:00.890560 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m09:45:00.900776 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m09:45:00.911262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m09:45:00.917300 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m09:45:00.944560 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m09:45:00.954782 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_orders
[0m09:45:00.988090 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m09:45:00.998743 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m09:45:01.023203 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m09:45:01.040160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:45:01.062714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:01.284898 [debug] [Thread-2 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m09:45:01.737498 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m09:45:03.045293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:27ff2302-bedd-4444-8aea-2666aa1b9e08&page=queryresults
[0m09:45:03.071009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9ea899fa-8fde-4382-84eb-89bffb874d97&page=queryresults
[0m09:45:03.743399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27978acd0>]}
[0m09:45:03.777981 [info ] [Thread-2 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.91s]
[0m09:45:03.792989 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_orders
[0m09:45:03.798485 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m09:45:03.799862 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m09:45:03.811924 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m09:45:03.842255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27981b510>]}
[0m09:45:03.848729 [info ] [Thread-3 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m09:45:03.852662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_avg_delivery_time)
[0m09:45:03.859339 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.93s]
[0m09:45:03.881912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_orders_by_state)
[0m09:45:03.889551 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m09:45:03.902862 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m09:45:03.907140 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m09:45:03.920003 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:45:03.998859 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m09:45:04.036489 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m09:45:04.110093 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m09:45:04.178576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m09:45:04.207343 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m09:45:04.264984 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m09:45:04.279546 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m09:45:04.297079 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m09:45:04.353571 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m09:45:04.451927 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m09:45:04.663644 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:45:04.677649 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m09:45:04.690148 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:45:04.699043 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m09:45:04.967210 [debug] [Thread-4 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m09:45:05.269043 [debug] [Thread-3 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m09:45:05.567723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:45:06.183994 [debug] [Thread-2 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m09:45:06.888453 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:efcd65cd-be34-4a45-9e53-77730c1de174&page=queryresults
[0m09:45:07.192418 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:024fab03-7a44-4d2d-9bab-8b9d6187d3c7&page=queryresults
[0m09:45:07.682283 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2786947d0>]}
[0m09:45:07.694783 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 3.83s]
[0m09:45:07.727171 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m09:45:07.771040 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m09:45:07.799760 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m09:45:07.830319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_avg_delivery_time)
[0m09:45:07.868138 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m09:45:07.925820 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:45:08.104558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b278694d50>]}
[0m09:45:08.128514 [info ] [Thread-3 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 4.22s]
[0m09:45:08.135035 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m09:45:08.186637 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m09:45:08.220652 [info ] [Thread-4 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m09:45:08.232698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m09:45:08.339295 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m09:45:08.392843 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m09:45:08.394010 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m09:45:08.476127 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m09:45:08.503141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:69aaebbe-6a49-4c6a-85bf-019f838a1176&page=queryresults
[0m09:45:08.662370 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m09:45:08.688757 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m09:45:08.693905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:08.992361 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m09:45:09.047201 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:45:09.245503 [debug] [Thread-4 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m09:45:09.344375 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27a413910>]}
[0m09:45:09.444268 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.17s]
[0m09:45:09.491256 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m09:45:10.363548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4fae6eb8-935c-44f9-b9c2-deff365db3ba&page=queryresults
[0m09:45:10.780935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4d287f20-7939-4097-9e97-3906992fb92e&page=queryresults
[0m09:45:11.171030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b279834950>]}
[0m09:45:11.260890 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.34s]
[0m09:45:11.340577 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m09:45:11.760037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34805bc7-b1c1-44df-a216-976b784d6fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b27869bcd0>]}
[0m09:45:11.766956 [info ] [Thread-4 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 3.53s]
[0m09:45:11.777687 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m09:45:11.785109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:11.787449 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m09:45:11.790365 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m09:45:11.792843 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m09:45:11.797092 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m09:45:11.804383 [info ] [MainThread]: 
[0m09:45:11.806986 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 17.13 seconds (17.13s).
[0m09:45:11.815434 [debug] [MainThread]: Command end result
[0m09:45:12.691408 [info ] [MainThread]: 
[0m09:45:12.707510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:45:12.726344 [info ] [MainThread]: 
[0m09:45:12.731741 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:45:12.739330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 49.44135, "process_user_time": 25.19287, "process_kernel_time": 5.429842, "process_mem_max_rss": "226912", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m09:45:12.745268 [debug] [MainThread]: Command `dbt run` succeeded at 09:45:12.744655 after 49.45 seconds
[0m09:45:12.756948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2952dfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2952dded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2954d3890>]}
[0m09:45:12.761373 [debug] [MainThread]: Flushing usage events
[0m10:18:31.750138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522faed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522faed410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522faed4d0>]}


============================== 10:18:31.848082 | 6123b374-1956-4e7f-81f9-f94159a5c7a3 ==============================
[0m10:18:31.848082 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:18:31.855467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:18:33.301754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6123b374-1956-4e7f-81f9-f94159a5c7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522fb83f50>]}
[0m10:18:36.843390 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ysuq_9jp'
[0m10:18:36.847088 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:18:37.500769 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:18:37.506340 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:18:37.911093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:18:37.940562 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:19:11.812851 [info ] [MainThread]: Installed from version 1.3.0
[0m10:19:11.818250 [info ] [MainThread]: Up to date!
[0m10:19:11.828256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6123b374-1956-4e7f-81f9-f94159a5c7a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252311d1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522fb8aa50>]}
[0m10:19:11.859046 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 41.159515, "process_user_time": 10.336929, "process_kernel_time": 6.396919, "process_mem_max_rss": "98224", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m10:19:11.864937 [debug] [MainThread]: Command `dbt deps` succeeded at 10:19:11.864576 after 41.17 seconds
[0m10:19:11.871842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522faf4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725233e795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725233d09890>]}
[0m10:19:11.874889 [debug] [MainThread]: Flushing usage events
[0m10:19:26.607542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476cac9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476cac9a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476cbcc8d0>]}


============================== 10:19:26.639183 | b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9 ==============================
[0m10:19:26.639183 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:19:26.650000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:39.521562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794751fe7210>]}
[0m10:19:40.240739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476edd8bd0>]}
[0m10:19:40.259165 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:19:41.809488 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:20:00.669858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:00.683987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:00.814249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m10:20:01.091467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947518e4690>]}
[0m10:20:02.838295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476ca01610>]}
[0m10:20:02.991622 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m10:20:03.146542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476c8e97d0>]}
[0m10:20:03.218195 [info ] [MainThread]: 
[0m10:20:03.264947 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:20:03.341094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m10:20:03.354773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:05.252778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409_etl_dataset'
[0m10:20:05.277053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:06.827498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476c8f6f90>]}
[0m10:20:06.840984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:20:06.845594 [info ] [MainThread]: 
[0m10:20:06.918758 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m10:20:06.922552 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m10:20:06.930745 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m10:20:06.924011 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m10:20:06.946538 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m10:20:06.959111 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m10:20:06.962424 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m10:20:06.966855 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m10:20:06.978462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m10:20:06.983649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now model.ecommerce_project.stg_customers)
[0m10:20:06.989735 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m10:20:06.993626 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m10:20:06.997099 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m10:20:07.001461 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m10:20:07.004953 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m10:20:07.008100 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m10:20:07.092913 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m10:20:07.106088 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m10:20:07.127715 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m10:20:07.150403 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m10:20:07.460390 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m10:20:07.490344 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m10:20:07.566536 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m10:20:07.811566 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m10:20:07.903428 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m10:20:07.927395 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m10:20:07.930833 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m10:20:07.982565 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m10:20:08.112236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:20:08.147093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:08.195602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:08.451866 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:20:09.166379 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m10:20:09.661053 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m10:20:09.681399 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m10:20:09.704554 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m10:20:11.306268 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:32e9cb6c-4a12-45b8-b614-61d75a920b13&page=queryresults
[0m10:20:11.398314 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:dcf54ed1-5e95-401d-9c2c-f26b487c5cdf&page=queryresults
[0m10:20:11.590354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:2bcd4772-ee88-4d9a-b1a9-86f705e19155&page=queryresults
[0m10:20:11.676850 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:b081b727-2600-429b-9a8f-043c5d443796&page=queryresults
[0m10:20:12.315613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947505e2b10>]}
[0m10:20:12.316812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794750592d90>]}
[0m10:20:12.329125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794751c15ad0>]}
[0m10:20:12.361294 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 5.32s]
[0m10:20:12.381253 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 5.32s]
[0m10:20:12.391592 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.35s]
[0m10:20:12.399193 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m10:20:12.411065 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m10:20:12.419059 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m10:20:12.469574 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m10:20:12.480686 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m10:20:12.484432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m10:20:12.489330 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m10:20:12.518292 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m10:20:12.593815 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m10:20:12.596209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794751bdb110>]}
[0m10:20:12.664804 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m10:20:12.695580 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 5.61s]
[0m10:20:12.770099 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m10:20:12.778340 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m10:20:12.782944 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m10:20:12.793411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m10:20:12.802603 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m10:20:12.830805 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m10:20:12.844722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:20:13.127169 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m10:20:13.142040 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m10:20:13.206252 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m10:20:13.583881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:13.874728 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m10:20:15.309295 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:0030554d-4279-4332-81cb-b583cfa24c50&page=queryresults
[0m10:20:15.665301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:386dc0f7-ab77-4d8b-b5d4-3d2fdb35d38f&page=queryresults
[0m10:20:16.401196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947518da010>]}
[0m10:20:16.431192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794751c16710>]}
[0m10:20:16.487686 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.92s]
[0m10:20:16.522225 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.64s]
[0m10:20:16.558861 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m10:20:16.652116 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m10:20:16.767213 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m10:20:16.768406 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m10:20:16.789338 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m10:20:16.894410 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m10:20:16.936376 [info ] [Thread-2 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m10:20:16.971788 [info ] [Thread-3 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m10:20:16.998538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_avg_delivery_time)
[0m10:20:17.003174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m10:20:17.072716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m10:20:17.086760 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m10:20:17.103370 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m10:20:17.119966 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m10:20:17.157735 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m10:20:17.234061 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m10:20:17.321720 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m10:20:17.455195 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m10:20:17.458718 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m10:20:17.478294 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m10:20:17.540389 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m10:20:17.554506 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m10:20:17.584148 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m10:20:17.614573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:20:17.622652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:17.904534 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:20:17.907924 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m10:20:18.154213 [debug] [Thread-4 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m10:20:18.547018 [debug] [Thread-3 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m10:20:20.396039 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:30a84ef4-ae37-4204-98a9-a380486de379&page=queryresults
[0m10:20:20.492063 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:456a4dd9-699e-4821-b612-182129b06a2c&page=queryresults
[0m10:20:20.637186 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e23800b7-e88e-433f-bf9a-fd814fbc671a&page=queryresults
[0m10:20:21.053907 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947517b07d0>]}
[0m10:20:21.068102 [info ] [Thread-2 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 4.05s]
[0m10:20:21.076437 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m10:20:21.080877 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m10:20:21.085340 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m10:20:21.089766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_orders_by_state)
[0m10:20:21.093662 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m10:20:21.118939 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m10:20:21.148158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947505e0e90>]}
[0m10:20:21.195225 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.15s]
[0m10:20:21.211923 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m10:20:21.245349 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m10:20:21.271547 [info ] [Thread-2 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m10:20:21.284956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7947519ef8d0>]}
[0m10:20:21.296601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m10:20:21.304079 [info ] [Thread-3 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.21s]
[0m10:20:21.312621 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m10:20:21.314356 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m10:20:21.320618 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m10:20:21.342645 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m10:20:21.365289 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m10:20:21.400038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:21.402896 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m10:20:21.426927 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m10:20:21.704881 [debug] [Thread-1 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m10:20:22.259610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:22.588617 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m10:20:24.110041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:76600a50-acc3-4659-ab2d-9f10c15f78c5&page=queryresults
[0m10:20:24.539204 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3f9af3dc-52cc-4ab6-bab2-a98d2cd7efe3&page=queryresults
[0m10:20:24.882070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79475048fb90>]}
[0m10:20:24.912914 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 3.79s]
[0m10:20:24.946100 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m10:20:25.221799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23bc8d9-1b83-4ff7-bd5f-af7d171db5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79475059dc10>]}
[0m10:20:25.257708 [info ] [Thread-2 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.92s]
[0m10:20:25.301880 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m10:20:25.381360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:25.408921 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m10:20:25.415909 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m10:20:25.420806 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m10:20:25.425360 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m10:20:25.428568 [info ] [MainThread]: 
[0m10:20:25.437595 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 22.16 seconds (22.16s).
[0m10:20:25.456879 [debug] [MainThread]: Command end result
[0m10:20:26.114165 [info ] [MainThread]: 
[0m10:20:26.129317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:26.146056 [info ] [MainThread]: 
[0m10:20:26.160547 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:20:26.177634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 60.170193, "process_user_time": 27.30952, "process_kernel_time": 9.272214, "process_mem_max_rss": "227416", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m10:20:26.205582 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:26.204971 after 60.20 seconds
[0m10:20:26.228848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476cc3b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476c9033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79476d6c7f50>]}
[0m10:20:26.245294 [debug] [MainThread]: Flushing usage events
[0m10:44:08.394569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97431590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97431410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97431f90>]}


============================== 10:44:08.446436 | b301dcc7-640d-49ea-ac99-13e45e069990 ==============================
[0m10:44:08.446436 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:44:08.455169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m10:44:09.287186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b301dcc7-640d-49ea-ac99-13e45e069990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e975a40d0>]}
[0m10:44:13.165215 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tuens148'
[0m10:44:13.171348 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:44:13.996796 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:44:14.023644 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:44:15.372148 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:44:15.401375 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:45:16.100822 [info ] [MainThread]: Installed from version 1.3.0
[0m10:45:16.114258 [info ] [MainThread]: Up to date!
[0m10:45:16.133895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b301dcc7-640d-49ea-ac99-13e45e069990', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e9735d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e98b0d790>]}
[0m10:45:16.198912 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 68.16115, "process_user_time": 9.382606, "process_kernel_time": 4.021116, "process_mem_max_rss": "98368", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m10:45:16.224538 [debug] [MainThread]: Command `dbt deps` succeeded at 10:45:16.223841 after 68.19 seconds
[0m10:45:16.246206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97423a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97420dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784e97462090>]}
[0m10:45:16.274908 [debug] [MainThread]: Flushing usage events
[0m10:45:30.107774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705542368350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705542552810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705542369e50>]}


============================== 10:45:30.136219 | 1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9 ==============================
[0m10:45:30.136219 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:45:30.141251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:36.083545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70552e474c10>]}
[0m10:45:36.329871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055447e1190>]}
[0m10:45:36.333975 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:45:36.850003 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:45:45.118713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:45.123556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:45.169676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m10:45:45.442196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70552710da50>]}
[0m10:45:46.664515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705527471710>]}
[0m10:45:46.693970 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m10:45:46.717317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705527556e10>]}
[0m10:45:46.738374 [info ] [MainThread]: 
[0m10:45:46.791345 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:45:46.844531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m10:45:46.853471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:48.777901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m10:45:48.782543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:50.114277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705527c52890>]}
[0m10:45:50.129731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:50.133483 [info ] [MainThread]: 
[0m10:45:50.198162 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m10:45:50.210007 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m10:45:50.212467 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m10:45:50.213623 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m10:45:50.223684 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m10:45:50.241449 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m10:45:50.258521 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m10:45:50.287652 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m10:45:50.319101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m10:45:50.339671 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m10:45:50.346654 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m10:45:50.353323 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m10:45:50.373342 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m10:45:50.468653 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m10:45:50.517989 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m10:45:50.532780 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m10:45:50.669531 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m10:45:50.703231 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m10:45:50.704534 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m10:45:50.725042 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m10:45:50.763376 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m10:45:50.766386 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m10:45:50.767659 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m10:45:50.781621 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m10:45:50.980949 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m10:45:50.982841 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m10:45:50.988761 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m10:45:50.995446 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m10:45:51.020469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:51.023634 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:45:51.116939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:45:51.194875 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m10:45:51.196706 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:45:51.198901 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m10:45:51.382323 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m10:45:51.390990 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m10:45:52.608782 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c0ea0f4f-fbf2-450d-9fb3-2d88e9e43899&page=queryresults
[0m10:45:52.615644 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:b40bf1a5-5df3-47f6-989a-008dc1d7920b&page=queryresults
[0m10:45:52.620580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3009d58e-7e6f-46de-aa68-829cee678fa2&page=queryresults
[0m10:45:52.721209 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5b491d95-e5cb-4cbc-b6fe-161d860d9daf&page=queryresults
[0m10:45:53.687939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055270ac950>]}
[0m10:45:53.703079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055273de1d0>]}
[0m10:45:53.712427 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 3.35s]
[0m10:45:53.714883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055452cda50>]}
[0m10:45:53.716366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055270ae010>]}
[0m10:45:53.719822 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 3.33s]
[0m10:45:53.723093 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m10:45:53.730468 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 3.37s]
[0m10:45:53.745710 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.40s]
[0m10:45:53.751855 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m10:45:53.764847 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m10:45:53.769914 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m10:45:53.784060 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m10:45:53.788106 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m10:45:53.793216 [info ] [Thread-2 (]: 5 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m10:45:53.802307 [info ] [Thread-3 (]: 6 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m10:45:53.806340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_sales_by_category)
[0m10:45:53.816041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m10:45:53.820286 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m10:45:53.824251 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m10:45:53.850047 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m10:45:53.860615 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m10:45:53.901013 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m10:45:53.938237 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m10:45:54.004899 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m10:45:54.064197 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m10:45:54.139574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:54.155807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:54.503136 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m10:45:54.508068 [debug] [Thread-2 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m10:45:55.768569 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6dc9e369-5cff-4390-941d-ce9f951b9dc8&page=queryresults
[0m10:45:56.164970 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:36788bd8-a54a-4f01-b03a-c53b6be570df&page=queryresults
[0m10:45:56.491543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705527570ad0>]}
[0m10:45:56.496735 [info ] [Thread-3 (]: 6 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.68s]
[0m10:45:56.508498 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m10:45:56.522798 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m10:45:56.525536 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m10:45:56.530825 [info ] [Thread-1 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m10:45:56.534295 [info ] [Thread-4 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m10:45:56.538716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_avg_delivery_time)
[0m10:45:56.541159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_orders_by_state)
[0m10:45:56.545601 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m10:45:56.548549 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m10:45:56.562688 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m10:45:56.576872 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m10:45:56.592878 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m10:45:56.598615 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m10:45:56.610204 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m10:45:56.621396 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m10:45:56.637061 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:56.647117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:56.735782 [debug] [Thread-4 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m10:45:56.860704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70552462a3d0>]}
[0m10:45:56.862481 [debug] [Thread-1 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m10:45:56.866406 [info ] [Thread-2 (]: 5 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m10:45:56.883619 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m10:45:56.892135 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m10:45:56.896029 [info ] [Thread-3 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m10:45:56.899846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m10:45:56.903894 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m10:45:56.917544 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m10:45:56.957711 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m10:45:56.969206 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m10:45:56.992048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:57.076118 [debug] [Thread-3 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m10:45:58.002295 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9cdb10ed-4eb4-4756-bfa6-f40cd5a7d3cb&page=queryresults
[0m10:45:58.006207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:142c0eab-946d-42be-9c2c-d7e883c4bf6a&page=queryresults
[0m10:45:58.277022 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c3a6e5b5-b080-4a2b-a3d7-5a5453e33f18&page=queryresults
[0m10:45:58.697211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705524664690>]}
[0m10:45:58.741521 [info ] [Thread-4 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m10:45:58.772778 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m10:45:58.793717 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m10:45:58.804467 [info ] [Thread-2 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m10:45:58.823616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_orders_by_state)
[0m10:45:58.836134 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m10:45:58.860664 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m10:45:58.970579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055267ca0d0>]}
[0m10:45:59.018146 [info ] [Thread-1 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m10:45:59.052536 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m10:45:59.066485 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m10:45:59.074279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70552463a090>]}
[0m10:45:59.081132 [info ] [Thread-4 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m10:45:59.104558 [info ] [Thread-3 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 2.17s]
[0m10:45:59.110943 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m10:45:59.123768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m10:45:59.144288 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m10:45:59.202146 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m10:45:59.255216 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m10:45:59.557805 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m10:45:59.799453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:59.859700 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m10:45:59.896247 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m10:46:00.137535 [debug] [Thread-2 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m10:46:00.192522 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:00.476274 [debug] [Thread-4 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m10:46:01.441487 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:e9288867-dba0-4ec6-9d9a-d45905b6f782&page=queryresults
[0m10:46:01.821028 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c40a0ada-84ad-4555-8d35-22cd8254c4cd&page=queryresults
[0m10:46:02.119843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055267caad0>]}
[0m10:46:02.163874 [info ] [Thread-2 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m10:46:02.229360 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m10:46:02.504737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfa3bb1-8bcf-473c-a955-dd3e368eb7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70552677b710>]}
[0m10:46:02.532049 [info ] [Thread-4 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 3.38s]
[0m10:46:02.598454 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m10:46:02.628704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:02.677598 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m10:46:02.702238 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m10:46:02.740013 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m10:46:02.818823 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m10:46:02.837537 [info ] [MainThread]: 
[0m10:46:02.886661 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 16.05 seconds (16.05s).
[0m10:46:02.946914 [debug] [MainThread]: Command end result
[0m10:46:04.909023 [info ] [MainThread]: 
[0m10:46:05.030511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:05.128451 [info ] [MainThread]: 
[0m10:46:05.200107 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:46:05.258772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.023743, "process_user_time": 18.492989, "process_kernel_time": 4.752692, "process_mem_max_rss": "227928", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m10:46:05.301738 [debug] [MainThread]: Command `dbt run` succeeded at 10:46:05.301460 after 36.07 seconds
[0m10:46:05.310786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055426cf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055430bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055437b3a50>]}
[0m10:46:05.323595 [debug] [MainThread]: Flushing usage events
[0m14:40:20.110009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77752375d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777523986c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777523986810>]}


============================== 14:40:20.420970 | 87457cfb-7470-48cd-817b-f5af1c7cc61e ==============================
[0m14:40:20.420970 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:40:20.436934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:40:21.783162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87457cfb-7470-48cd-817b-f5af1c7cc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777523947dd0>]}
[0m14:40:24.204200 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-slyjd9vn'
[0m14:40:24.207608 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:40:24.799995 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:40:24.809635 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:40:25.190558 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:40:25.230885 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:41:06.338245 [info ] [MainThread]: Installed from version 1.3.0
[0m14:41:06.341776 [info ] [MainThread]: Up to date!
[0m14:41:06.347783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87457cfb-7470-48cd-817b-f5af1c7cc61e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77752365f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77752372fe50>]}
[0m14:41:06.360690 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 47.26092, "process_user_time": 13.909002, "process_kernel_time": 8.060751, "process_mem_max_rss": "98280", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m14:41:06.365853 [debug] [MainThread]: Command `dbt deps` succeeded at 14:41:06.365401 after 47.27 seconds
[0m14:41:06.369790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777524c1fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7775279e9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7775279ea010>]}
[0m14:41:06.376832 [debug] [MainThread]: Flushing usage events
[0m14:41:21.324520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e42180b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e42186be350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4218775950>]}


============================== 14:41:21.353280 | b2445a0f-4865-40ed-ab8e-bd57031fbdbc ==============================
[0m14:41:21.353280 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:41:21.356345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:32.815539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fd23a6d0>]}
[0m14:41:33.442656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e421a59cc90>]}
[0m14:41:33.483713 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:41:35.080232 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:41:46.614715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:46.631065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:46.712703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m14:41:47.114245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e42042434d0>]}
[0m14:41:49.188219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fd200ed0>]}
[0m14:41:49.192242 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m14:41:49.195107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fd279810>]}
[0m14:41:49.209334 [info ] [MainThread]: 
[0m14:41:49.213066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:41:49.260511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m14:41:49.271445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:50.895822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m14:41:50.905563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:52.245789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fcf3ec90>]}
[0m14:41:52.273390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:52.288229 [info ] [MainThread]: 
[0m14:41:52.378628 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m14:41:52.380252 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m14:41:52.381841 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m14:41:52.402098 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m14:41:52.390299 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m14:41:52.397956 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m14:41:52.393015 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m14:41:52.432581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m14:41:52.455430 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m14:41:52.424073 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m14:41:52.405906 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m14:41:52.410760 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m14:41:52.526438 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m14:41:52.529067 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m14:41:52.534800 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m14:41:52.541013 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m14:41:52.570788 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m14:41:52.596964 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m14:41:52.600535 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m14:41:52.633778 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m14:41:52.660714 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m14:41:52.818627 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m14:41:52.862975 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m14:41:52.910202 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m14:41:52.980389 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m14:41:52.983084 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m14:41:52.998250 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m14:41:53.012336 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m14:41:53.100339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:53.345670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:53.346885 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:53.358615 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m14:41:53.382003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:53.651535 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m14:41:53.901320 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m14:41:54.247473 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m14:41:55.609999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ad81bf57-5473-4a4c-b7b1-14525659d1d9&page=queryresults
[0m14:41:55.842905 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:993fa2be-8439-46f6-a14b-25ee26acb27e&page=queryresults
[0m14:41:55.920553 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cbb8ab3f-2294-46e7-9cb9-1aed77d909a9&page=queryresults
[0m14:41:55.925142 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6ca49287-8a92-4f6f-9362-23b8af99998f&page=queryresults
[0m14:41:56.391193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fcee5ad0>]}
[0m14:41:56.396745 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.96s]
[0m14:41:56.400904 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m14:41:56.408713 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_orders
[0m14:41:56.412780 [info ] [Thread-1 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m14:41:56.422984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.stg_orders)
[0m14:41:56.426607 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_orders
[0m14:41:56.441758 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m14:41:56.489693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc56c390>]}
[0m14:41:56.494413 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 4.07s]
[0m14:41:56.503662 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m14:41:56.507846 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_orders
[0m14:41:56.534766 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m14:41:56.605207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:56.775215 [debug] [Thread-1 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m14:41:56.781110 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fce6e7d0>]}
[0m14:41:56.817728 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 4.24s]
[0m14:41:56.802531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fd3c19d0>]}
[0m14:41:56.831892 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m14:41:56.836966 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 4.40s]
[0m14:41:56.846905 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m14:41:56.857226 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m14:41:56.861287 [info ] [Thread-2 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m14:41:56.864688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_sales_by_category)
[0m14:41:56.868178 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m14:41:56.887560 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m14:41:56.953940 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m14:41:56.965813 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m14:41:57.471569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:57.838123 [debug] [Thread-2 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m14:41:58.100400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4d7f382c-f43d-4370-9486-9bdce85a02c0&page=queryresults
[0m14:41:58.725806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc5ad0d0>]}
[0m14:41:58.731058 [info ] [Thread-1 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.30s]
[0m14:41:58.762252 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_orders
[0m14:41:58.806437 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m14:41:58.808066 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m14:41:58.821354 [info ] [Thread-3 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m14:41:58.860808 [info ] [Thread-4 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m14:41:58.893318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_avg_delivery_time)
[0m14:41:58.935904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_orders_by_state)
[0m14:41:58.970868 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m14:41:58.982705 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m14:41:59.020070 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m14:41:59.053284 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m14:41:59.155692 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m14:41:59.245191 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m14:41:59.284003 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m14:41:59.301248 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:6be78339-52ea-4573-9cd7-499554255d2c&page=queryresults
[0m14:41:59.412442 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m14:41:59.598514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:59.667769 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:00.290557 [debug] [Thread-4 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m14:42:00.317572 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m14:42:00.421000 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc449e10>]}
[0m14:42:00.511370 [info ] [Thread-2 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.56s]
[0m14:42:00.556636 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m14:42:00.593560 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m14:42:00.617720 [info ] [Thread-1 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m14:42:00.628999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m14:42:00.634316 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m14:42:00.672027 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m14:42:01.578646 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m14:42:01.612304 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m14:42:01.840549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:02.135654 [debug] [Thread-1 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m14:42:02.232178 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3b7efd41-f010-4f6e-aa0c-5e93dcdeb2ec&page=queryresults
[0m14:42:02.895949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc626d90>]}
[0m14:42:02.904698 [info ] [Thread-4 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 3.96s]
[0m14:42:02.926218 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5010bcaa-b81d-4871-91cb-a1f4167d4bfd&page=queryresults
[0m14:42:02.939705 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m14:42:02.959280 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m14:42:02.963941 [info ] [Thread-2 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m14:42:02.975541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_orders_by_state)
[0m14:42:02.978465 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m14:42:02.994557 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m14:42:03.064450 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m14:42:03.085044 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m14:42:03.157935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:03.377915 [debug] [Thread-2 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m14:42:03.425577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8d06d55f-04a6-4054-b6c2-b7d442936884&page=queryresults
[0m14:42:03.681912 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc55ac50>]}
[0m14:42:03.690609 [info ] [Thread-3 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.79s]
[0m14:42:03.695413 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m14:42:03.699794 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m14:42:03.704891 [info ] [Thread-4 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m14:42:03.716827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m14:42:03.744362 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m14:42:03.836182 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m14:42:03.916072 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m14:42:03.938443 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m14:42:04.042513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:04.086180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fd1f5150>]}
[0m14:42:04.136240 [info ] [Thread-1 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 3.46s]
[0m14:42:04.152353 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m14:42:04.409239 [debug] [Thread-4 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m14:42:04.710911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8f36bcdd-2744-4c3a-a0ce-b07d1c680c1b&page=queryresults
[0m14:42:05.421795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc569f10>]}
[0m14:42:05.425990 [info ] [Thread-2 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m14:42:05.430617 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m14:42:05.713517 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f906a2fe-62ab-4df9-a67d-2bee04af2607&page=queryresults
[0m14:42:06.331760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2445a0f-4865-40ed-ab8e-bd57031fbdbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41fc55b650>]}
[0m14:42:06.336499 [info ] [Thread-4 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m14:42:06.342836 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m14:42:06.349203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:06.351484 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m14:42:06.356941 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m14:42:06.359094 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m14:42:06.362886 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m14:42:06.365869 [info ] [MainThread]: 
[0m14:42:06.372336 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 17.15 seconds (17.15s).
[0m14:42:06.385730 [debug] [MainThread]: Command end result
[0m14:42:06.732376 [info ] [MainThread]: 
[0m14:42:06.760632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:06.791700 [info ] [MainThread]: 
[0m14:42:06.802712 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:42:06.813001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.281265, "process_user_time": 25.696144, "process_kernel_time": 8.838609, "process_mem_max_rss": "227580", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m14:42:06.819386 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:06.818885 after 46.29 seconds
[0m14:42:06.823416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e42180aaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e42180a8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e421c344f10>]}
[0m14:42:06.826938 [debug] [MainThread]: Flushing usage events
[0m15:33:21.553608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb3f1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb3d7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb612c10>]}


============================== 15:33:21.608856 | 1ea0dadd-eaec-48e2-9091-5ce6eb89ce5b ==============================
[0m15:33:21.608856 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:33:21.666804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:22.813667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ea0dadd-eaec-48e2-9091-5ce6eb89ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb440ad0>]}
[0m15:33:28.412064 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k_7geyng'
[0m15:33:28.474256 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:33:29.222473 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:33:29.255070 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:33:29.584615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:33:29.616514 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:35:53.412514 [info ] [MainThread]: Installed from version 1.3.0
[0m15:35:53.415866 [info ] [MainThread]: Up to date!
[0m15:35:53.427409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ea0dadd-eaec-48e2-9091-5ce6eb89ce5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffc98cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffc99c3d0>]}
[0m15:35:53.442504 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 153.01714, "process_user_time": 12.993491, "process_kernel_time": 8.528903, "process_mem_max_rss": "98160", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m15:35:53.456707 [debug] [MainThread]: Command `dbt deps` succeeded at 15:35:53.449566 after 153.02 seconds
[0m15:35:53.478957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb478690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffc6de550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bffb3d75d0>]}
[0m15:35:53.491177 [debug] [MainThread]: Flushing usage events
[0m15:36:12.989604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f67e5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f6bca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f67e6210>]}


============================== 15:36:13.024214 | fe2a2e75-44d3-4a9f-8c47-b6167480e718 ==============================
[0m15:36:13.024214 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:36:13.039768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:36:27.127462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6fa83c950>]}
[0m15:36:27.691578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f8ccc410>]}
[0m15:36:28.223957 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:36:30.402666 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:36:57.503261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:57.514075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:57.563618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m15:36:57.886681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6e01a4b50>]}
[0m15:36:59.217987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db685ad0>]}
[0m15:36:59.304431 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m15:36:59.353203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db7b1e90>]}
[0m15:36:59.380936 [info ] [MainThread]: 
[0m15:36:59.455050 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:59.579734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m15:36:59.632377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:01.713104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m15:37:01.736620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:03.116884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db618710>]}
[0m15:37:03.145744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:03.171013 [info ] [MainThread]: 
[0m15:37:03.363701 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m15:37:03.365990 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m15:37:03.373091 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m15:37:03.396672 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m15:37:03.445880 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m15:37:03.482333 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m15:37:03.530127 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m15:37:03.550764 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m15:37:03.676600 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m15:37:03.709710 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m15:37:03.600033 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m15:37:03.567856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m15:37:03.574175 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m15:37:03.872672 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m15:37:03.906397 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m15:37:03.930909 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m15:37:04.018567 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m15:37:04.245276 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m15:37:04.321400 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m15:37:04.396567 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m15:37:04.908172 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m15:37:04.932471 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m15:37:05.023070 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m15:37:05.324205 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m15:37:06.074189 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m15:37:06.133188 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m15:37:06.149226 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m15:37:06.136168 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m15:37:06.244430 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:37:06.191383 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:37:06.276402 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:37:06.292026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:06.638516 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m15:37:07.046391 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m15:37:07.501601 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m15:37:07.911380 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m15:37:10.537030 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9357f7bf-0dfd-4cf0-912c-f9bc71ceff08&page=queryresults
[0m15:37:10.539984 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:0c4c2e4c-980e-43af-bc26-16f2e7213573&page=queryresults
[0m15:37:10.717258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:1aab8d6c-1337-4def-8c36-e508c01c7637&page=queryresults
[0m15:37:11.017048 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d8e71cbd-591c-4554-a760-257da659fff5&page=queryresults
[0m15:37:11.708192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6dac67c10>]}
[0m15:37:11.728767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db7f7fd0>]}
[0m15:37:11.745754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6dac0ffd0>]}
[0m15:37:11.801718 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 8.11s]
[0m15:37:11.846482 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db904450>]}
[0m15:37:11.899449 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 8.15s]
[0m15:37:11.941049 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 8.18s]
[0m15:37:11.953888 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m15:37:12.009464 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 8.17s]
[0m15:37:12.089313 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m15:37:12.144118 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m15:37:12.231489 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m15:37:12.300734 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m15:37:12.347371 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m15:37:12.406199 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m15:37:12.490524 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m15:37:12.499970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m15:37:12.522022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m15:37:12.527268 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m15:37:12.531605 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m15:37:12.580783 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m15:37:12.626010 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m15:37:13.115996 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m15:37:13.162321 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m15:37:13.172885 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m15:37:13.338806 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m15:37:13.540659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:13.559995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:14.007351 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m15:37:14.305447 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m15:37:16.053611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:51d3f22f-c266-4888-bc69-b5f27e562f0e&page=queryresults
[0m15:37:16.268871 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:c731527e-6b53-4bc0-a34f-12398d02153c&page=queryresults
[0m15:37:17.370612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db776e50>]}
[0m15:37:17.475818 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.85s]
[0m15:37:17.508305 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m15:37:17.530861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6dac8f010>]}
[0m15:37:17.574173 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m15:37:17.645889 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.03s]
[0m15:37:17.708090 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m15:37:17.772520 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m15:37:17.840147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.fct_sales_by_category)
[0m15:37:17.878297 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m15:37:17.880484 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m15:37:17.953663 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m15:37:18.043690 [info ] [Thread-1 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m15:37:18.158024 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m15:37:18.404669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m15:37:18.318526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m15:37:18.256530 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m15:37:18.490521 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m15:37:18.526348 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m15:37:18.679326 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m15:37:18.799021 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m15:37:19.277896 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m15:37:19.341173 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m15:37:19.456418 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m15:37:19.475669 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m15:37:19.516596 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m15:37:19.627248 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m15:37:20.450232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:37:20.466601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:37:20.518781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:20.871127 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m15:37:21.143801 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m15:37:21.491345 [debug] [Thread-1 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m15:37:24.869816 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:dce6153b-5f29-4e3c-9c0a-5e5d47c03be2&page=queryresults
[0m15:37:25.008912 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cd9d7d5b-e391-43d4-a995-d74614bacf37&page=queryresults
[0m15:37:25.310918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:38145d31-5f68-433f-aead-4086e62c59fd&page=queryresults
[0m15:37:25.756168 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6dac8c3d0>]}
[0m15:37:25.807847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6d8331350>]}
[0m15:37:25.900760 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 7.92s]
[0m15:37:26.153041 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m15:37:26.126121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6dac05f90>]}
[0m15:37:26.026324 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 7.40s]
[0m15:37:26.438241 [info ] [Thread-1 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 7.81s]
[0m15:37:26.582261 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m15:37:26.741083 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m15:37:26.801028 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m15:37:26.882595 [debug] [Thread-2 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m15:37:26.961101 [info ] [Thread-3 (]: 10 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m15:37:27.026776 [info ] [Thread-2 (]: 11 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m15:37:27.300970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_orders_by_state, now model.ecommerce_project.fct_avg_delivery_time)
[0m15:37:27.441310 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m15:37:27.119694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_orders_by_state)
[0m15:37:27.583456 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m15:37:27.708550 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m15:37:27.826175 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m15:37:28.087765 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m15:37:28.206854 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m15:37:28.223443 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m15:37:28.304705 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m15:37:28.837916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:37:28.945155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:29.234640 [debug] [Thread-2 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m15:37:29.535530 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m15:37:31.853633 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9c6c6b97-e76b-4636-828c-e7b85b797561&page=queryresults
[0m15:37:31.979768 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3170ddc8-4420-41a2-8ca6-f7fd96f9bfbb&page=queryresults
[0m15:37:32.998776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db669910>]}
[0m15:37:33.007554 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2a2e75-44d3-4a9f-8c47-b6167480e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6db907750>]}
[0m15:37:33.059867 [info ] [Thread-2 (]: 11 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 5.70s]
[0m15:37:33.254989 [info ] [Thread-3 (]: 10 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 5.89s]
[0m15:37:33.321887 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m15:37:33.370181 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m15:37:33.522645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:33.641087 [debug] [MainThread]: Connection 'model.ecommerce_project.int_avg_delivery_time' was properly closed.
[0m15:37:33.702974 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m15:37:33.759322 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m15:37:33.784842 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m15:37:33.841013 [info ] [MainThread]: 
[0m15:37:33.907139 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 34.39 seconds (34.39s).
[0m15:37:34.007659 [debug] [MainThread]: Command end result
[0m15:37:38.973846 [info ] [MainThread]: 
[0m15:37:39.086362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:39.100760 [info ] [MainThread]: 
[0m15:37:39.210042 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:37:39.272991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 88.29351, "process_user_time": 28.034235, "process_kernel_time": 11.207826, "process_mem_max_rss": "227352", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m15:37:39.364263 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:39.363686 after 88.38 seconds
[0m15:37:39.397999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f6dbe850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f67dbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6f67dbf10>]}
[0m15:37:39.482984 [debug] [MainThread]: Flushing usage events
[0m16:39:44.867019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f4498ed710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f4498d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f449b0e8d0>]}


============================== 16:39:44.943943 | 27819b13-7483-450c-8ac3-0ac82835d1e2 ==============================
[0m16:39:44.943943 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:39:44.950989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:46.351895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27819b13-7483-450c-8ac3-0ac82835d1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f4497bf850>]}
[0m16:39:55.247292 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qomb1bw4'
[0m16:39:55.260849 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:39:56.001351 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:39:56.049945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:39:56.297773 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:39:56.340374 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:40:52.317586 [info ] [MainThread]: Installed from version 1.3.0
[0m16:40:52.327639 [info ] [MainThread]: Up to date!
[0m16:40:52.346000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27819b13-7483-450c-8ac3-0ac82835d1e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f44997a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f449989390>]}
[0m16:40:52.362354 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 68.15455, "process_user_time": 13.139397, "process_kernel_time": 12.064011, "process_mem_max_rss": "98148", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m16:40:52.375864 [debug] [MainThread]: Command `dbt deps` succeeded at 16:40:52.375123 after 68.17 seconds
[0m16:40:52.380377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f449b0ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f44daecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f44daed990>]}
[0m16:40:52.392619 [debug] [MainThread]: Flushing usage events
[0m16:41:11.152578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5ba45810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5ba442d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5ba44e10>]}


============================== 16:41:11.164227 | 6114d571-6975-40e1-a18d-ea5b1019a7f2 ==============================
[0m16:41:11.164227 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:41:11.190408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:22.476404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44bfb210>]}
[0m16:41:23.114856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5df30a10>]}
[0m16:41:23.217823 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:41:25.228457 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:42:45.721338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:45.748157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:45.817654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m16:42:46.165433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44c64510>]}
[0m16:42:49.009920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b449717d0>]}
[0m16:42:49.046814 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m16:42:49.072109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44d7f510>]}
[0m16:42:49.121243 [info ] [MainThread]: 
[0m16:42:49.133379 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:49.210152 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m16:42:49.227765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:52.390730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m16:42:52.446709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:55.018730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44c3b2d0>]}
[0m16:42:55.057719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:55.074660 [info ] [MainThread]: 
[0m16:42:55.148713 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m16:42:55.151001 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m16:42:55.152624 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m16:42:55.154400 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m16:42:55.274158 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m16:42:55.195978 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m16:42:55.227120 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m16:42:55.182373 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m16:42:55.279073 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m16:42:55.454288 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m16:42:55.361349 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m16:42:55.396201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m16:42:55.951706 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m16:42:55.558780 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m16:42:55.686963 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m16:42:55.309032 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m16:42:56.066303 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m16:42:56.155902 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m16:42:56.212747 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m16:42:56.275615 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m16:42:56.324948 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m16:42:56.365555 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m16:42:56.370123 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m16:42:56.543592 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m16:42:56.849811 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m16:42:56.852020 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m16:42:56.890906 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m16:42:56.898521 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m16:42:57.400172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:57.423139 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:42:57.489305 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:57.588944 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:42:58.106837 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m16:42:58.395288 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m16:42:58.396900 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m16:42:58.668968 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m16:43:00.432072 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:9883f388-8b56-48cc-8782-8e4b7fbaeabd&page=queryresults
[0m16:43:00.817836 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:57a27b2c-bb5b-4f87-9617-ce416b229054&page=queryresults
[0m16:43:00.831573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a6a28944-9da5-4fdb-87c2-2863a5c755d0&page=queryresults
[0m16:43:00.867206 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:d735fb83-0222-4022-b470-15a5687e158d&page=queryresults
[0m16:43:01.597809 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44754d90>]}
[0m16:43:01.818444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44766910>]}
[0m16:43:01.924366 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 6.22s]
[0m16:43:02.063841 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m16:43:02.038724 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 6.53s]
[0m16:43:02.182602 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m16:43:02.419847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44d20290>]}
[0m16:43:02.472614 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 7.02s]
[0m16:43:02.491700 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4471cc10>]}
[0m16:43:02.565060 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m16:43:02.660656 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 7.21s]
[0m16:43:02.833863 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_orders
[0m16:43:03.003082 [info ] [Thread-3 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m16:43:02.976010 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m16:43:03.044403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.stg_orders)
[0m16:43:03.078214 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m16:43:03.146984 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m16:43:03.178840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m16:43:03.134108 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_orders
[0m16:43:03.232986 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m16:43:03.284530 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m16:43:03.363403 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m16:43:03.650743 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_orders
[0m16:43:03.725990 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m16:43:03.727214 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m16:43:03.852798 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m16:43:03.946139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:04.024523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:04.341183 [debug] [Thread-3 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m16:43:04.693502 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m16:43:05.835626 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:77d854cb-d63f-441d-836a-7e1e4981b338&page=queryresults
[0m16:43:06.902503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ed3db62d-b7fc-45bf-93ce-2c322a5b0be4&page=queryresults
[0m16:43:07.007634 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b448db790>]}
[0m16:43:07.091309 [info ] [Thread-3 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 3.96s]
[0m16:43:07.150002 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_orders
[0m16:43:07.181117 [debug] [Thread-4 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m16:43:07.182589 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m16:43:07.233388 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m16:43:07.596354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.int_avg_delivery_time)
[0m16:43:07.265823 [info ] [Thread-2 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m16:43:07.742894 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m16:43:07.769210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m16:43:07.934609 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m16:43:07.885449 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m16:43:07.802758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b448eb2d0>]}
[0m16:43:07.982839 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m16:43:08.059168 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.62s]
[0m16:43:08.172257 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m16:43:08.193552 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m16:43:08.224622 [info ] [Thread-3 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m16:43:08.428940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m16:43:08.437323 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m16:43:08.466096 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m16:43:08.512135 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m16:43:08.525420 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m16:43:08.553120 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m16:43:08.601718 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m16:43:08.642222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:08.653040 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m16:43:08.879876 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m16:43:08.940916 [debug] [Thread-4 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m16:43:09.034558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:09.687181 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m16:43:09.804526 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:10.556870 [debug] [Thread-3 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m16:43:11.528944 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:49644994-d9b7-4672-9536-c7d65138974e&page=queryresults
[0m16:43:11.962171 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:09087b5e-88e3-4fa6-a63b-befe98d14fc5&page=queryresults
[0m16:43:12.315594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4461c950>]}
[0m16:43:12.396964 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 4.72s]
[0m16:43:12.439024 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m16:43:12.488318 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m16:43:12.490405 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5b600ee5-ead7-40cd-8e6b-7aa3c937fa7f&page=queryresults
[0m16:43:12.556699 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m16:43:12.673289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_avg_delivery_time)
[0m16:43:12.718771 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m16:43:12.766219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b447b3510>]}
[0m16:43:12.798070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m16:43:12.843940 [info ] [Thread-2 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 5.00s]
[0m16:43:12.937459 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m16:43:12.966820 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m16:43:12.998409 [info ] [Thread-4 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m16:43:13.024862 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m16:43:13.039262 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m16:43:13.143212 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m16:43:13.323065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44799890>]}
[0m16:43:13.417586 [info ] [Thread-3 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.89s]
[0m16:43:13.445550 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m16:43:13.447582 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m16:43:13.514294 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m16:43:13.536226 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m16:43:13.901825 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m16:43:15.191157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:15.286783 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:15.610915 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m16:43:15.905986 [debug] [Thread-4 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m16:43:17.922251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:af36ac97-57a0-428d-911d-243952bd3f05&page=queryresults
[0m16:43:18.849211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4462a090>]}
[0m16:43:18.873487 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 6.18s]
[0m16:43:18.914671 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m16:43:19.137894 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:7755fddf-466d-412f-8ff5-7163e20ff0b5&page=queryresults
[0m16:43:20.475242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6114d571-6975-40e1-a18d-ea5b1019a7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b445da710>]}
[0m16:43:20.510506 [info ] [Thread-4 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 7.45s]
[0m16:43:20.544584 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m16:43:20.761958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:20.956748 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m16:43:21.009308 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m16:43:21.044946 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m16:43:21.091829 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m16:43:21.125804 [info ] [MainThread]: 
[0m16:43:21.197298 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 31.99 seconds (31.99s).
[0m16:43:21.220911 [debug] [MainThread]: Command end result
[0m16:43:23.469181 [info ] [MainThread]: 
[0m16:43:23.510278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:23.544488 [info ] [MainThread]: 
[0m16:43:23.580481 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:43:23.613805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 135.22745, "process_user_time": 25.184406, "process_kernel_time": 10.117102, "process_mem_max_rss": "227376", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m16:43:23.652290 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:23.651695 after 135.27 seconds
[0m16:43:23.698892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5cf0fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5fcd4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5fcd5d50>]}
[0m16:43:23.740182 [debug] [MainThread]: Flushing usage events
[0m21:59:52.700593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f0e3d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f0e6d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f0e2ffd0>]}


============================== 21:59:52.771922 | 6b701b4f-67f0-4959-ab11-1ab3ae974f39 ==============================
[0m21:59:52.771922 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:59:52.793610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:59:53.717759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b701b4f-67f0-4959-ab11-1ab3ae974f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f0e6db90>]}
[0m21:59:57.280882 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yc35fibm'
[0m21:59:57.309725 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:59:58.035178 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:59:58.042484 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:59:58.230701 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:59:58.265333 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:02:05.031073 [info ] [MainThread]: Installed from version 1.3.0
[0m22:02:05.046114 [info ] [MainThread]: Up to date!
[0m22:02:05.095295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b701b4f-67f0-4959-ab11-1ab3ae974f39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f2398f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f0e6eb10>]}
[0m22:02:05.103944 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 133.0107, "process_user_time": 10.456861, "process_kernel_time": 8.297097, "process_mem_max_rss": "98080", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m22:02:05.132730 [debug] [MainThread]: Command `dbt deps` succeeded at 22:02:05.132339 after 133.04 seconds
[0m22:02:05.161076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f106acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f1193950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6f5059890>]}
[0m22:02:05.216656 [debug] [MainThread]: Flushing usage events
[0m22:02:21.837933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b0fd5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b0fcb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b0fcb5d0>]}


============================== 22:02:21.929902 | 337983d9-3427-4504-95ce-b21f8ffe9de9 ==============================
[0m22:02:21.929902 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:02:22.001234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:32.027843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b0e0f350>]}
[0m22:02:32.605173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b32707d0>]}
[0m22:02:32.634236 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m22:02:34.091100 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:03:50.589500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:50.600284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:50.663371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m22:03:50.934911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795c003d0>]}
[0m22:03:55.166327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b158ecd0>]}
[0m22:03:55.197177 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m22:03:55.251406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795f3f5d0>]}
[0m22:03:55.288090 [info ] [MainThread]: 
[0m22:03:55.344806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:55.427285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m22:03:55.488397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:58.391517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m22:03:58.428170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:01.197048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637960a0710>]}
[0m22:04:01.294086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:01.337947 [info ] [MainThread]: 
[0m22:04:01.460001 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m22:04:01.461223 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m22:04:01.468551 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m22:04:01.469644 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m22:04:01.508818 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m22:04:01.538932 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m22:04:01.569913 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m22:04:01.613508 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m22:04:01.702759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m22:04:01.797880 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m22:04:01.997778 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m22:04:01.886918 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m22:04:01.957049 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m22:04:01.854529 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m22:04:02.301452 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m22:04:02.172207 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m22:04:02.286485 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m22:04:02.138818 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m22:04:02.349580 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m22:04:02.385707 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m22:04:02.591495 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m22:04:02.612284 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m22:04:02.655362 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m22:04:02.832412 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m22:04:03.281920 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m22:04:03.313378 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m22:04:03.360806 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m22:04:03.362171 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m22:04:03.675296 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:04:03.723458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:03.757521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:03.838200 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:04:04.104688 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m22:04:04.378702 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m22:04:04.663588 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m22:04:05.024293 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m22:04:06.994295 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:cb397316-fefc-48da-ae03-036628d7ea81&page=queryresults
[0m22:04:07.292840 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:880a61cf-a752-4e60-be37-18a3f620c1fc&page=queryresults
[0m22:04:07.434295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:02401789-51f5-48e4-801b-5f38137e5a88&page=queryresults
[0m22:04:07.737831 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:5dc8a599-a249-4eb4-bb9b-e7ce7a3858b9&page=queryresults
[0m22:04:08.071336 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637960c7e50>]}
[0m22:04:08.107532 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 6.20s]
[0m22:04:08.234182 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m22:04:08.475534 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795250290>]}
[0m22:04:08.561557 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 6.68s]
[0m22:04:08.602448 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m22:04:08.833633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795256190>]}
[0m22:04:08.912663 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 7.13s]
[0m22:04:08.973703 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m22:04:09.012262 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_orders
[0m22:04:09.054695 [info ] [Thread-4 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m22:04:09.119037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.stg_orders)
[0m22:04:09.153451 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_orders
[0m22:04:09.214279 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m22:04:09.641708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795f054d0>]}
[0m22:04:09.663465 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 7.76s]
[0m22:04:09.702042 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m22:04:09.730776 [debug] [Thread-1 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m22:04:09.864179 [info ] [Thread-1 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m22:04:09.905172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.int_sales_by_category)
[0m22:04:09.917923 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_orders
[0m22:04:09.962525 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m22:04:10.045041 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m22:04:10.118452 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m22:04:10.498708 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m22:04:10.515449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:04:10.539794 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m22:04:10.908370 [debug] [Thread-4 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m22:04:11.138120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:11.472786 [debug] [Thread-1 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m22:04:13.613573 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f363bff5-5b16-4260-a73e-a33b84e4a6fe&page=queryresults
[0m22:04:13.937743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:1d949c26-629c-4d82-81df-4b26d28e83ff&page=queryresults
[0m22:04:14.350442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795d8c090>]}
[0m22:04:14.380101 [info ] [Thread-4 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.23s]
[0m22:04:14.468493 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_orders
[0m22:04:14.493532 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m22:04:14.494990 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m22:04:14.502503 [info ] [Thread-3 (]: 7 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m22:04:14.530611 [info ] [Thread-2 (]: 8 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m22:04:14.547069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_avg_delivery_time)
[0m22:04:14.582494 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m22:04:14.617018 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m22:04:14.599619 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m22:04:14.654565 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m22:04:14.697779 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m22:04:14.717396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795249e10>]}
[0m22:04:14.746035 [info ] [Thread-1 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 4.81s]
[0m22:04:14.779191 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m22:04:14.790570 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m22:04:14.841649 [info ] [Thread-4 (]: 9 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m22:04:14.864610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_sales_by_category)
[0m22:04:14.874456 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m22:04:14.932012 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m22:04:14.979235 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m22:04:14.980468 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m22:04:15.029801 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m22:04:15.074404 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m22:04:15.368637 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:15.488629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:15.941995 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m22:04:15.948153 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m22:04:16.241229 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m22:04:16.243436 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m22:04:17.198083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:04:17.991088 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m22:04:18.710738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:15032c31-fdb8-4e4b-b345-18a6fe69e999&page=queryresults
[0m22:04:18.717034 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f1077702-0951-49c2-a271-ccb9038d6add&page=queryresults
[0m22:04:19.959191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795297f10>]}
[0m22:04:19.973819 [info ] [Thread-3 (]: 7 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 5.41s]
[0m22:04:19.983524 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m22:04:19.990002 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m22:04:20.002034 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m22:04:20.011397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.fct_avg_delivery_time)
[0m22:04:20.015498 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m22:04:20.071860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637952bd110>]}
[0m22:04:20.096996 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m22:04:20.132103 [info ] [Thread-2 (]: 8 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 5.49s]
[0m22:04:20.163146 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m22:04:20.183550 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m22:04:20.198323 [info ] [Thread-3 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m22:04:20.219160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m22:04:20.227363 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m22:04:20.253352 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m22:04:20.364853 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:a8059604-a3bc-49ee-92d3-d064ad9b0ce2&page=queryresults
[0m22:04:20.526247 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m22:04:20.613786 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m22:04:20.624548 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m22:04:20.771587 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m22:04:21.235749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:21.371843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:21.396328 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637960c7e50>]}
[0m22:04:21.509322 [info ] [Thread-4 (]: 9 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 6.53s]
[0m22:04:21.738633 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m22:04:21.951583 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m22:04:22.012628 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m22:04:23.724133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:fc9432b3-465c-4b99-84c8-47690166bea0&page=queryresults
[0m22:04:23.923424 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:038db12f-d02e-4631-a575-86a16f7887ab&page=queryresults
[0m22:04:24.473256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763795d8c6d0>]}
[0m22:04:24.502623 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 4.46s]
[0m22:04:24.575140 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m22:04:24.744306 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337983d9-3427-4504-95ce-b21f8ffe9de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637941089d0>]}
[0m22:04:24.816234 [info ] [Thread-3 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 4.53s]
[0m22:04:24.860747 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m22:04:24.953297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:25.031700 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m22:04:25.105562 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m22:04:25.162002 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m22:04:25.212942 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m22:04:25.256975 [info ] [MainThread]: 
[0m22:04:25.308182 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 29.91 seconds (29.91s).
[0m22:04:25.343876 [debug] [MainThread]: Command end result
[0m22:04:28.564747 [info ] [MainThread]: 
[0m22:04:28.612310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:28.639364 [info ] [MainThread]: 
[0m22:04:28.680421 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m22:04:28.712574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 128.55573, "process_user_time": 25.526329, "process_kernel_time": 7.117133, "process_mem_max_rss": "227232", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m22:04:28.731504 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:28.731089 after 128.57 seconds
[0m22:04:28.738174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b113f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b22538d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637b500d950>]}
[0m22:04:28.746598 [debug] [MainThread]: Flushing usage events
[0m22:46:01.143405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fb5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fb5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fb55d0>]}


============================== 22:46:01.255993 | 0cb77ee8-1de7-4725-97de-8d0ed5bdafc5 ==============================
[0m22:46:01.255993 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:46:01.277259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:46:02.489922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb77ee8-1de7-4725-97de-8d0ed5bdafc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e73201f590>]}
[0m22:46:12.182616 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8bv_ww45'
[0m22:46:12.201890 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:46:12.726035 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:46:12.741515 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:46:13.209413 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:46:13.240767 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:48:43.698547 [info ] [MainThread]: Installed from version 1.3.0
[0m22:48:43.701840 [info ] [MainThread]: Up to date!
[0m22:48:43.707202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0cb77ee8-1de7-4725-97de-8d0ed5bdafc5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731f9f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fa6d90>]}
[0m22:48:43.715206 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 163.13664, "process_user_time": 12.27107, "process_kernel_time": 7.718672, "process_mem_max_rss": "98188", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m22:48:43.725753 [debug] [MainThread]: Command `dbt deps` succeeded at 22:48:43.725252 after 163.15 seconds
[0m22:48:43.732189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fa7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e731fa74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e732625e50>]}
[0m22:48:43.742954 [debug] [MainThread]: Flushing usage events
[0m22:48:59.801362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733655d309d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733655d32b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733655d32150>]}


============================== 22:48:59.908149 | 6cbc1685-8239-4333-ae3c-5860c4506a74 ==============================
[0m22:48:59.908149 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:49:00.003694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:49:12.466965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363ada7c10>]}
[0m22:49:13.052455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733657fd0a50>]}
[0m22:49:13.118225 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m22:49:14.774861 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:50:24.531388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:24.579173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:24.691512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.etl_dataset_source
[0m22:50:24.984910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336401a62d0>]}
[0m22:50:28.194339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363ad93990>]}
[0m22:50:28.226604 [info ] [MainThread]: Found 11 models, 4 sources, 600 macros
[0m22:50:28.257661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363b1e68d0>]}
[0m22:50:28.293985 [info ] [MainThread]: 
[0m22:50:28.338372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:50:28.373317 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_my-etl-project-434409'
[0m22:50:28.377151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:31.453668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my-etl-project-434409, now list_my-etl-project-434409_etl_dataset)
[0m22:50:31.554818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:34.556045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363b17f690>]}
[0m22:50:34.610824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:34.643766 [info ] [MainThread]: 
[0m22:50:34.755962 [debug] [Thread-1 (]: Began running node model.ecommerce_project.raw_orders
[0m22:50:34.758305 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m22:50:34.759527 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_order_items
[0m22:50:34.993369 [info ] [Thread-3 (]: 3 of 11 START sql view model etl_dataset.stg_order_items ....................... [RUN]
[0m22:50:34.879967 [info ] [Thread-1 (]: 1 of 11 START sql view model etl_dataset.raw_orders ............................ [RUN]
[0m22:50:34.914097 [info ] [Thread-2 (]: 2 of 11 START sql view model etl_dataset.stg_customers ......................... [RUN]
[0m22:50:34.760534 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_products
[0m22:50:35.103875 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_order_items'
[0m22:50:35.138150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my-etl-project-434409_etl_dataset, now model.ecommerce_project.raw_orders)
[0m22:50:35.251814 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_customers'
[0m22:50:35.271681 [info ] [Thread-4 (]: 4 of 11 START sql view model etl_dataset.stg_products .......................... [RUN]
[0m22:50:35.323923 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_order_items
[0m22:50:35.392974 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.raw_orders
[0m22:50:35.450344 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m22:50:35.507401 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ecommerce_project.stg_products'
[0m22:50:35.720715 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_order_items"
[0m22:50:35.797682 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.raw_orders"
[0m22:50:35.839305 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m22:50:35.989939 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_products
[0m22:50:36.371264 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m22:50:36.620599 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_order_items
[0m22:50:36.622598 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.raw_orders
[0m22:50:36.641979 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m22:50:36.792444 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_products
[0m22:50:37.023766 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_order_items"
[0m22:50:37.054768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.raw_orders"
[0m22:50:37.065079 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m22:50:37.159486 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m22:50:37.733268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:50:37.734444 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:50:37.820819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:38.131311 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:50:38.841426 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_customers`
  OPTIONS()
  as -- models/staging/stg_customers.sql

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state
from `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL;


[0m22:50:38.858038 [debug] [Thread-1 (]: On model.ecommerce_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.raw_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`raw_orders`
  OPTIONS()
  as -- models/staging/raw_orders.sql
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
from `my-etl-project-434409`.`etl_dataset`.`orders`;


[0m22:50:38.859339 [debug] [Thread-3 (]: On model.ecommerce_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_order_items"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_order_items`
  OPTIONS()
  as -- models/staging/stg_order_items.sql

select
    order_id,
    product_id,
    price,
    freight_value,
    order_item_id
from `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL;


[0m22:50:39.173793 [debug] [Thread-4 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_products`
  OPTIONS()
  as -- models/staging/stg_products.sql

with products as (
    -- Select the raw product data from the source table in PostgreSQL
    select
        product_id,
        product_category_name,
        product_name_length,
        product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table
)

, clean_products as (
    -- Clean the raw product data (e.g., handling nulls, renaming columns)
    select
        product_id,
        product_category_name,
        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0
        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0
        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0
        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0
        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0
        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0
        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0
    from products
)

select * from clean_products;


[0m22:50:41.279923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:97e3c242-1c9a-4b45-86ce-07f50a801e94&page=queryresults
[0m22:50:41.387337 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:226044bd-7d03-4afd-af26-b555c34d5e1a&page=queryresults
[0m22:50:41.553109 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:34a3aeb3-d9db-416a-96b2-c83fd40649c0&page=queryresults
[0m22:50:41.557026 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:61d8b64d-d640-4166-8712-ad697f58c12e&page=queryresults
[0m22:50:42.228519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733639fbc210>]}
[0m22:50:42.244117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363a8f8a10>]}
[0m22:50:42.255875 [info ] [Thread-1 (]: 1 of 11 OK created sql view model etl_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 7.09s]
[0m22:50:42.392722 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.raw_orders
[0m22:50:42.345577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363a956390>]}
[0m22:50:42.362190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363ae30290>]}
[0m22:50:42.300866 [info ] [Thread-3 (]: 3 of 11 OK created sql view model etl_dataset.stg_order_items .................. [[32mCREATE VIEW (0 processed)[0m in 7.14s]
[0m22:50:42.408823 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_orders
[0m22:50:42.440618 [info ] [Thread-4 (]: 4 of 11 OK created sql view model etl_dataset.stg_products ..................... [[32mCREATE VIEW (0 processed)[0m in 6.84s]
[0m22:50:42.516992 [info ] [Thread-2 (]: 2 of 11 OK created sql view model etl_dataset.stg_customers .................... [[32mCREATE VIEW (0 processed)[0m in 7.11s]
[0m22:50:42.543542 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_order_items
[0m22:50:42.558268 [info ] [Thread-1 (]: 5 of 11 START sql view model etl_dataset.stg_orders ............................ [RUN]
[0m22:50:42.633947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.raw_orders, now model.ecommerce_project.stg_orders)
[0m22:50:42.577775 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m22:50:42.566301 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_products
[0m22:50:42.653710 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_orders
[0m22:50:42.694678 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_sales_by_category
[0m22:50:42.757075 [info ] [Thread-3 (]: 6 of 11 START sql view model etl_dataset.int_sales_by_category ................. [RUN]
[0m22:50:42.718402 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_orders"
[0m22:50:42.788049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_order_items, now model.ecommerce_project.int_sales_by_category)
[0m22:50:42.910635 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_sales_by_category
[0m22:50:42.984927 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_sales_by_category"
[0m22:50:43.616997 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_orders
[0m22:50:43.636160 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_sales_by_category
[0m22:50:43.649178 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_orders"
[0m22:50:43.776238 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_sales_by_category"
[0m22:50:44.316614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:50:44.603096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:44.911627 [debug] [Thread-3 (]: On model.ecommerce_project.int_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`
  OPTIONS()
  as -- models/intermediate/int_sales_by_category.sql

with category_sales as (
    select
        p.product_category_name,
        sum(oi.price) as total_sales
    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'
    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'
    on p.product_id = oi.product_id  -- Joining on product_id
    group by p.product_category_name
)

select * from category_sales;


[0m22:50:45.498809 [debug] [Thread-1 (]: On model.ecommerce_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.stg_orders"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`stg_orders`
  OPTIONS()
  as -- models/staging/stg_orders.sql
with orders as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model
)

select * from orders;


[0m22:50:47.117985 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:8a9d4df0-724a-44e4-9f06-84614a5611f6&page=queryresults
[0m22:50:47.529740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:982ec747-57bc-4eee-9a51-2f9cda46c4a8&page=queryresults
[0m22:50:48.263592 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363a005a10>]}
[0m22:50:48.323958 [info ] [Thread-3 (]: 6 of 11 OK created sql view model etl_dataset.int_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 5.48s]
[0m22:50:48.360690 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_sales_by_category
[0m22:50:48.383600 [debug] [Thread-4 (]: Began running node model.ecommerce_project.fct_sales_by_category
[0m22:50:48.403704 [info ] [Thread-4 (]: 7 of 11 START sql view model etl_dataset.fct_sales_by_category ................. [RUN]
[0m22:50:48.443934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.fct_sales_by_category)
[0m22:50:48.442463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733639fa5610>]}
[0m22:50:48.496899 [info ] [Thread-1 (]: 5 of 11 OK created sql view model etl_dataset.stg_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 5.81s]
[0m22:50:48.472722 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.fct_sales_by_category
[0m22:50:48.528146 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_orders
[0m22:50:48.641978 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.fct_sales_by_category"
[0m22:50:48.663226 [debug] [Thread-3 (]: Began running node model.ecommerce_project.int_avg_delivery_time
[0m22:50:48.664557 [debug] [Thread-2 (]: Began running node model.ecommerce_project.int_orders_by_state
[0m22:50:48.753248 [info ] [Thread-3 (]: 8 of 11 START sql view model etl_dataset.int_avg_delivery_time ................. [RUN]
[0m22:50:48.864345 [info ] [Thread-2 (]: 9 of 11 START sql view model etl_dataset.int_orders_by_state ................... [RUN]
[0m22:50:49.096210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.int_orders_by_state)
[0m22:50:48.945693 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_sales_by_category, now model.ecommerce_project.int_avg_delivery_time)
[0m22:50:49.242371 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.int_orders_by_state
[0m22:50:49.384741 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.int_avg_delivery_time
[0m22:50:49.540552 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.int_orders_by_state"
[0m22:50:49.653195 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.int_avg_delivery_time"
[0m22:50:49.943597 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.fct_sales_by_category
[0m22:50:50.104237 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.fct_sales_by_category"
[0m22:50:50.177932 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.int_orders_by_state
[0m22:50:50.332810 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.int_orders_by_state"
[0m22:50:50.365218 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.int_avg_delivery_time
[0m22:50:50.435669 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.int_avg_delivery_time"
[0m22:50:50.579463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:50:50.581156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:50:50.681554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:50:50.973758 [debug] [Thread-4 (]: On model.ecommerce_project.fct_sales_by_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_sales_by_category"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`
  OPTIONS()
  as -- models/final/fct_sales_by_category.sql

select
    product_category_name,
    total_sales
from `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`;


[0m22:50:51.213735 [debug] [Thread-2 (]: On model.ecommerce_project.int_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`
  OPTIONS()
  as -- models/intermediate/int_orders_by_state.sql

with orders_by_state as (
    -- Join orders and customers (or another relevant table) to get state information
    select
        c.customer_state,
        count(o.order_id) as total_orders
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders
    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details
    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id
    group by c.customer_state
)

select * from orders_by_state;


[0m22:50:51.472686 [debug] [Thread-3 (]: On model.ecommerce_project.int_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.int_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`
  OPTIONS()
  as with delivery_times as (
    -- Calculate the delivery time for each order
    select
        order_id,
        customer_id,
        order_purchase_timestamp,
        order_delivered_customer_date,
        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model
    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered
)

, avg_delivery_time as (
    -- Calculate the average delivery time for all orders
    select
        customer_id,
        avg(delivery_days) as avg_delivery_days
    from delivery_times
    group by customer_id
)

select * from avg_delivery_time;


[0m22:50:53.433892 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:ff49f456-d631-4cd5-8c2c-6317ba7bac1f&page=queryresults
[0m22:50:53.526475 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:3b1a2ca9-ad9a-4fb7-8efa-89bcf71d8048&page=queryresults
[0m22:50:53.615371 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:b9eede06-2612-4fd0-b2cb-d977d76797d1&page=queryresults
[0m22:50:55.687841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336386635d0>]}
[0m22:50:55.708372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363ac20790>]}
[0m22:50:55.748206 [info ] [Thread-3 (]: 8 of 11 OK created sql view model etl_dataset.int_avg_delivery_time ............ [[32mCREATE VIEW (0 processed)[0m in 6.74s]
[0m22:50:55.811863 [info ] [Thread-4 (]: 7 of 11 OK created sql view model etl_dataset.fct_sales_by_category ............ [[32mCREATE VIEW (0 processed)[0m in 7.26s]
[0m22:50:55.815018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733638663a10>]}
[0m22:50:55.877731 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.int_avg_delivery_time
[0m22:50:55.946977 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.fct_sales_by_category
[0m22:50:56.087311 [info ] [Thread-2 (]: 9 of 11 OK created sql view model etl_dataset.int_orders_by_state .............. [[32mCREATE VIEW (0 processed)[0m in 6.72s]
[0m22:50:56.170644 [debug] [Thread-1 (]: Began running node model.ecommerce_project.fct_avg_delivery_time
[0m22:50:56.252745 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.int_orders_by_state
[0m22:50:56.295226 [info ] [Thread-1 (]: 10 of 11 START sql view model etl_dataset.fct_avg_delivery_time ................ [RUN]
[0m22:50:56.383917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_orders, now model.ecommerce_project.fct_avg_delivery_time)
[0m22:50:56.357361 [debug] [Thread-3 (]: Began running node model.ecommerce_project.fct_orders_by_state
[0m22:50:56.453358 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.fct_avg_delivery_time
[0m22:50:56.521860 [info ] [Thread-3 (]: 11 of 11 START sql view model etl_dataset.fct_orders_by_state .................. [RUN]
[0m22:50:56.583422 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.fct_avg_delivery_time"
[0m22:50:56.609655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.int_avg_delivery_time, now model.ecommerce_project.fct_orders_by_state)
[0m22:50:56.654663 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.fct_orders_by_state
[0m22:50:56.676140 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.fct_orders_by_state"
[0m22:50:56.877068 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.fct_orders_by_state
[0m22:50:56.930414 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.fct_orders_by_state"
[0m22:50:56.957154 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.fct_avg_delivery_time
[0m22:50:56.998832 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.fct_avg_delivery_time"
[0m22:50:57.289748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:50:57.500915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:57.924932 [debug] [Thread-3 (]: On model.ecommerce_project.fct_orders_by_state: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_orders_by_state"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`
  OPTIONS()
  as -- models/final/fct_orders_by_state.sql

with orders_by_state as (
    -- Reference the intermediate model to get the total orders per state
    select
        customer_state,
        total_orders
    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'
)

select
    customer_state,
    total_orders
from orders_by_state
order by total_orders desc;  -- Order the results by the total number of orders, highest to lowest;


[0m22:50:58.202791 [debug] [Thread-1 (]: On model.ecommerce_project.fct_avg_delivery_time: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "ecommerce_project", "target_name": "dev", "node_id": "model.ecommerce_project.fct_avg_delivery_time"} */


  create or replace view `my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`
  OPTIONS()
  as with avg_delivery_time as (
    -- Reference the intermediate model to get the average delivery time per customer
    select
        customer_id,
        avg_delivery_days
    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'
),

overall_avg_delivery_time as (
    -- Calculate the overall average delivery time across all customers
    select
        avg(avg_delivery_days) as overall_avg_delivery_days
    from avg_delivery_time
)

select
    overall_avg_delivery_days
from overall_avg_delivery_time;


[0m22:51:00.434587 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:efbafec5-4165-4bba-9814-03840984c279&page=queryresults
[0m22:51:00.487554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:16226d11-4e44-40ac-b7c8-dd76e47e2c72&page=queryresults
[0m22:51:01.409869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363a043ed0>]}
[0m22:51:01.416494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbc1685-8239-4333-ae3c-5860c4506a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73363a02f890>]}
[0m22:51:01.653607 [info ] [Thread-1 (]: 10 of 11 OK created sql view model etl_dataset.fct_avg_delivery_time ........... [[32mCREATE VIEW (0 processed)[0m in 5.03s]
[0m22:51:01.695430 [info ] [Thread-3 (]: 11 of 11 OK created sql view model etl_dataset.fct_orders_by_state ............. [[32mCREATE VIEW (0 processed)[0m in 4.81s]
[0m22:51:01.724498 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.fct_avg_delivery_time
[0m22:51:01.753923 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.fct_orders_by_state
[0m22:51:01.834897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:01.867751 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_avg_delivery_time' was properly closed.
[0m22:51:01.930719 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_orders_by_state' was properly closed.
[0m22:51:01.992654 [debug] [MainThread]: Connection 'model.ecommerce_project.int_orders_by_state' was properly closed.
[0m22:51:02.053120 [debug] [MainThread]: Connection 'model.ecommerce_project.fct_sales_by_category' was properly closed.
[0m22:51:02.088097 [info ] [MainThread]: 
[0m22:51:02.129288 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 33.75 seconds (33.75s).
[0m22:51:02.188761 [debug] [MainThread]: Command end result
[0m22:51:05.362356 [info ] [MainThread]: 
[0m22:51:05.441187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:51:05.476099 [info ] [MainThread]: 
[0m22:51:05.510019 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m22:51:05.569597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 127.08034, "process_user_time": 24.134233, "process_kernel_time": 9.636737, "process_mem_max_rss": "226496", "process_out_blocks": "512", "process_in_blocks": "0"}
[0m22:51:05.604067 [debug] [MainThread]: Command `dbt run` succeeded at 22:51:05.603662 after 127.11 seconds
[0m22:51:05.664031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733655d25fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733659d69090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733659d6a010>]}
[0m22:51:05.754038 [debug] [MainThread]: Flushing usage events
[0m09:35:36.723155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76133d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76133c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76133d4d0>]}


============================== 09:35:36.745976 | 31c376b2-a813-4165-aa41-7885b93d6ad3 ==============================
[0m09:35:36.745976 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:35:36.749210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:35:36.970365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c376b2-a813-4165-aa41-7885b93d6ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7613d96d0>]}
[0m09:35:37.657412 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kgxogeur'
[0m09:35:37.658919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:35:38.266909 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:35:38.269115 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:35:38.488212 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:35:38.495034 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:35:54.664508 [info ] [MainThread]: Installed from version 1.3.0
[0m09:35:54.666903 [info ] [MainThread]: Up to date!
[0m09:35:54.669341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31c376b2-a813-4165-aa41-7885b93d6ad3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7628f6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7613174d0>]}
[0m09:35:54.673505 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 18.429396, "process_user_time": 3.124042, "process_kernel_time": 2.253998, "process_mem_max_rss": "97816", "process_in_blocks": "90560", "process_out_blocks": "1264"}
[0m09:35:54.675594 [debug] [MainThread]: Command `dbt deps` succeeded at 09:35:54.675383 after 18.43 seconds
[0m09:35:54.677292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76132f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76132cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b76168ba10>]}
[0m09:35:54.679234 [debug] [MainThread]: Flushing usage events
[0m09:36:03.302067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ab149f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ab22eda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ab18525d0>]}


============================== 09:36:03.319308 | 10b3e8e1-c3a2-46d8-aaad-1cf359e9e0e0 ==============================
[0m09:36:03.319308 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:36:03.328122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:03.421364 [info ] [MainThread]: dbt version: 1.8.6
[0m09:36:03.425578 [info ] [MainThread]: python version: 3.11.12
[0m09:36:03.450577 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:36:03.480178 [info ] [MainThread]: os info: Linux-6.6.87.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m09:36:10.257021 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m09:36:10.259306 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m09:36:10.263731 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m09:36:10.266562 [info ] [MainThread]: adapter type: bigquery
[0m09:36:10.269064 [info ] [MainThread]: adapter version: 1.8.2
[0m09:36:10.544130 [info ] [MainThread]: Configuration:
[0m09:36:10.549678 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:36:10.551980 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:36:10.554013 [info ] [MainThread]: Required dependencies:
[0m09:36:10.556463 [debug] [MainThread]: Executing "git --help"
[0m09:36:10.571755 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m09:36:10.573642 [info ] [MainThread]: Connection:
[0m09:36:10.575405 [info ] [MainThread]:   method: service-account
[0m09:36:10.579419 [info ] [MainThread]:   database: my-etl-project-434409
[0m09:36:10.582672 [info ] [MainThread]:   execution_project: my-etl-project-434409
[0m09:36:10.584601 [info ] [MainThread]:   schema: etl_dataset
[0m09:36:10.586650 [info ] [MainThread]:   location: US
[0m09:36:10.588527 [info ] [MainThread]:   priority: interactive
[0m09:36:10.591066 [info ] [MainThread]:   maximum_bytes_billed: None
[0m09:36:10.594352 [info ] [MainThread]:   impersonate_service_account: None
[0m09:36:10.596701 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m09:36:10.599092 [info ] [MainThread]:   job_retries: 1
[0m09:36:10.601313 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m09:36:10.603421 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m09:36:10.606878 [info ] [MainThread]:   timeout_seconds: 300
[0m09:36:10.608801 [info ] [MainThread]:   client_id: None
[0m09:36:10.611074 [info ] [MainThread]:   token_uri: None
[0m09:36:10.613609 [info ] [MainThread]:   dataproc_region: None
[0m09:36:10.616841 [info ] [MainThread]:   dataproc_cluster_name: None
[0m09:36:10.626090 [info ] [MainThread]:   gcs_bucket: None
[0m09:36:10.631401 [info ] [MainThread]:   dataproc_batch: None
[0m09:36:10.634898 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:36:11.376263 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m09:36:11.379301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:11.563198 [debug] [MainThread]: On debug: select 1 as id
[0m09:36:14.286842 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:1912ce34-f510-4c4b-ba36-dff107e86f87&page=queryresults
[0m09:36:15.168735 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:36:15.173067 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:36:15.179153 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m09:36:15.182731 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 12.446628, "process_user_time": 7.931845, "process_kernel_time": 2.396029, "process_mem_max_rss": "214384", "process_in_blocks": "196856", "process_out_blocks": "392", "command_success": false}
[0m09:36:15.185304 [debug] [MainThread]: Command `dbt debug` failed at 09:36:15.184956 after 12.45 seconds
[0m09:36:15.187729 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:36:15.190358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ab5695a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a96992450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ab1564810>]}
[0m09:36:15.194231 [debug] [MainThread]: Flushing usage events
[0m22:11:45.853111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af28d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af4aad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4b050af90>]}


============================== 22:11:45.909529 | da85ddcf-3c8a-43cc-8b73-289452c03d7b ==============================
[0m22:11:45.909529 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:11:45.959791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:47.178273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da85ddcf-3c8a-43cc-8b73-289452c03d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af3019d0>]}
[0m22:11:50.965652 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2abg2l1u'
[0m22:11:50.988281 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:11:52.073337 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:11:52.079374 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:11:52.386511 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:11:52.471629 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:12:37.991848 [info ] [MainThread]: Installed from version 1.3.0
[0m22:12:37.998878 [info ] [MainThread]: Up to date!
[0m22:12:38.001742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da85ddcf-3c8a-43cc-8b73-289452c03d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4b0822110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af31a590>]}
[0m22:12:38.008190 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 53.27546, "process_user_time": 7.619722, "process_kernel_time": 4.689878, "process_mem_max_rss": "98120", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m22:12:38.017992 [debug] [MainThread]: Command `dbt deps` succeeded at 22:12:38.017666 after 53.29 seconds
[0m22:12:38.056100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4b1b1f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af27c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4af5dbb50>]}
[0m22:12:38.070703 [debug] [MainThread]: Flushing usage events
[0m22:12:53.608384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ce396a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ce396ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ce3969e10>]}


============================== 22:12:53.668237 | c140baee-e56f-4670-b974-eff389cd33e9 ==============================
[0m22:12:53.668237 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:12:53.673818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:12:53.773069 [info ] [MainThread]: dbt version: 1.8.6
[0m22:12:53.804033 [info ] [MainThread]: python version: 3.11.12
[0m22:12:53.809967 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:12:53.853306 [info ] [MainThread]: os info: Linux-6.6.87.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:13:02.548810 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m22:13:02.571317 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m22:13:02.600562 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m22:13:02.606934 [info ] [MainThread]: adapter type: bigquery
[0m22:13:02.615846 [info ] [MainThread]: adapter version: 1.8.2
[0m22:13:03.035198 [info ] [MainThread]: Configuration:
[0m22:13:03.038362 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:13:03.041737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:13:03.045626 [info ] [MainThread]: Required dependencies:
[0m22:13:03.048277 [debug] [MainThread]: Executing "git --help"
[0m22:13:03.063613 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:13:03.067390 [info ] [MainThread]: Connection:
[0m22:13:03.070501 [info ] [MainThread]:   method: service-account
[0m22:13:03.073612 [info ] [MainThread]:   database: my-etl-project-434409
[0m22:13:03.077058 [info ] [MainThread]:   execution_project: my-etl-project-434409
[0m22:13:03.080495 [info ] [MainThread]:   schema: etl_dataset
[0m22:13:03.084547 [info ] [MainThread]:   location: US
[0m22:13:03.100090 [info ] [MainThread]:   priority: interactive
[0m22:13:03.105846 [info ] [MainThread]:   maximum_bytes_billed: None
[0m22:13:03.116713 [info ] [MainThread]:   impersonate_service_account: None
[0m22:13:03.120960 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m22:13:03.124505 [info ] [MainThread]:   job_retries: 1
[0m22:13:03.132028 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m22:13:03.134976 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m22:13:03.138013 [info ] [MainThread]:   timeout_seconds: 300
[0m22:13:03.142171 [info ] [MainThread]:   client_id: None
[0m22:13:03.145864 [info ] [MainThread]:   token_uri: None
[0m22:13:03.148732 [info ] [MainThread]:   dataproc_region: None
[0m22:13:03.161031 [info ] [MainThread]:   dataproc_cluster_name: None
[0m22:13:03.170706 [info ] [MainThread]:   gcs_bucket: None
[0m22:13:03.173569 [info ] [MainThread]:   dataproc_batch: None
[0m22:13:03.177717 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m22:13:03.825174 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m22:13:03.830612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:04.000549 [debug] [MainThread]: On debug: select 1 as id
[0m22:13:06.157687 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:f3360c38-de2e-47a6-94ac-e72d2e464816&page=queryresults
[0m22:13:06.922446 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:13:06.926435 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:13:06.928842 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:13:06.935209 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 14.491532, "process_user_time": 14.830045, "process_kernel_time": 7.285568, "process_mem_max_rss": "214796", "process_out_blocks": "392", "command_success": false, "process_in_blocks": "0"}
[0m22:13:06.939511 [debug] [MainThread]: Command `dbt debug` failed at 22:13:06.939099 after 14.50 seconds
[0m22:13:06.945856 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:13:06.950056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ce392d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ce4baf690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732cccad9050>]}
[0m22:13:06.952643 [debug] [MainThread]: Flushing usage events
[0m07:04:55.808948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103b8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103bb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103bbcd0>]}


============================== 07:04:55.826950 | d09eaabb-6ed1-4a8c-9291-1069ac2d9f9b ==============================
[0m07:04:55.826950 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:04:55.829085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:04:55.994581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09eaabb-6ed1-4a8c-9291-1069ac2d9f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790910488110>]}
[0m07:04:56.554809 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vethjbjk'
[0m07:04:56.556541 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:04:57.943145 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:04:57.946879 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:04:58.646694 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:04:58.656848 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:05:20.021156 [info ] [MainThread]: Installed from version 1.3.0
[0m07:05:20.023514 [info ] [MainThread]: Up to date!
[0m07:05:20.026009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd09eaabb-6ed1-4a8c-9291-1069ac2d9f9b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79091045b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103b8e10>]}
[0m07:05:20.029907 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 24.47531, "process_user_time": 3.15414, "process_kernel_time": 2.865349, "process_mem_max_rss": "98032", "process_in_blocks": "8", "process_out_blocks": "1264"}
[0m07:05:20.032225 [debug] [MainThread]: Command `dbt deps` succeeded at 07:05:20.031951 after 24.48 seconds
[0m07:05:20.034340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103bb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7909103bbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790911813c90>]}
[0m07:05:20.036609 [debug] [MainThread]: Flushing usage events
[0m07:05:28.464828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8ec5ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8ec5d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8ec5c050>]}


============================== 07:05:28.472529 | 633cf726-8534-4a80-914e-4a83ad867768 ==============================
[0m07:05:28.472529 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:05:28.475428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:05:28.505550 [info ] [MainThread]: dbt version: 1.8.6
[0m07:05:28.508700 [info ] [MainThread]: python version: 3.11.12
[0m07:05:28.511729 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m07:05:28.514201 [info ] [MainThread]: os info: Linux-6.6.87.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:05:32.323438 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m07:05:32.366731 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m07:05:32.445910 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m07:05:32.522283 [info ] [MainThread]: adapter type: bigquery
[0m07:05:32.585754 [info ] [MainThread]: adapter version: 1.8.2
[0m07:05:33.856368 [info ] [MainThread]: Configuration:
[0m07:05:33.872597 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:05:33.886261 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:05:33.905135 [info ] [MainThread]: Required dependencies:
[0m07:05:33.915427 [debug] [MainThread]: Executing "git --help"
[0m07:05:33.921421 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m07:05:33.930223 [info ] [MainThread]: Connection:
[0m07:05:33.939244 [info ] [MainThread]:   method: service-account
[0m07:05:33.947448 [info ] [MainThread]:   database: my-etl-project-434409
[0m07:05:33.950313 [info ] [MainThread]:   execution_project: my-etl-project-434409
[0m07:05:33.953270 [info ] [MainThread]:   schema: etl_dataset
[0m07:05:33.968866 [info ] [MainThread]:   location: US
[0m07:05:33.976105 [info ] [MainThread]:   priority: interactive
[0m07:05:33.980059 [info ] [MainThread]:   maximum_bytes_billed: None
[0m07:05:33.983647 [info ] [MainThread]:   impersonate_service_account: None
[0m07:05:33.996656 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m07:05:34.013136 [info ] [MainThread]:   job_retries: 1
[0m07:05:34.016185 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m07:05:34.019483 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m07:05:34.022065 [info ] [MainThread]:   timeout_seconds: 300
[0m07:05:34.025916 [info ] [MainThread]:   client_id: None
[0m07:05:34.032020 [info ] [MainThread]:   token_uri: None
[0m07:05:34.043185 [info ] [MainThread]:   dataproc_region: None
[0m07:05:34.047686 [info ] [MainThread]:   dataproc_cluster_name: None
[0m07:05:34.063665 [info ] [MainThread]:   gcs_bucket: None
[0m07:05:34.078833 [info ] [MainThread]:   dataproc_batch: None
[0m07:05:34.089933 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m07:05:34.655836 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m07:05:34.659572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:05:34.756206 [debug] [MainThread]: On debug: select 1 as id
[0m07:05:36.958171 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4eda335d-e32c-4402-be87-fe61c84ce8f6&page=queryresults
[0m07:05:37.826419 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:05:37.841167 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:05:37.843681 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m07:05:37.853328 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 9.668695, "process_user_time": 8.290538, "process_kernel_time": 2.312648, "process_mem_max_rss": "215260", "process_out_blocks": "392", "command_success": false, "process_in_blocks": "0"}
[0m07:05:37.857960 [debug] [MainThread]: Command `dbt debug` failed at 07:05:37.855813 after 9.67 seconds
[0m07:05:37.860850 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:05:37.874452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8ec97d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8ec5d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8a8eb34550>]}
[0m07:05:37.887717 [debug] [MainThread]: Flushing usage events
[0m09:20:08.661755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf12edf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf15027d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf1637d10>]}


============================== 09:20:08.745348 | 3b6829ce-0779-4ca4-bce1-70210e9ab33d ==============================
[0m09:20:08.745348 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:20:08.761609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m09:20:10.218011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b6829ce-0779-4ca4-bce1-70210e9ab33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf11bf5d0>]}
[0m09:20:17.633180 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1q17pkhc'
[0m09:20:17.653455 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:20:19.216605 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:20:19.299055 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:20:20.010645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:20:20.069436 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:22:49.720192 [info ] [MainThread]: Installed from version 1.3.0
[0m09:22:49.724911 [info ] [MainThread]: Up to date!
[0m09:22:49.732200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b6829ce-0779-4ca4-bce1-70210e9ab33d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf13be6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf2889fd0>]}
[0m09:22:49.745485 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 161.61208, "process_user_time": 9.349927, "process_kernel_time": 4.08071, "process_mem_max_rss": "97852", "process_in_blocks": "99296", "process_out_blocks": "1264"}
[0m09:22:49.748666 [debug] [MainThread]: Command `dbt deps` succeeded at 09:22:49.748240 after 161.62 seconds
[0m09:22:49.754928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf12df5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf12df990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ebf1364450>]}
[0m09:22:49.758029 [debug] [MainThread]: Flushing usage events
[0m09:23:01.259715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baf9b5d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baf9b5d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bafdb40950>]}


============================== 09:23:01.264797 | 32e22080-ebf1-4424-a805-9c30f0e2a47d ==============================
[0m09:23:01.264797 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:23:01.267273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:01.463733 [info ] [MainThread]: dbt version: 1.8.6
[0m09:23:01.466395 [info ] [MainThread]: python version: 3.11.12
[0m09:23:01.481397 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:23:01.485172 [info ] [MainThread]: os info: Linux-6.6.87.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m09:23:12.904960 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m09:23:12.907953 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m09:23:12.915207 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m09:23:12.917510 [info ] [MainThread]: adapter type: bigquery
[0m09:23:12.919975 [info ] [MainThread]: adapter version: 1.8.2
[0m09:23:13.453509 [info ] [MainThread]: Configuration:
[0m09:23:13.471876 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:23:13.507350 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:23:13.590210 [info ] [MainThread]: Required dependencies:
[0m09:23:13.654089 [debug] [MainThread]: Executing "git --help"
[0m09:23:13.698605 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m09:23:13.748149 [info ] [MainThread]: Connection:
[0m09:23:13.763026 [info ] [MainThread]:   method: service-account
[0m09:23:13.779084 [info ] [MainThread]:   database: my-etl-project-434409
[0m09:23:13.782412 [info ] [MainThread]:   execution_project: my-etl-project-434409
[0m09:23:13.813268 [info ] [MainThread]:   schema: etl_dataset
[0m09:23:13.843466 [info ] [MainThread]:   location: US
[0m09:23:13.848000 [info ] [MainThread]:   priority: interactive
[0m09:23:13.891795 [info ] [MainThread]:   maximum_bytes_billed: None
[0m09:23:13.924366 [info ] [MainThread]:   impersonate_service_account: None
[0m09:23:13.943110 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m09:23:13.972247 [info ] [MainThread]:   job_retries: 1
[0m09:23:13.988117 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m09:23:14.030074 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m09:23:14.083915 [info ] [MainThread]:   timeout_seconds: 300
[0m09:23:14.101037 [info ] [MainThread]:   client_id: None
[0m09:23:14.103837 [info ] [MainThread]:   token_uri: None
[0m09:23:14.117183 [info ] [MainThread]:   dataproc_region: None
[0m09:23:14.158737 [info ] [MainThread]:   dataproc_cluster_name: None
[0m09:23:14.196194 [info ] [MainThread]:   gcs_bucket: None
[0m09:23:14.229459 [info ] [MainThread]:   dataproc_batch: None
[0m09:23:14.278306 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:23:15.161325 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m09:23:15.254069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:15.744378 [debug] [MainThread]: On debug: select 1 as id
[0m09:23:17.920325 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:eef8a477-7307-4939-901a-16bfb67237c5&page=queryresults
[0m09:23:18.729115 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:23:18.751432 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:23:18.765916 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m09:23:18.848014 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 17.763876, "process_user_time": 12.119639, "process_kernel_time": 3.137318, "process_mem_max_rss": "214180", "process_in_blocks": "198936", "process_out_blocks": "392", "command_success": false}
[0m09:23:18.886164 [debug] [MainThread]: Command `dbt debug` failed at 09:23:18.885700 after 17.80 seconds
[0m09:23:18.925223 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:23:18.934735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baf9b52990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bafdeed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baded3a290>]}
[0m09:23:18.962593 [debug] [MainThread]: Flushing usage events
[0m10:35:23.314916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd91599d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd937cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd937cf50>]}


============================== 10:35:23.414830 | d6a4d6b4-13e2-44d2-8fde-2cf71e24ca21 ==============================
[0m10:35:23.414830 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:35:23.475903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:25.190119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6a4d6b4-13e2-44d2-8fde-2cf71e24ca21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd91b2790>]}
[0m10:35:34.290022 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nwr68wo'
[0m10:35:34.357081 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:35:36.480987 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:35:36.550926 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:35:37.232189 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:35:37.297983 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:39:02.160713 [info ] [MainThread]: Installed from version 1.3.0
[0m10:39:02.190355 [info ] [MainThread]: Up to date!
[0m10:39:02.195188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6a4d6b4-13e2-44d2-8fde-2cf71e24ca21', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd918bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cda6eee90>]}
[0m10:39:02.213120 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 220.58362, "process_user_time": 12.384831, "process_kernel_time": 6.390378, "process_mem_max_rss": "98716", "process_out_blocks": "1264", "process_in_blocks": "0"}
[0m10:39:02.252484 [debug] [MainThread]: Command `dbt deps` succeeded at 10:39:02.252041 after 220.62 seconds
[0m10:39:02.278538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd91b3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cd91b2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743cda399450>]}
[0m10:39:02.326988 [debug] [MainThread]: Flushing usage events
[0m10:39:19.719380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b3af537d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b3b53c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b3af4a310>]}


============================== 10:39:19.754840 | 74f5549c-9792-4860-94dc-7a052562c8bf ==============================
[0m10:39:19.754840 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:39:19.784054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:39:19.886884 [info ] [MainThread]: dbt version: 1.8.6
[0m10:39:19.917409 [info ] [MainThread]: python version: 3.11.13
[0m10:39:19.961232 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m10:39:19.993442 [info ] [MainThread]: os info: Linux-6.6.87.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m10:39:28.251625 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m10:39:28.367793 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m10:39:28.446695 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m10:39:28.530683 [info ] [MainThread]: adapter type: bigquery
[0m10:39:28.608154 [info ] [MainThread]: adapter version: 1.8.2
[0m10:39:30.125104 [info ] [MainThread]: Configuration:
[0m10:39:30.200867 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:39:30.313805 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:39:30.366672 [info ] [MainThread]: Required dependencies:
[0m10:39:30.430506 [debug] [MainThread]: Executing "git --help"
[0m10:39:30.497438 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:39:30.510839 [info ] [MainThread]: Connection:
[0m10:39:30.543929 [info ] [MainThread]:   method: service-account
[0m10:39:30.558522 [info ] [MainThread]:   database: my-etl-project-434409
[0m10:39:30.567116 [info ] [MainThread]:   execution_project: my-etl-project-434409
[0m10:39:30.580891 [info ] [MainThread]:   schema: etl_dataset
[0m10:39:30.595880 [info ] [MainThread]:   location: US
[0m10:39:30.610957 [info ] [MainThread]:   priority: interactive
[0m10:39:30.638507 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:39:30.660602 [info ] [MainThread]:   impersonate_service_account: None
[0m10:39:30.686196 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:39:30.737564 [info ] [MainThread]:   job_retries: 1
[0m10:39:30.782605 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:39:30.863096 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m10:39:30.867958 [info ] [MainThread]:   timeout_seconds: 300
[0m10:39:30.888412 [info ] [MainThread]:   client_id: None
[0m10:39:30.919331 [info ] [MainThread]:   token_uri: None
[0m10:39:30.938135 [info ] [MainThread]:   dataproc_region: None
[0m10:39:30.950792 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:39:30.965858 [info ] [MainThread]:   gcs_bucket: None
[0m10:39:30.968070 [info ] [MainThread]:   dataproc_batch: None
[0m10:39:30.974940 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:39:32.185748 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:39:32.226521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:32.696732 [debug] [MainThread]: On debug: select 1 as id
[0m10:39:35.297558 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=my-etl-project-434409&j=bq:US:4949d203-2504-4205-b97e-f17ea878bee2&page=queryresults
[0m10:39:36.144411 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:39:36.164344 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:39:36.192874 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m10:39:36.226867 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 17.41806, "process_user_time": 17.037077, "process_kernel_time": 6.490979, "process_mem_max_rss": "218060", "process_out_blocks": "392", "command_success": false, "process_in_blocks": "0"}
[0m10:39:36.242324 [debug] [MainThread]: Command `dbt debug` failed at 10:39:36.241981 after 17.43 seconds
[0m10:39:36.260147 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:39:36.345798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b3afabb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b24257010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1b3afabf90>]}
[0m10:39:36.357618 [debug] [MainThread]: Flushing usage events
